# =============================================
# UC-RF083 - Casos de Uso (Contrato Comportamental)
# Central de Módulos
# Versão: 2.0
# Data: 2026-01-30
# Autor: Agência ALC - alc.dev.br
# =============================================
# NOTA ESPECIAL: Este é um módulo de SISTEMA
# - Funcionalidades são GLOBAIS (não isoladas por tenant)
# - Acesso filtrado por PERFIL (Developer/System/Tenant)
# - Pré-requisito para todos os demais RFs
# =============================================

uc:
  documentacao: "RF083"
  versao: "2.0"
  data: "2026-01-30"

# =============================================
# RBAC - PERMISSÕES E CENTRAL DE FUNCIONALIDADES
# =============================================
rbac:
  modulo:
    codigo: "SYS.CENTRAL_MODULOS"
    nome: "Central de Módulos"
    descricao: "Sistema de gerenciamento de todas as funcionalidades do sistema IControlIT"
    categoria: "sistema"
    rota: "/management/central-modulos"

  permissoes:
    - acao: "VIEW_ANY"
      codigo: "CENTRAL_MODULOS.VIEW_ANY"
      nome: "Listar Funcionalidades"
      descricao: "Permite listar funcionalidades do sistema (filtrado por perfil)"
      uc_ids: ["UC00", "UC02", "UC03", "UC07"]
      perfis_obrigatorios:
        - "Developer"
      perfis_sugeridos:
        - "Super Admin"
        - "Admin"
        - "User"

    - acao: "VIEW"
      codigo: "CENTRAL_MODULOS.VIEW"
      nome: "Visualizar Funcionalidade"
      descricao: "Permite visualizar detalhes de uma funcionalidade específica"
      uc_ids: ["UC01"]
      perfis_obrigatorios:
        - "Developer"
      perfis_sugeridos:
        - "Super Admin"
        - "Admin"
        - "User"

    - acao: "MANAGE_EXCLUSIVES"
      codigo: "CENTRAL_MODULOS.MANAGE_EXCLUSIVES"
      nome: "Gerenciar Empresas Exclusivas"
      descricao: "Permite definir quais empresas têm acesso exclusivo a funcionalidades"
      uc_ids: ["UC04"]
      perfis_obrigatorios:
        - "Developer"
      perfis_sugeridos: []

    - acao: "RESET"
      codigo: "CENTRAL_MODULOS.RESET"
      nome: "Resetar Funcionalidades"
      descricao: "Permite resetar e repopular funcionalidades com dados padrão (destrutivo)"
      uc_ids: ["UC05"]
      perfis_obrigatorios:
        - "Developer"
      perfis_sugeridos:
        - "Super Admin"

  validacao_rbac:
    - item: "Todas as ações possuem permissão específica?"
      status: "ok"
    - item: "Perfil Developer associado a TODAS as permissões?"
      status: "ok"
    - item: "Módulo registrado na Central de Funcionalidades?"
      status: "ok"
    - item: "Código de permissões segue padrão MODULO.ENTIDADE.ACAO?"
      status: "ok"

# =============================================
# ESPECIFICAÇÕES DE TESTE
# =============================================
especificacoes_teste:
  navegacao:
    url_base: "/management/central-modulos"
    rotas:
      - acao: "listar"
        url: "/management/central-modulos"
        metodo: "GET"
      - acao: "visualizar"
        url: "/management/central-modulos/:id"
        metodo: "GET"
      - acao: "estatisticas"
        url: "/api/funcionalidades/estatisticas"
        metodo: "GET"
      - acao: "empresas_exclusivas"
        url: "/api/funcionalidades/:id/empresas-exclusivas"
        metodo: "PUT"
      - acao: "reset"
        url: "/api/funcionalidades/reset"
        metodo: "POST"

  credenciais:
    perfil_developer:
      usuario: "developer@icontrolit.com"
      senha: "Test@1234"
      perfil: "Developer"
    perfil_admin:
      usuario: "admin@icontrolit.com"
      senha: "Test@1234"
      perfil: "Admin"
    perfil_user:
      usuario: "user@icontrolit.com"
      senha: "Test@1234"
      perfil: "User"

  data_test_attributes:
    - uc_id: "UC00"
      passo: 1
      descricao: "Usuário acessa Central de Módulos pelo menu"
      elementos:
        - id: "menu-central-modulos"
          tipo: "link"
          obrigatorio: true
        - id: "sidebar-sistema"
          tipo: "menu-group"
          obrigatorio: true

    - uc_id: "UC00"
      passo: 9
      descricao: "Sistema exibe a lista agrupada por categoria"
      elementos:
        - id: "funcionalidades-list"
          tipo: "list"
          obrigatorio: true
        - id: "categoria-group"
          tipo: "collapsible"
          obrigatorio: true
        - id: "funcionalidade-item"
          tipo: "list-item"
          obrigatorio: true
        - id: "funcionalidade-acoes"
          tipo: "action-list"
          obrigatorio: false

    - uc_id: "UC01"
      passo: 1
      descricao: "Usuário seleciona funcionalidade na lista"
      elementos:
        - id: "funcionalidade-item"
          tipo: "clickable"
          obrigatorio: true

    - uc_id: "UC01"
      passo: 10
      descricao: "Sistema exibe detalhes completos"
      elementos:
        - id: "funcionalidade-detalhes"
          tipo: "panel"
          obrigatorio: true
        - id: "funcionalidade-codigo"
          tipo: "text"
          obrigatorio: true
        - id: "funcionalidade-nome"
          tipo: "text"
          obrigatorio: true
        - id: "funcionalidade-descricao"
          tipo: "text"
          obrigatorio: false
        - id: "funcionalidade-acoes-list"
          tipo: "list"
          obrigatorio: true
        - id: "funcionalidade-filhas-list"
          tipo: "list"
          obrigatorio: false
        - id: "funcionalidade-exclusivas"
          tipo: "badge-list"
          obrigatorio: true

    - uc_id: "UC03"
      passo: 6
      descricao: "Sistema exibe dashboard com estatísticas"
      elementos:
        - id: "estatisticas-total"
          tipo: "counter"
          obrigatorio: true
        - id: "estatisticas-acoes"
          tipo: "counter"
          obrigatorio: true
        - id: "estatisticas-ativas"
          tipo: "counter"
          obrigatorio: true
        - id: "estatisticas-por-categoria"
          tipo: "chart"
          obrigatorio: true

    - uc_id: "UC04"
      passo: 3
      descricao: "Developer clica em Gerenciar Empresas Exclusivas"
      elementos:
        - id: "btn-gerenciar-exclusivas"
          tipo: "button"
          obrigatorio: true

    - uc_id: "UC04"
      passo: 4
      descricao: "Sistema exibe modal com lista de empresas"
      elementos:
        - id: "modal-empresas-exclusivas"
          tipo: "modal"
          obrigatorio: true
        - id: "empresas-checkbox-list"
          tipo: "checkbox-list"
          obrigatorio: true
        - id: "btn-confirmar-exclusivas"
          tipo: "button"
          obrigatorio: true
        - id: "btn-cancelar-exclusivas"
          tipo: "button"
          obrigatorio: true

    - uc_id: "UC05"
      passo: 3
      descricao: "Usuário clica em Resetar Funcionalidades"
      elementos:
        - id: "btn-resetar-funcionalidades"
          tipo: "button"
          obrigatorio: true

    - uc_id: "UC05"
      passo: 4
      descricao: "Sistema exibe alerta de operação destrutiva"
      elementos:
        - id: "modal-alerta-destrutivo"
          tipo: "modal"
          obrigatorio: true
        - id: "input-confirmacao"
          tipo: "input"
          obrigatorio: true
        - id: "btn-confirmar-reset"
          tipo: "button"
          obrigatorio: true

    - uc_id: "UC06"
      passo: 2
      descricao: "Usuário clica no ícone de expandir/contrair"
      elementos:
        - id: "btn-expandir-categoria"
          tipo: "button"
          obrigatorio: true
        - id: "icon-expandir"
          tipo: "icon"
          obrigatorio: true

    - uc_id: "UC07"
      passo: 2
      descricao: "Usuário aplica filtro por nome/código"
      elementos:
        - id: "input-filtro-busca"
          tipo: "input"
          obrigatorio: true
        - id: "select-filtro-categoria"
          tipo: "select"
          obrigatorio: false
        - id: "select-filtro-status"
          tipo: "select"
          obrigatorio: false
        - id: "btn-limpar-filtros"
          tipo: "button"
          obrigatorio: true

  estados_ui:
    - estado: "loading"
      descricao: "Exibido durante carregamento de funcionalidades"
      data_test: "loading-spinner"
      obrigatorio: true

    - estado: "vazio"
      descricao: "Exibido quando não há funcionalidades (após filtro)"
      data_test: "empty-state"
      obrigatorio: true

    - estado: "erro"
      descricao: "Exibido quando ocorre erro de API"
      data_test: "error-state"
      obrigatorio: true

    - estado: "sucesso"
      descricao: "Feedback após ação bem-sucedida"
      data_test: "success-message"
      obrigatorio: true

    - estado: "confirmacao"
      descricao: "Modal de confirmação para ações destrutivas"
      data_test: "confirmation-modal"
      obrigatorio: true

  timeouts_e2e:
    navegacao: 5000
    carregamento_lista: 3000
    carregamento_detalhes: 2000
    salvamento: 5000
    reset: 10000
    api_timeout: 10000

  validacao_especificacoes:
    - item: "Todas as URLs documentadas?"
      status: "ok"
    - item: "Data-test especificados para TODOS os passos interativos?"
      status: "ok"
    - item: "Estados UI (loading, vazio, erro) especificados?"
      status: "ok"
    - item: "Timeouts especificados para cada operação?"
      status: "ok"
    - item: "Credenciais por perfil documentadas?"
      status: "ok"

# =============================================
# CASOS DE USO
# =============================================
casos_de_uso:

  - id: "UC00"
    nome: "Listar Funcionalidades"
    ator_principal: "usuario_autenticado"
    tipo: "leitura"
    impacta_dados: false

    covers:
      documentacao_items:
        - "RF-CRUD-02"
      uc_items:
        - id: "FP-UC00-001"
          title: "Usuário acessa Central de Módulos pelo menu"
          required: true
        - id: "FP-UC00-002"
          title: "Sistema valida autenticação"
          required: true
        - id: "FP-UC00-003"
          title: "Sistema identifica perfil do usuário"
          required: true
        - id: "FP-UC00-004"
          title: "Sistema aplica filtro por perfil (RN-RF083-02)"
          required: true
        - id: "FP-UC00-005"
          title: "Sistema carrega funcionalidades ativas não excluídas"
          required: true
        - id: "FP-UC00-006"
          title: "Sistema inclui ações associadas"
          required: false
        - id: "FP-UC00-007"
          title: "Sistema inclui funcionalidades filhas"
          required: false
        - id: "FP-UC00-008"
          title: "Sistema aplica ordenação"
          required: true
        - id: "FP-UC00-009"
          title: "Sistema exibe a lista agrupada por categoria"
          required: true
        - id: "FA-UC00-001"
          title: "Filtrar por categoria específica"
          required: false
        - id: "FA-UC00-002"
          title: "Filtrar apenas funcionalidades ativas/inativas"
          required: false
        - id: "FA-UC00-003"
          title: "Buscar por nome ou código"
          required: false
        - id: "FE-UC00-001"
          title: "Usuário não autenticado → redirect para login"
          required: true
        - id: "FE-UC00-002"
          title: "Nenhuma funcionalidade encontrada → estado vazio"
          required: true

    precondicoes:
      - permissao: "CENTRAL_MODULOS.VIEW_ANY"

    gatilho: "Usuário acessa Central de Módulos pelo menu lateral"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "acessa_menu_central_modulos"
        data_test: "menu-central-modulos"
      - passo: 2
        ator: "sistema"
        acao: "validar_autenticacao"
      - passo: 3
        ator: "sistema"
        acao: "identificar_perfil_usuario"
      - passo: 4
        ator: "sistema"
        acao: "aplicar_filtro_perfil"
      - passo: 5
        ator: "sistema"
        acao: "carregar_funcionalidades"
      - passo: 6
        ator: "sistema"
        acao: "aplicar_ordenacao"
      - passo: 7
        ator: "sistema"
        acao: "exibir_lista_agrupada"
        data_test: "funcionalidades-list"

    fluxos_alternativos:
      - id: "FA-UC00-01"
        condicao: "usuario_filtra_categoria"
        resultado: "lista_filtrada_categoria"
      - id: "FA-UC00-02"
        condicao: "usuario_filtra_status"
        resultado: "lista_filtrada_status"
      - id: "FA-UC00-03"
        condicao: "usuario_busca_termo"
        resultado: "lista_filtrada_termo"

    fluxos_excecao:
      - id: "FE-UC00-01"
        condicao: "nao_autenticado"
        resultado: "redirect_login"
        http_esperado: 401
      - id: "FE-UC00-02"
        condicao: "nenhum_resultado"
        resultado: "exibir_estado_vazio"
        data_test: "empty-state"

    regras_aplicadas:
      - "RN-RF083-02"
      - "RN-RF083-05"
      - "RN-RF083-11"

    resultado_final:
      estado: "lista_funcionalidades_exibida"

  - id: "UC01"
    nome: "Visualizar Funcionalidade"
    ator_principal: "usuario_autenticado"
    tipo: "leitura"
    impacta_dados: false

    covers:
      documentacao_items:
        - "RF-CRUD-03"
      uc_items:
        - id: "FP-UC01-001"
          title: "Usuário seleciona funcionalidade na lista"
          required: true
        - id: "FP-UC01-002"
          title: "Sistema valida autenticação"
          required: true
        - id: "FP-UC01-003"
          title: "Sistema carrega funcionalidade por ID"
          required: true
        - id: "FP-UC01-004"
          title: "Sistema verifica existência e soft delete"
          required: true
        - id: "FP-UC01-005"
          title: "Sistema carrega ações associadas"
          required: true
        - id: "FP-UC01-006"
          title: "Sistema carrega funcionalidades filhas"
          required: true
        - id: "FP-UC01-007"
          title: "Sistema carrega empresas exclusivas"
          required: true
        - id: "FP-UC01-008"
          title: "Sistema calcula estatísticas"
          required: true
        - id: "FP-UC01-009"
          title: "Sistema verifica Feature Flag vinculada"
          required: false
        - id: "FP-UC01-010"
          title: "Sistema exibe detalhes completos"
          required: true
        - id: "FE-UC01-001"
          title: "Funcionalidade não encontrada → 404"
          required: true
        - id: "FE-UC01-002"
          title: "Funcionalidade excluída → 404"
          required: true

    precondicoes:
      - permissao: "CENTRAL_MODULOS.VIEW"

    gatilho: "Usuário clica em uma funcionalidade na lista"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "selecionar_funcionalidade"
        data_test: "funcionalidade-item"
      - passo: 2
        ator: "sistema"
        acao: "validar_autenticacao"
      - passo: 3
        ator: "sistema"
        acao: "carregar_funcionalidade_por_id"
      - passo: 4
        ator: "sistema"
        acao: "validar_existencia_soft_delete"
      - passo: 5
        ator: "sistema"
        acao: "carregar_acoes"
      - passo: 6
        ator: "sistema"
        acao: "carregar_filhas"
      - passo: 7
        ator: "sistema"
        acao: "carregar_exclusivas"
      - passo: 8
        ator: "sistema"
        acao: "calcular_estatisticas"
      - passo: 9
        ator: "sistema"
        acao: "verificar_feature_flag"
      - passo: 10
        ator: "sistema"
        acao: "exibir_detalhes"
        data_test: "funcionalidade-detalhes"

    fluxos_excecao:
      - id: "FE-UC01-01"
        condicao: "funcionalidade_nao_encontrada"
        resultado: "retornar_404"
        http_esperado: 404
      - id: "FE-UC01-02"
        condicao: "funcionalidade_excluida"
        resultado: "retornar_404"
        http_esperado: 404

    regras_aplicadas:
      - "RN-RF083-05"
      - "RN-RF083-07"

    resultado_final:
      estado: "detalhes_funcionalidade_exibidos"

  - id: "UC02"
    nome: "Listar Funcionalidades por Categoria"
    ator_principal: "usuario_autenticado"
    tipo: "leitura"
    impacta_dados: false

    covers:
      documentacao_items:
        - "RF-CRUD-02.1"
      uc_items:
        - id: "FP-UC02-001"
          title: "Usuário seleciona categoria no filtro"
          required: true
        - id: "FP-UC02-002"
          title: "Sistema valida autenticação"
          required: true
        - id: "FP-UC02-003"
          title: "Sistema aplica filtro por perfil"
          required: true
        - id: "FP-UC02-004"
          title: "Sistema carrega funcionalidades da categoria"
          required: true
        - id: "FP-UC02-005"
          title: "Sistema aplica filtro ativos/não excluídos"
          required: true
        - id: "FP-UC02-006"
          title: "Sistema aplica ordenação"
          required: true
        - id: "FP-UC02-007"
          title: "Sistema exibe lista filtrada"
          required: true
        - id: "FA-UC02-001"
          title: "Limpar filtro de categoria"
          required: false
        - id: "FE-UC02-001"
          title: "Categoria sem funcionalidades → estado vazio"
          required: true

    precondicoes:
      - permissao: "CENTRAL_MODULOS.VIEW_ANY"

    gatilho: "Usuário seleciona categoria no filtro dropdown"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "selecionar_categoria"
        data_test: "select-filtro-categoria"
      - passo: 2
        ator: "sistema"
        acao: "validar_autenticacao"
      - passo: 3
        ator: "sistema"
        acao: "aplicar_filtro_perfil"
      - passo: 4
        ator: "sistema"
        acao: "carregar_funcionalidades_categoria"
      - passo: 5
        ator: "sistema"
        acao: "aplicar_filtros_ativos"
      - passo: 6
        ator: "sistema"
        acao: "aplicar_ordenacao"
      - passo: 7
        ator: "sistema"
        acao: "exibir_lista_filtrada"
        data_test: "funcionalidades-list"

    fluxos_alternativos:
      - id: "FA-UC02-01"
        condicao: "usuario_limpa_filtro"
        resultado: "lista_completa_exibida"

    fluxos_excecao:
      - id: "FE-UC02-01"
        condicao: "categoria_vazia"
        resultado: "exibir_estado_vazio"
        data_test: "empty-state"

    regras_aplicadas:
      - "RN-RF083-02"
      - "RN-RF083-05"
      - "RN-RF083-12"

    resultado_final:
      estado: "lista_filtrada_categoria_exibida"

  - id: "UC03"
    nome: "Obter Estatísticas"
    ator_principal: "usuario_autenticado"
    tipo: "leitura"
    impacta_dados: false

    covers:
      documentacao_items:
        - "RF-CRUD-06"
      uc_items:
        - id: "FP-UC03-001"
          title: "Usuário acessa área de estatísticas"
          required: true
        - id: "FP-UC03-002"
          title: "Sistema valida autenticação"
          required: true
        - id: "FP-UC03-003"
          title: "Sistema calcula total de funcionalidades"
          required: true
        - id: "FP-UC03-004"
          title: "Sistema calcula total de ações"
          required: true
        - id: "FP-UC03-005"
          title: "Sistema agrupa por categoria"
          required: true
        - id: "FP-UC03-006"
          title: "Sistema exibe dashboard"
          required: true

    precondicoes:
      - permissao: "CENTRAL_MODULOS.VIEW_ANY"

    gatilho: "Usuário acessa área de estatísticas na Central de Módulos"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "acessar_estatisticas"
        data_test: "btn-estatisticas"
      - passo: 2
        ator: "sistema"
        acao: "validar_autenticacao"
      - passo: 3
        ator: "sistema"
        acao: "calcular_total_funcionalidades"
      - passo: 4
        ator: "sistema"
        acao: "calcular_total_acoes"
      - passo: 5
        ator: "sistema"
        acao: "agrupar_por_categoria"
      - passo: 6
        ator: "sistema"
        acao: "exibir_dashboard"
        data_test: "estatisticas-dashboard"

    regras_aplicadas:
      - "RN-RF083-14"

    resultado_final:
      estado: "estatisticas_exibidas"

  - id: "UC04"
    nome: "Gerenciar Empresas Exclusivas"
    ator_principal: "developer"
    tipo: "crud"
    impacta_dados: true

    covers:
      documentacao_items:
        - "RF-CRUD-04.1"
      uc_items:
        - id: "FP-UC04-001"
          title: "Developer acessa detalhes da funcionalidade"
          required: true
        - id: "FP-UC04-002"
          title: "Sistema valida se usuário é Developer"
          required: true
        - id: "FP-UC04-003"
          title: "Developer clica em Gerenciar Empresas Exclusivas"
          required: true
        - id: "FP-UC04-004"
          title: "Sistema exibe modal com lista de empresas"
          required: true
        - id: "FP-UC04-005"
          title: "Developer seleciona empresas"
          required: true
        - id: "FP-UC04-006"
          title: "Developer confirma alteração"
          required: true
        - id: "FP-UC04-007"
          title: "Sistema valida IDs das empresas"
          required: true
        - id: "FP-UC04-008"
          title: "Sistema persiste alteração"
          required: true
        - id: "FP-UC04-009"
          title: "Sistema registra auditoria"
          required: true
        - id: "FP-UC04-010"
          title: "Sistema exibe confirmação de sucesso"
          required: true
        - id: "FA-UC04-001"
          title: "Limpar exclusividade (todas empresas)"
          required: false
        - id: "FA-UC04-002"
          title: "Cancelar operação"
          required: false
        - id: "FE-UC04-001"
          title: "Usuário não é Developer → 403"
          required: true
        - id: "FE-UC04-002"
          title: "Empresa inexistente → erro validação"
          required: true
        - id: "FE-UC04-003"
          title: "Funcionalidade não encontrada → 404"
          required: true

    precondicoes:
      - permissao: "CENTRAL_MODULOS.MANAGE_EXCLUSIVES"
      - perfil: "Developer"

    gatilho: "Developer clica em Gerenciar Empresas Exclusivas"

    fluxo_principal:
      - passo: 1
        ator: "developer"
        acao: "acessar_detalhes_funcionalidade"
        data_test: "funcionalidade-item"
      - passo: 2
        ator: "sistema"
        acao: "validar_perfil_developer"
      - passo: 3
        ator: "developer"
        acao: "clicar_gerenciar_exclusivas"
        data_test: "btn-gerenciar-exclusivas"
      - passo: 4
        ator: "sistema"
        acao: "exibir_modal_empresas"
        data_test: "modal-empresas-exclusivas"
      - passo: 5
        ator: "developer"
        acao: "selecionar_empresas"
        data_test: "empresas-checkbox-list"
      - passo: 6
        ator: "developer"
        acao: "confirmar_alteracao"
        data_test: "btn-confirmar-exclusivas"
      - passo: 7
        ator: "sistema"
        acao: "validar_ids_empresas"
      - passo: 8
        ator: "sistema"
        acao: "persistir_alteracao"
      - passo: 9
        ator: "sistema"
        acao: "registrar_auditoria"
      - passo: 10
        ator: "sistema"
        acao: "exibir_sucesso"
        data_test: "success-message"

    fluxos_alternativos:
      - id: "FA-UC04-01"
        condicao: "developer_limpa_exclusividade"
        resultado: "funcionalidade_disponivel_todas"
      - id: "FA-UC04-02"
        condicao: "developer_cancela"
        resultado: "modal_fechado_sem_alteracao"

    fluxos_excecao:
      - id: "FE-UC04-01"
        condicao: "usuario_nao_developer"
        resultado: "retornar_403"
        http_esperado: 403
      - id: "FE-UC04-02"
        condicao: "empresa_inexistente"
        resultado: "exibir_erro_validacao"
        http_esperado: 400
      - id: "FE-UC04-03"
        condicao: "funcionalidade_nao_encontrada"
        resultado: "retornar_404"
        http_esperado: 404

    regras_aplicadas:
      - "RN-RF083-03"
      - "RN-RF083-04"
      - "RN-RF083-13"

    resultado_final:
      estado: "empresas_exclusivas_atualizadas"

  - id: "UC05"
    nome: "Resetar Funcionalidades"
    ator_principal: "developer_ou_super_admin"
    tipo: "admin"
    impacta_dados: true

    covers:
      documentacao_items:
        - "RF-ADMIN-01"
      uc_items:
        - id: "FP-UC05-001"
          title: "Usuário acessa área administrativa"
          required: true
        - id: "FP-UC05-002"
          title: "Sistema valida perfil Developer ou Super Admin"
          required: true
        - id: "FP-UC05-003"
          title: "Usuário clica em Resetar Funcionalidades"
          required: true
        - id: "FP-UC05-004"
          title: "Sistema exibe alerta de operação destrutiva"
          required: true
        - id: "FP-UC05-005"
          title: "Sistema solicita confirmação explícita"
          required: true
        - id: "FP-UC05-006"
          title: "Usuário confirma operação"
          required: true
        - id: "FP-UC05-007"
          title: "Sistema deleta funcionalidades existentes"
          required: true
        - id: "FP-UC05-008"
          title: "Sistema recria com dados padrão"
          required: true
        - id: "FP-UC05-009"
          title: "Sistema registra auditoria"
          required: true
        - id: "FP-UC05-010"
          title: "Sistema exibe resultado"
          required: true
        - id: "FA-UC05-001"
          title: "Cancelar operação"
          required: false
        - id: "FE-UC05-001"
          title: "Usuário não autorizado → 403"
          required: true
        - id: "FE-UC05-002"
          title: "Erro durante reset → rollback"
          required: true

    precondicoes:
      - permissao: "CENTRAL_MODULOS.RESET"
      - perfil: "Developer OU Super Admin"

    gatilho: "Usuário clica em Resetar Funcionalidades na área administrativa"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "acessar_area_admin"
        data_test: "menu-admin"
      - passo: 2
        ator: "sistema"
        acao: "validar_perfil_autorizado"
      - passo: 3
        ator: "usuario"
        acao: "clicar_resetar"
        data_test: "btn-resetar-funcionalidades"
      - passo: 4
        ator: "sistema"
        acao: "exibir_alerta_destrutivo"
        data_test: "modal-alerta-destrutivo"
      - passo: 5
        ator: "sistema"
        acao: "solicitar_confirmacao"
        data_test: "input-confirmacao"
      - passo: 6
        ator: "usuario"
        acao: "digitar_confirmar"
      - passo: 7
        ator: "sistema"
        acao: "deletar_funcionalidades"
      - passo: 8
        ator: "sistema"
        acao: "recriar_dados_padrao"
      - passo: 9
        ator: "sistema"
        acao: "registrar_auditoria"
      - passo: 10
        ator: "sistema"
        acao: "exibir_resultado"
        data_test: "success-message"

    fluxos_alternativos:
      - id: "FA-UC05-01"
        condicao: "usuario_cancela"
        resultado: "operacao_cancelada"

    fluxos_excecao:
      - id: "FE-UC05-01"
        condicao: "usuario_nao_autorizado"
        resultado: "retornar_403"
        http_esperado: 403
      - id: "FE-UC05-02"
        condicao: "erro_durante_reset"
        resultado: "rollback_e_erro"
        http_esperado: 500

    regras_aplicadas:
      - "RN-RF083-15"

    resultado_final:
      estado: "funcionalidades_resetadas"

  - id: "UC06"
    nome: "Expandir/Contrair Categorias"
    ator_principal: "usuario_autenticado"
    tipo: "interface"
    impacta_dados: false

    covers:
      documentacao_items: []
      uc_items:
        - id: "FP-UC06-001"
          title: "Usuário visualiza lista por categoria"
          required: true
        - id: "FP-UC06-002"
          title: "Usuário clica no ícone expandir/contrair"
          required: true
        - id: "FP-UC06-003"
          title: "Sistema alterna estado visual"
          required: true
        - id: "FP-UC06-004"
          title: "Sistema persiste preferência (localStorage)"
          required: false
        - id: "FA-UC06-001"
          title: "Expandir todas as categorias"
          required: false
        - id: "FA-UC06-002"
          title: "Contrair todas as categorias"
          required: false

    precondicoes: []

    gatilho: "Usuário clica no ícone de expandir/contrair categoria"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "visualizar_lista_categorias"
        data_test: "categoria-group"
      - passo: 2
        ator: "usuario"
        acao: "clicar_expandir_contrair"
        data_test: "btn-expandir-categoria"
      - passo: 3
        ator: "sistema"
        acao: "alternar_estado_visual"
      - passo: 4
        ator: "sistema"
        acao: "persistir_preferencia"

    fluxos_alternativos:
      - id: "FA-UC06-01"
        condicao: "usuario_expande_todas"
        resultado: "todas_categorias_expandidas"
      - id: "FA-UC06-02"
        condicao: "usuario_contrai_todas"
        resultado: "todas_categorias_contraidas"

    regras_aplicadas: []

    resultado_final:
      estado: "estado_categoria_alterado"

  - id: "UC07"
    nome: "Filtrar Funcionalidades"
    ator_principal: "usuario_autenticado"
    tipo: "leitura"
    impacta_dados: false

    covers:
      documentacao_items:
        - "RF-CRUD-02"
      uc_items:
        - id: "FP-UC07-001"
          title: "Usuário acessa Central de Módulos"
          required: true
        - id: "FP-UC07-002"
          title: "Usuário aplica filtro por nome/código"
          required: true
        - id: "FP-UC07-003"
          title: "Sistema filtra em tempo real"
          required: true
        - id: "FP-UC07-004"
          title: "Sistema exibe resultados filtrados"
          required: true
        - id: "FP-UC07-005"
          title: "Sistema atualiza URL com parâmetros"
          required: true
        - id: "FA-UC07-001"
          title: "Filtrar por status (ativo/inativo)"
          required: false
        - id: "FA-UC07-002"
          title: "Filtrar por categoria"
          required: false
        - id: "FA-UC07-003"
          title: "Limpar todos os filtros"
          required: false

    precondicoes:
      - permissao: "CENTRAL_MODULOS.VIEW_ANY"

    gatilho: "Usuário digita texto no campo de busca"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "acessar_central_modulos"
        data_test: "menu-central-modulos"
      - passo: 2
        ator: "usuario"
        acao: "digitar_termo_busca"
        data_test: "input-filtro-busca"
      - passo: 3
        ator: "sistema"
        acao: "filtrar_tempo_real"
      - passo: 4
        ator: "sistema"
        acao: "exibir_resultados"
        data_test: "funcionalidades-list"
      - passo: 5
        ator: "sistema"
        acao: "atualizar_url"

    fluxos_alternativos:
      - id: "FA-UC07-01"
        condicao: "usuario_filtra_status"
        resultado: "lista_filtrada_status"
      - id: "FA-UC07-02"
        condicao: "usuario_filtra_categoria"
        resultado: "lista_filtrada_categoria"
      - id: "FA-UC07-03"
        condicao: "usuario_limpa_filtros"
        resultado: "lista_completa_restaurada"

    regras_aplicadas:
      - "RN-RF083-02"

    resultado_final:
      estado: "lista_filtrada_exibida"

# =============================================
# EXCLUSÕES
# =============================================
exclusions:
  uc_items:
    - item: "CRUD completo de criação/edição de funcionalidades"
      motivo: "Funcionalidades são gerenciadas via código/seeds, não via interface"
    - item: "Drag-and-drop de ordenação"
      motivo: "Existente no frontend, mas fora do escopo deste RF"
    - item: "Versionamento de funcionalidades"
      motivo: "Não implementado, fora do escopo atual"

# =============================================
# HISTÓRICO
# =============================================
historico:
  - versao: "2.0"
    data: "2026-01-30"
    autor: "Agência ALC - alc.dev.br"
    descricao: |
      Versão inicial UC-RF083 - Central de Módulos:
      - 8 Casos de Uso cobrindo funcionalidades de leitura, administração e interface
      - UC00: Listar Funcionalidades (com isolamento por perfil)
      - UC01: Visualizar Funcionalidade
      - UC02: Listar por Categoria
      - UC03: Obter Estatísticas
      - UC04: Gerenciar Empresas Exclusivas (Developer)
      - UC05: Resetar Funcionalidades (Developer/Super Admin)
      - UC06: Expandir/Contrair Categorias (UI)
      - UC07: Filtrar Funcionalidades
      - Seção RBAC com 4 permissões específicas
      - Especificações de teste E2E com data-test attributes
      - Cobertura de 22 regras de negócio do RF083
