rf: RF035
fase: Fase-6-Ativos-Auditoria-Integracoes
epic: EPIC010-AUD-Auditoria-Avancada
titulo: Gestao de Resumos Auditoria


skeleton:
  criado: True
  data_criacao: "2025-12-27"
  observacao: "Backend parcialmente implementado: 15% completo. Implementado: CRUD basico Resumos Auditoria (5 endpoints - ResumosAuditoria.cs). Faltam: Criacao automatica resumo ao adicionar primeiro item fatura/lote (regra RN001: verificar se ja existe resumo, se nao criar automaticamente com totais zerados), recalculo automatico totais via Domain Events (INotificationHandler AuditoriaItemCriado/Editado/Excluido para recalcular ValorCobrado + ValorCorreto + ValorCobradoAMais + Porcentagem sempre que item modificado), calculo PercentualDivergencia = ((ValorCobrado - ValorCorreto) / ValorCorreto) * 100 (tratar divisao por zero quando ValorCorreto = 0), validacao consistencia resumo vs. soma itens (totalizadores devem bater exatamente com SUM dos itens ativos), agrupamento temporal por periodo Lote AAAAMM (analise evolucao mensal qualidade faturamento), dashboard executivo (top 10 faturas maior divergencia, evolucao temporal qualidade Chart.js Line, comparativo por operadora Pie Chart, ROI auditoria com % recuperado), relatorio executivo PDF export (consolidacao dados + graficos + evidencias), exportacao Excel estruturada (planilha analitica com drill-down para itens), integracao sistema contestacoes (enviar resumos aprovados para workflow contestacao formal), BI Machine Learning (predicao tendencias, deteccao anomalias, clustering faturas problematicas)."
documentacao:
  versao: "2.0"  # Governança v2.0 - Separação RF/RL
  data_migracao: "2025-12-30"
  documentacao: True        # RFXXX.md v2.0 (contrato moderno - 11 seções)
  documentacao_yaml: True   # RFXXX.yaml (estruturado - sincronizado com RF.md)
  rl: True        # RL-RFXXX.md (referência ao legado - 7 seções)
  rl_yaml: True   # RL-RFXXX.yaml (rastreabilidade - 100% com destinos)
  uc: True
  uc_yaml: True   # UC-RFXXX.yaml validado - 100% conformidade (2025-12-31)
  md: True
  wf: True

  arquivos_obrigatorios_presentes: True
  separacao_rf_rl_validada: True

desenvolvimento:
  backend:
    status: skeleton   # not_started | in_progress | done | skeleton
    contrato_validado: true
    contrato: CONTRATO-EXECUCAO-BACKEND
    versao_contrato: v1.0
    branch: null
  frontend:
    status: done
    branch: feature/RF035-frontend

testes:
  backend: not_run        # not_run | pass | fail
  frontend: not_run
  e2e: not_run
  seguranca: not_run

documentacao_testes:
  backend: False
  frontend: False
  e2e: False
  seguranca: False

testes_ti:
  backend: not_run
  frontend: not_run
  e2e: not_run
  seguranca: not_run

testes_qa:
  executado: False       # True quando QA executou
  aprovado: False        # True quando usuario aprovou

devops:
  work_item_id: 564
  test_plan_id: null
  last_sync: "2025-12-27 15:31:37"
  board_column: "Skeleton"

# ==============================================================================
# VALIDAÇÃO SEPARAÇÃO RF/RL (OBRIGATÓRIA v2.0)
# ==============================================================================

separacao_rf_rl:
  documentacao_limpo: True                # RF não contém conteúdo legado
  rl_completo: True             # RL contém TODA memória legado
  itens_com_destino: True       # 100% itens RL têm campo destino
  validador_executado: True     # validator-rl.py passou (exit code 0)
  validador_data: "2025-12-30"
  validador_resultado: "5 gaps menores (não bloqueantes)"

# ==============================================================================
# ESTATÍSTICAS MIGRAÇÃO
# ==============================================================================

estatisticas:
  total_rns: 11                 # Regras de negócio extraídas (RN-RF035-001 a 011)
  total_endpoints_api: 18       # Endpoints REST documentados (5 CRUD + 13 especiais)
  total_permissoes_rbac: 9      # Permissões RBAC definidas
  total_integracoes_obrigatorias: 4  # i18n, auditoria, RBAC, Central
  itens_legado_rastreados: 17   # Itens em RL-RFXXX.yaml
  bancos_legados_mapeados: 1    # Banco "Auditoria" (SQL Server)
  problemas_legado_identificados: 6  # Problemas documentados em RL

  linhas_documentacao:
    documentacao_md: 590
    documentacao_yaml: 632
    rl_md: 586
    rl_yaml: 656
    total: 2464

governanca:
  contrato_ativo: CONTRATO-EXECUCAO-TESTES
  ultimo_manifesto: null
  migracao_v2_completa: True
  data_migracao_v2: "2025-12-30"
