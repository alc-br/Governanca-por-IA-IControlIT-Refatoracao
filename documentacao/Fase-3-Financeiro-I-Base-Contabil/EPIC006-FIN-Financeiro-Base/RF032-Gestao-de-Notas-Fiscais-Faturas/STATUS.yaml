rf: RF032
fase: Fase-3-Financeiro-I-Base-Contabil
epic: EPIC006-FIN-Financeiro-Base
titulo: Gestao de Notas Fiscais Faturas


skeleton:
  criado: True
  data_criacao: "2025-12-27"
  observacao: "Backend parcialmente implementado: 15% completo. Implementado: CRUD basico Notas Fiscais vinculadas a Faturas (inferido via documentacao, arquivo backend nao encontrado via Glob). Faltam: Importacao XML NF-e automatizada (parser XML padrao NFe 4.0 + validacao schema XSD), integracao sistema contabilidade externo (API REST SAP/TOTVS/Protheus com retry automatico 3x), geracao relatorios contabeis (DRE por centro custo + filial, balancete analitico, razao auxiliar com drill-down), calculo impostos ICMS/PIS/COFINS/ISS (aliquotas por UF + regime tributario Simples/Real/Presumido), validacao unicidade numero NF por Fornecedor (indice unico composto NumeroNotaFiscal + FornecedorId com tratamento duplicidade), validacao soma percentuais rateio = 100% (regra critica RN003: validar soma ao criar/editar nota, alertar se <100%, bloquear se >100%), workflow aprovacao multi-nivel (NF >R$10k exige aprovacao gestor + controller), exportacao lançamentos contabeis formato D-E Debito-Credito (integracao ERP), dashboard consolidacao fiscal (top 10 fornecedores, distribuicao por centro custo, evolucao temporal Chart.js)."
documentacao:
  versao: "2.0"
  data_migracao: "2025-12-30"
  documentacao: true                # RF032.md v2.0 criado (contrato moderno)
  documentacao_yaml: true           # RF032.yaml criado (estruturado)
  rl: true                # RL-RF032.md criado (memória legado)
  rl_yaml: true           # RL-RF032.yaml criado (rastreabilidade)
  uc: true                # UC-RF032.md v2.0 recriado (completo)
  uc_yaml: true           # ✅ UC-RF032.yaml criado e validado em 2025-12-31
  md: true
  wf: true

  arquivos_obrigatorios_presentes: true
  separacao_rf_rl_validada: true
  uc_validado_100_porcento: true  # ✅ Validador passou sem gaps

desenvolvimento:
  backend:
    status: skeleton   # not_started | in_progress | done | skeleton
    contrato_validado: true
    contrato: CONTRATO-EXECUCAO-BACKEND
    versao_contrato: v1.0
    branch: null
  frontend:
    status: done
    branch: feature/RF032-frontend

testes:
  backend: not_run        # not_run | pass | fail
  frontend: not_run
  e2e: not_run
  seguranca: not_run

documentacao_testes:
  backend: True
  frontend: False
  e2e: False
  seguranca: False

testes_ti:
  backend: not_run
  frontend: not_run
  e2e: not_run
  seguranca: not_run

testes_qa:
  executado: False       # True quando QA executou
  aprovado: False        # True quando usuario aprovou

devops:
  work_item_id: 562
  test_plan_id: null
  last_sync: "2025-12-27 15:31:35"
  board_column: "Skeleton"

# ==============================================================================
# VALIDAÇÃO SEPARAÇÃO RF/RL (OBRIGATÓRIA v2.0)
# ==============================================================================

separacao_rf_rl:
  documentacao_limpo: true                # RF não contém conteúdo legado
  rl_completo: true             # RL contém TODA memória legado
  itens_com_destino: true       # 100% itens RL têm campo destino
  validador_executado: true     # validator-rl.py passou (exit code 0)

# ==============================================================================
# ESTATÍSTICAS MIGRAÇÃO
# ==============================================================================

estatisticas:
  total_rns: 10                 # Regras de negócio extraídas
  total_endpoints_api: 21       # Endpoints REST documentados
  total_permissoes_rbac: 12     # Permissões RBAC definidas
  total_integracoes_obrigatorias: 4  # i18n, auditoria, RBAC, Central
  itens_legado_rastreados: 19   # Itens em RL-RF032.yaml
  bancos_legados_mapeados: 1    # Bancos SQL Server antigos
  problemas_legado_identificados: 13  # Problemas documentados (gaps)

  linhas_documentacao:
    documentacao_md: 682
    documentacao_yaml: 411
    rl_md: 400
    rl_yaml: 520
    total: 2013

governanca:
  contrato_ativo: CONTRATO-RF-PARA-RL
  ultimo_manifesto: "2025-12-30 - RF032 migrado v1.0 → v2.0 (separação RF/RL completa)"
