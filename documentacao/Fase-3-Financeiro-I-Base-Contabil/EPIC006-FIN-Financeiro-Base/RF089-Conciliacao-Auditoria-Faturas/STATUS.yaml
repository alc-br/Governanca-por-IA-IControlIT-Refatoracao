rf_id: RF089
rf_title: "Conciliação e Auditoria de Faturas"
rf_code: "FIN-089"
epic_code: "EPIC006-FIN-Financeiro-Base"
fase: "Fase 3 - Financeiro I - Base Contábil"

status:
  documentacao:
    documentacao: true
    user_stories: false
    uc: false
    md: false
    wf: false
    tc: false

  implementacao:
    backend:
      commands: false
      queries: false
      handlers: false
      controllers: false
      entities: false
      status: "Não iniciado"

    frontend:
      componentes: false
      telas: false
      rotas: false
      status: "Não iniciado"

    testes:
      unitarios: false
      integracao: false
      e2e: false
      status: "Não iniciado"

  integracao:
    feature_flags: false
    i18n: false
    auditoria: false
    rbac: false

  devops:
    migracao_db: false
    seeds: false
    azure_deployment: false
    status: "Não iniciado"

dados_gerais:
  data_criacao: 2025-12-28
  data_atualizacao: 2025-12-31
  responsavel: "Claude Code"
  versao: "2.0"
  prioridade: "Alta"
  complexidade: "Muito Alta"
  governanca: "v2.0"  # Separação RF/RL completa

dependencias:
  - RF032: "Gestão de Notas Fiscais (importação de NF-e)"
  - RF023: "Gestão de Contratos (validação de termos)"
  - RF012: "Gestão de Usuários (aprovação por role)"
  - RF001: "Parâmetros e Configurações (tolerâncias de matching)"

proximos_passos:
  - "Criar UC-089 (Casos de Uso)"
  - "Criar MD-089 (Modelo de Dados com DDL)"
  - "Criar WF-089 (Fluxos e Telas)"
  - "Criar user-stories.yaml com User Stories implementáveis"
  - "Criar TC-089-BACKEND.md (Testes de backend)"
  - "Criar TC-089-FRONTEND.md (Testes de frontend)"
  - "Criar TC-089-E2E.md (Testes de integração)"

observacoes: |
  RF089 especifica módulo completo de Conciliação e Auditoria de Faturas.

  **MIGRAÇÃO v2.0 CONCLUÍDA (2025-12-31):**
  - RF089.md v2.0: Contrato moderno limpo (665 linhas, SEM legado)
  - RF089.yaml: Estruturado e sincronizado 100% com RF.md
  - RL-RF089.md: Memória completa do legado (481 linhas, 7 seções)
  - RL-RF089.yaml: 23 itens legado rastreados (22 substituidos, 1 assumido)
  - Validação: Exit code 0 (5 avisos não bloqueadores)

  **RF v2.0 - Contrato Moderno:**
  - 10 regras de negócio em linguagem natural (sem código)
  - 11 seções obrigatórias completas
  - Zero referências ao legado (ASPX, VB.NET, SQL Server)
  - Integração com Azure ML para detecção de anomalias
  - Integração com Hangfire para processamento batch
  - Integração com SignalR para notificações em tempo real
  - Conformidade SPED Fiscal, NF-e, LGPD
  - Three-way matching (PC, RM, NF-e)
  - Auditoria com event sourcing e hash SHA-512
  - Bloqueio automático de pagamento em divergências críticas

  **RL v2.0 - Referência ao Legado:**
  - 4 telas ASPX documentadas com VB.NET code-behind
  - 1 WebService ASMX (6 métodos)
  - 4 Stored Procedures SQL Server
  - 4 Tabelas legadas com problemas identificados
  - 10 Regras de negócio implícitas extraídas do código
  - 3 Bancos legados consolidados (multi-tenancy)
  - 6 Problemas críticos do legado documentados
  - Gap Analysis completo (Legado × Moderno)

metricas:
  linhas_rf_v10: 1597  # RF v1.0 (legado misturado)
  linhas_rf_v20: 665   # RF v2.0 (contrato limpo)
  linhas_rl_md: 481    # RL-RF089.md (memória legado)
  linhas_rl_yaml: 697  # RL-RF089.yaml (estruturado)
  regras_negocio: 10
  endpoints_api: 13
  integraces: 5
  kpis: 5
  alertas: 4
  itens_legado_rastreados: 23
  itens_substituidos: 22
  itens_assumidos: 1
  validacao_gaps: 5  # Avisos não bloqueadores
  validacao_exit_code: 0  # Aprovado
