# Template de Referência ao Legado (RL-RF069.yaml)
# Versão: 2.0
# Data: 2025-12-30
# RF Moderno: RF-069 - Configuração de SLA para Chamados

rf_id: RF069
titulo: "Configuração de SLA para Chamados"

legado:
  sistema: "ASP.NET Web Forms + VB.NET + SQL Server"
  versao: ".NET Framework 4.5"
  arquitetura: "Monolítica WebForms"
  banco_dados: "SQL Server 2012 (multi-database por cliente)"
  multi_tenant: false
  auditoria: "partial" # Apenas log de erros, sem rastreamento de alterações

# ==============================================================================
# REFERÊNCIAS AO LEGADO COM DESTINO OBRIGATÓRIO
# ==============================================================================

referencias:
  # ----------------------------------------------------------------------------
  # TABELAS LEGADAS
  # ----------------------------------------------------------------------------
  - id: "LEG-RF069-001"
    tipo: "tabela"
    nome: "Solicitacao_SLA"
    caminho: "IControlIT_Cliente/dbo.Solicitacao_SLA"
    descricao: |
      Tabela principal de SLA do legado.
      Campos: Id_Solicitacao_SLA (int), Nm_Solicitacao_SLA (varchar50),
      Horas (int - apenas horas inteiras), Email_2_Nivel (varchar50 - único e-mail),
      Fl_Desativado (int - 0=ativo 1=inativo).

      Problemas: Sem diferenciação resposta vs resolução, sem calendários customizados,
      sem auditoria, sem multi-tenancy, apenas 1 e-mail de escalação, granularidade
      insuficiente (mínimo 1h).

    destino: "substituido"
    justificativa: |
      Tabela redesenhada completamente como SLA_Chamado com:
      - Separação Tempo_Resposta_Minutos e Tempo_Resolucao_Minutos
      - Suporte a calendários customizáveis (Id_Calendario FK)
      - Multi-tenancy nativo (Id_Fornecedor)
      - Auditoria completa (campos Created, Modified, etc)
      - Soft delete (Fl_Excluido)
      - Temporal Tables para versionamento imutável
      - Escalações em tabela separada (multi-nível)

    documentacao_item_relacionado: "RN-RF069-01, RN-RF069-03, RN-RF069-08, RN-RF069-11"
    uc_relacionado: "UC01, UC03"
    complexidade: "alta"
    risco_migracao: "alto"
    prioridade: 1

  - id: "LEG-RF069-002"
    tipo: "tabela"
    nome: "Contrato_SLA_Operacao"
    caminho: "IControlIT_Cliente/dbo.Contrato_SLA_Operacao"
    descricao: |
      Tabela de SLAs vinculados a contratos de fornecedores.
      Campos: Id_Contrato_SLA_Operacao, Id_Contrato, Descricao, Prazo_Dias,
      Vr_SLA_Operacao, Fl_Desativado.

      Uso: SLAs de operações (ex: "Troca de equipamento em 5 dias").

    destino: "descartado"
    justificativa: |
      Fora do escopo do RF-069 (SLA para Chamados).
      Migrado para RF-028 (SLA Operações) em escopo separado.
      RF-069 trata apenas SLAs de chamados/tickets de Service Desk.

    documentacao_item_relacionado: null
    uc_relacionado: null
    complexidade: "media"
    risco_migracao: "baixo"
    prioridade: 5

  # ----------------------------------------------------------------------------
  # STORED PROCEDURES LEGADAS
  # ----------------------------------------------------------------------------
  - id: "LEG-RF069-003"
    tipo: "stored_procedure"
    nome: "pa_CalcularSLA"
    caminho: "IControlIT_Cliente/Database/Procedures/pa_CalcularSLA.sql"
    descricao: |
      Stored procedure de 900+ linhas responsável por calcular se chamado
      está dentro do prazo de SLA.

      Lógica: Considera horário comercial hardcoded (seg-sex 8-18h), feriados
      nacionais da tabela Feriados, ignora fins de semana. Compara data atual
      com prazo limite e retorna flag 0=OK, 1=violado.

      Problemas: Extremamente complexa (900+ linhas T-SQL), performance ruim
      (>2s), horário comercial hardcoded (impossível customizar), sem pausas
      de SLA, sem diferenciação resposta vs resolução.

    destino: "substituido"
    justificativa: |
      Substituída por lógica C# na Application Layer (CQRS Handler) +
      Hangfire Background Job para monitoramento contínuo.

      Benefícios: Performance <200ms (vs >2s), calendários customizáveis,
      pausas automáticas, separação resposta/resolução, testável unitariamente.

    documentacao_item_relacionado: "RN-RF069-04, RN-RF069-06"
    uc_relacionado: null
    complexidade: "alta"
    risco_migracao: "alto"
    prioridade: 1

  - id: "LEG-RF069-004"
    tipo: "stored_procedure"
    nome: "pa_ObterSLAPorCliente"
    caminho: "IControlIT_Cliente/Database/Procedures/pa_ObterSLAPorCliente.sql"
    descricao: |
      Retorna SLA aplicável a cliente/tipo de chamado.

      Lógica: Busca em Solicitacao_SLA filtrado por Id_Cliente e Id_Tipo_Chamado.
      Se não encontrar, retorna SLA genérico (Id_Cliente NULL). Retorna primeiro
      resultado sem regras de prioridade.

      Problemas: Sem suporte a prioridades (Crítica/Alta/Média/Baixa), sem regra
      de precedência clara, não valida se SLA está ativo.

    destino: "substituido"
    justificativa: |
      Substituída por Query CQRS ObterSLAAplicavelQuery com regras de precedência
      claras: 1) SLA específico Cliente+Tipo+Prioridade, 2) SLA genérico
      Tipo+Prioridade, 3) SLA default Prioridade.

      Validações adicionais: SLA deve estar ativo (Fl_Ativo=true) e não excluído
      (Fl_Excluido=false).

    documentacao_item_relacionado: "RN-RF069-02, RN-RF069-10"
    uc_relacionado: null
    complexidade: "media"
    risco_migracao: "medio"
    prioridade: 2

  - id: "LEG-RF069-005"
    tipo: "stored_procedure"
    nome: "pa_RelatorioCompliance"
    caminho: "IControlIT_Cliente/Database/Procedures/pa_RelatorioCompliance.sql"
    descricao: |
      Gera relatório mensal de compliance SLA.

      Lógica: Recebe mês/ano, conta total de chamados resolvidos, conta chamados
      dentro do prazo (baseado em flag Fl_SLA_Violado), calcula percentual.

      Problemas: Extremamente lento (>2min para +10k chamados), sem cache
      (recalcula sempre), sem drill-down (resultado agregado apenas), sem
      exportação profissional.

    destino: "substituido"
    justificativa: |
      Substituída por Dashboard Angular com ApexCharts + SignalR (real-time) +
      cache Redis.

      Benefícios: Performance <500ms (vs >2min), atualização real-time, drill-down
      por prioridade/equipe/cliente, exportação PDF/Excel profissional, gráficos
      de tendência.

    documentacao_item_relacionado: null
    uc_relacionado: null
    complexidade: "alta"
    risco_migracao: "medio"
    prioridade: 2

  # ----------------------------------------------------------------------------
  # TELAS ASPX LEGADAS
  # ----------------------------------------------------------------------------
  - id: "LEG-RF069-006"
    tipo: "tela"
    nome: "ConfigurarSLA.aspx"
    caminho: "ic1_legado/IControlIT/Chamado/ConfigurarSLA.aspx"
    descricao: |
      Tela de cadastro e edição de SLAs.

      Campos: txtNomeSLA (TextBox, MaxLength=50), txtHoras (TextBox numérico,
      RangeValidator 1-999), txtEmail2Nivel (TextBox, RegularExpressionValidator),
      chkDesativado (CheckBox).

      Comportamentos implícitos: Validação client-side desabilitável, postback
      lento (~3s), sem pré-visualização de impacto, sobrescreve sem aviso, sem
      versionamento.

    destino: "substituido"
    justificativa: |
      Substituída por SPA Angular em /service-desk/sla/configurar.

      Benefícios: Reactive Forms com validação real-time, sem postback, simulador
      integrado de impacto, versionamento completo com histórico, UX moderna.

    documentacao_item_relacionado: "RN-RF069-01, RN-RF069-08"
    uc_relacionado: "UC01, UC03"
    complexidade: "alta"
    risco_migracao: "medio"
    prioridade: 1

  - id: "LEG-RF069-007"
    tipo: "tela"
    nome: "RelatorioSLA.aspx"
    caminho: "ic1_legado/IControlIT/Chamado/RelatorioSLA.aspx"
    descricao: |
      Relatório tabular de compliance SLA.

      Campos: ddlMes (DropDownList), ddlAno (DropDownList), gvRelatorio
      (GridView), btnExportar (Button - Excel via Response.Write).

      Comportamentos implícitos: Dados estáticos (não atualiza automaticamente),
      sem drill-down, exportação rudimentar (HTML puro), sem gráficos.

    destino: "substituido"
    justificativa: |
      Substituída por Dashboard Angular em /service-desk/sla/compliance.

      Benefícios: ApexCharts com gráficos de tendência, drill-down, exportação
      PDF/Excel profissional, atualização real-time via SignalR, filtros
      dinâmicos.

    documentacao_item_relacionado: null
    uc_relacionado: null
    complexidade: "media"
    risco_migracao: "baixo"
    prioridade: 3

  - id: "LEG-RF069-008"
    tipo: "tela"
    nome: "EscalacaoSLA.aspx"
    caminho: "ic1_legado/IControlIT/Chamado/EscalacaoSLA.aspx"
    descricao: |
      Configuração manual de e-mails de escalação.

      Campos: txtEmail2Nivel (TextBox - único e-mail), chkEnviarAlerta (CheckBox).

      Limitações críticas: Apenas 1 nível de escalação, apenas e-mail (sem SMS/
      push/webhook), sem percentuais configuráveis (alerta fixo 80%), sem
      mensagem customizável (template hardcoded).

    destino: "substituido"
    justificativa: |
      Substituída por workflow visual Angular em /service-desk/sla/escalacoes.

      Benefícios: Até 5 níveis de escalação, multi-canal (email/SMS/push/webhook),
      percentuais configuráveis (50%, 75%, 90%, 100%), mensagens customizáveis
      com variáveis dinâmicas.

    documentacao_item_relacionado: "RN-RF069-05"
    uc_relacionado: "UC08"
    complexidade: "alta"
    risco_migracao: "alto"
    prioridade: 1

  # ----------------------------------------------------------------------------
  # WEBSERVICES LEGADOS (ASMX SOAP)
  # ----------------------------------------------------------------------------
  - id: "LEG-RF069-009"
    tipo: "webservice"
    nome: "WSSuporte.asmx/ObterSLAPorChamado"
    caminho: "ic1_legado/IControlIT/WebService/WSSuporte.asmx.vb"
    descricao: |
      WebService SOAP que retorna SLA aplicável ao chamado.

      Lógica: Busca chamado, obtém Id_Cliente e Id_Tipo_Chamado, chama
      pa_ObterSLAPorCliente, retorna objeto SLADto.

      Problemas: SOAP (XML verboso), lento (>2s), autenticação Basic Auth fraca,
      sem cache, sem versionamento de API.

    destino: "substituido"
    justificativa: |
      Substituído por REST API em GET /api/sla/chamado/{idChamado}.

      Benefícios: JSON compacto (vs XML), autenticação JWT, cache Redis,
      performance <200ms (vs >2s), versionamento de API via headers.

    documentacao_item_relacionado: "RN-RF069-10"
    uc_relacionado: null
    complexidade: "media"
    risco_migracao: "baixo"
    prioridade: 2

  - id: "LEG-RF069-010"
    tipo: "webservice"
    nome: "WSSuporte.asmx/CalcularPrazoSLA"
    caminho: "ic1_legado/IControlIT/WebService/WSSuporte.asmx.vb"
    descricao: |
      WebService SOAP que calcula data/hora limite do SLA.

      Lógica: Busca Horas da tabela Solicitacao_SLA, chama pa_CalcularSLA,
      retorna data/hora calculada considerando horário comercial.

      Problemas: Lento (>2s via SOAP + SP), sem cache.

    destino: "substituido"
    justificativa: |
      Substituído por REST API em POST /api/sla/calcular-prazo.

      Benefícios: Lógica C# otimizada, cache Redis, performance <200ms,
      calendários customizáveis (vs hardcoded).

    documentacao_item_relacionado: "RN-RF069-06"
    uc_relacionado: null
    complexidade: "alta"
    risco_migracao: "alto"
    prioridade: 1

  - id: "LEG-RF069-011"
    tipo: "webservice"
    nome: "WSSuporte.asmx/ValidarViolacaoSLA"
    caminho: "ic1_legado/IControlIT/WebService/WSSuporte.asmx.vb"
    descricao: |
      WebService SOAP que verifica se chamado violou SLA.

      Lógica: Busca data abertura e prazo limite, compara DateTime.Now,
      retorna True=violado, False=OK.

      Problemas: Verificação on-demand (não proativa), sem notificação automática.

    destino: "substituido"
    justificativa: |
      Substituído por REST API GET /api/sla/chamado/{id}/status + Hangfire
      Background Job verificando continuamente.

      Benefícios: Verificação proativa a cada 1min, notificações automáticas,
      escalações disparadas automaticamente.

    documentacao_item_relacionado: "RN-RF069-05"
    uc_relacionado: null
    complexidade: "alta"
    risco_migracao: "medio"
    prioridade: 1

  # ----------------------------------------------------------------------------
  # REGRAS IMPLÍCITAS NÃO DOCUMENTADAS
  # ----------------------------------------------------------------------------
  - id: "LEG-RF069-012"
    tipo: "regra_negocio"
    nome: "Horário Comercial Hardcoded (seg-sex 8-18h)"
    caminho: "pa_CalcularSLA.sql - Linhas 45-120"
    descricao: |
      Horário útil fixo em seg-sex 8h-18h sem possibilidade de customização
      por cliente.

      Problema: Clientes com contrato 24x7 ou horário diferenciado (plantão
      7h-19h) não conseguem configurar.

    destino: "assumido"
    justificativa: |
      RF-069 implementa calendários customizáveis com horários e dias
      configuráveis por cliente/contrato.

      Cada SLA pode ter calendário específico (comercial, 24x7, plantão, etc).

    documentacao_item_relacionado: "RN-RF069-06"
    uc_relacionado: "UC06"
    complexidade: "alta"
    risco_migracao: "alto"
    prioridade: 1

  - id: "LEG-RF069-013"
    tipo: "regra_negocio"
    nome: "Feriados Apenas Nacionais"
    caminho: "Tabela Feriados + pa_CalcularSLA.sql - Linhas 200-250"
    descricao: |
      Sistema considera apenas feriados nacionais. Feriados estaduais,
      municipais e corporativos são ignorados.

      Problema: Empresas em SP (Aniversário da Cidade 25/jan) ou com ponte
      facultativa perdem compliance injustamente.

    destino: "assumido"
    justificativa: |
      RF-069 suporta feriados Nacional/Estadual/Municipal/Corporativo com
      importação automática via BrasilAPI + cadastro manual customizado.

      Flag Fl_Recorrente permite marcar feriados fixos (Natal, Ano Novo).

    documentacao_item_relacionado: "RN-RF069-07"
    uc_relacionado: "UC07"
    complexidade: "media"
    risco_migracao: "medio"
    prioridade: 2

  - id: "LEG-RF069-014"
    tipo: "regra_negocio"
    nome: "Escalação Fixa em 80% do Prazo"
    caminho: "WSSuporte.asmx.vb - Função EnviarAlertaSLA() - Linha 450"
    descricao: |
      E-mail de alerta disparado automaticamente quando chamado atinge 80%
      do prazo. Percentual hardcoded, não configurável.

      Problema: SLAs críticos precisam alerta mais cedo (ex: 50%), outros menos
      urgentes podem alertar em 90%.

    destino: "substituido"
    justificativa: |
      RF-069 permite até 5 níveis de escalação com percentuais configuráveis
      (ex: 50%, 75%, 90%, 100%).

      Cada nível pode ter destinatários e canais diferentes (email/SMS/push/
      webhook).

    documentacao_item_relacionado: "RN-RF069-05"
    uc_relacionado: "UC08"
    complexidade: "alta"
    risco_migracao: "medio"
    prioridade: 1

  - id: "LEG-RF069-015"
    tipo: "regra_negocio"
    nome: "Pausa de SLA Apenas Manual"
    caminho: "Sem lógica automática - SQL manual: UPDATE Chamados SET Dt_Pausa_SLA = GETDATE() WHERE Id_Chamado = X"
    descricao: |
      Quando chamado dependia de cliente (aguardando resposta), analista
      precisava pausar SLA manualmente via SQL.

      Problema: Dependia de disciplina do analista (frequentemente esquecido),
      causava violações injustas.

    destino: "assumido"
    justificativa: |
      RF-069 pausa SLA automaticamente quando chamado entra em status
      configurado como "Pausa SLA" (ex: "Aguardando Cliente", "Aguardando
      Fornecedor", "Pendente Aprovação").

      Retoma automaticamente ao sair do status de pausa, acumulando tempo
      total pausado. Auditoria registra início/fim de pausa.

    documentacao_item_relacionado: "RN-RF069-04"
    uc_relacionado: null
    complexidade: "media"
    risco_migracao: "baixo"
    prioridade: 2

  - id: "LEG-RF069-016"
    tipo: "regra_negocio"
    nome: "Sem Diferenciação Resposta vs Resolução"
    caminho: "Tabela Solicitacao_SLA - Campo Horas (único prazo)"
    descricao: |
      Sistema legado tinha apenas 1 prazo (resolução). Tempo de primeira
      resposta não era monitorado.

      Problema: Contratos ITIL v4 exigem 2 métricas separadas: tempo de
      resposta (primeira interação) e tempo de resolução (fechamento).

    destino: "assumido"
    justificativa: |
      RF-069 separa Tempo_Resposta_Minutos e Tempo_Resolucao_Minutos como
      campos distintos obrigatórios.

      Ambos são monitorados separadamente com alertas e relatórios específicos.

    documentacao_item_relacionado: "RN-RF069-01"
    uc_relacionado: "UC01, UC03"
    complexidade: "alta"
    risco_migracao: "alto"
    prioridade: 1

  - id: "LEG-RF069-017"
    tipo: "regra_negocio"
    nome: "SLA Aplicado Manualmente ao Criar Chamado"
    caminho: "CriarChamado.aspx.vb - Função btnSalvar_Click() - Linhas 200-220"
    descricao: |
      Ao criar chamado, analista escolhia SLA manualmente em dropdown.

      Problema: Escolha manual sujeita a erros (analista seleciona SLA errado,
      causando violação injusta ou compliance artificial).

    destino: "substituido"
    justificativa: |
      RF-069 aplica SLA automaticamente baseado em regras de precedência:
      1) SLA específico Cliente+Tipo+Prioridade
      2) SLA genérico Tipo+Prioridade
      3) SLA default Prioridade

      Eliminação total de escolha manual (automação 100%).

    documentacao_item_relacionado: "RN-RF069-10"
    uc_relacionado: null
    complexidade: "alta"
    risco_migracao: "medio"
    prioridade: 1

  - id: "LEG-RF069-018"
    tipo: "regra_negocio"
    nome: "Nenhum Versionamento de Alterações"
    caminho: "Sem auditoria de mudanças em SLA"
    descricao: |
      Quando gerente alterava prazo de SLA (ex: de 4h para 8h), registro
      anterior era sobrescrito sem histórico.

      Problema: Disputas contratuais sem rastreabilidade ("cliente afirma
      que SLA era 2h, mas foi alterado sem aviso").

    destino: "assumido"
    justificativa: |
      RF-069 implementa Temporal Tables SQL Server (versionamento imutável
      de todos os campos) + auditoria customizada com motivo obrigatório.

      Histórico completo acessível via query FOR SYSTEM_TIME ALL. Retenção
      7 anos (compliance LGPD).

    documentacao_item_relacionado: "RN-RF069-08"
    uc_relacionado: null
    complexidade: "media"
    risco_migracao: "baixo"
    prioridade: 2

# ==============================================================================
# BANCOS LEGADOS MAPEADOS
# ==============================================================================

bancos_legados:
  - nome: "IControlIT_Cliente01"
    servidor: "SQL-LEGADO-01"
    tabelas_relacionadas:
      - "Solicitacao_SLA"
      - "Feriados"
      - "Chamados"
    destino: "CONSOLIDADO"
    justificativa: "Migrado para banco único com multi-tenancy (Row-Level Security via Id_Fornecedor)"
    banco_moderno: "IControlIT.db (SQLite dev) / SQL Server moderno (prod)"

  - nome: "IControlIT_Cliente02"
    servidor: "SQL-LEGADO-02"
    tabelas_relacionadas:
      - "Solicitacao_SLA"
      - "Feriados"
      - "Chamados"
    destino: "CONSOLIDADO"
    justificativa: "Migrado para banco único com multi-tenancy (Row-Level Security via Id_Fornecedor)"
    banco_moderno: "IControlIT.db (SQLite dev) / SQL Server moderno (prod)"

# ==============================================================================
# PROBLEMAS LEGADO IDENTIFICADOS
# ==============================================================================

problemas_legado:
  - id: "PROB-RF069-001"
    titulo: "Lógica de Negócio Dispersa"
    severidade: "CRÍTICA"
    descricao: |
      Regras de negócio espalhadas entre ASPX code-behind (VB.NET), stored
      procedures SQL Server (900+ linhas), e helpers VB.NET.

      Dificulta manutenção, testes unitários e rastreabilidade de mudanças.
    impacto: "Tempo de correção de bugs 3-5x maior, impossibilidade de testes automatizados"
    solucao_moderna: "Clean Architecture com regras de negócio centralizadas na Application Layer (CQRS Handlers + FluentValidation)"

  - id: "PROB-RF069-002"
    titulo: "Ausência de Versionamento de SLA"
    severidade: "ALTA"
    descricao: |
      Alterações em SLA sobrescrevem dados sem histórico.

      Impossibilita auditoria LGPD, rastreabilidade contratual e resolução de
      disputas com clientes.
    impacto: "Risco jurídico em disputas contratuais, não conformidade LGPD Art. 16"
    solucao_moderna: "Temporal Tables SQL Server (versionamento imutável) + auditoria customizada com motivo obrigatório"

  - id: "PROB-RF069-003"
    titulo: "Performance Ruim em Cálculos de SLA"
    severidade: "ALTA"
    descricao: |
      Stored procedure pa_CalcularSLA com 900+ linhas T-SQL executa em >2
      segundos por chamado. Relatórios de compliance demoram >2 minutos.
    impacto: "UX ruim, timeout em relatórios grandes, impossibilidade de dashboards real-time"
    solucao_moderna: "Lógica C# otimizada + Hangfire Background Jobs + cache Redis (<200ms response time)"

  - id: "PROB-RF069-004"
    titulo: "Escalação Limitada (1 Nível, Apenas E-mail)"
    severidade: "ALTA"
    descricao: |
      Apenas 1 nível de escalação (Email_2_Nivel) sem suporte a SMS, push,
      webhook. Alerta fixo em 80% do prazo (hardcoded).
    impacto: "SLAs críticos sem notificação adequada, violações sem ação preventiva"
    solucao_moderna: "Até 5 níveis de escalação com percentuais configuráveis, multi-canal (email/SMS/push/webhook)"

  - id: "PROB-RF069-005"
    titulo: "Calendários Não Customizáveis"
    severidade: "MÉDIA"
    descricao: |
      Horário comercial seg-sex 8-18h hardcoded no código. Impossível customizar
      por cliente (24x7, plantão, horário diferenciado).
    impacto: "Cálculo incorreto de SLA para clientes com atendimento 24x7 ou horário diferenciado"
    solucao_moderna: "Calendários customizáveis por SLA (comercial, 24x7, plantão) com horários e dias configuráveis"

  - id: "PROB-RF069-006"
    titulo: "Feriados Desatualizados"
    severidade: "MÉDIA"
    descricao: |
      Tabela de feriados atualizada manualmente 1x/ano. Apenas feriados nacionais.
      Feriados estaduais, municipais e corporativos ignorados.
    impacto: "Cálculo incorreto de SLA em feriados regionais, violações injustas"
    solucao_moderna: "Importação automática via BrasilAPI + suporte a feriados Nacional/Estadual/Municipal/Corporativo + recorrentes"

  - id: "PROB-RF069-007"
    titulo: "Multi-Database (Banco Separado por Cliente)"
    severidade: "CRÍTICA"
    descricao: |
      Cada cliente em banco SQL Server separado (IControlIT_Cliente01, _Cliente02,
      etc). Impossibilita consolidação de métricas, relatórios multi-cliente,
      análises estratégicas.
    impacto: "Impossibilidade de dashboards consolidados, custo operacional alto, backup complexo"
    solucao_moderna: "Banco único com multi-tenancy nativo (Id_Fornecedor + Row-Level Security)"

  - id: "PROB-RF069-008"
    titulo: "Sem Auditoria LGPD"
    severidade: "CRÍTICA"
    descricao: |
      Não registra who/when/what para alterações de SLA. Impossibilita
      rastreabilidade de mudanças e compliance LGPD Art. 16.
    impacto: "Não conformidade LGPD, multas até 2% do faturamento, risco jurídico"
    solucao_moderna: "Auditoria completa com AuditInterceptor + Temporal Tables (retenção 7 anos)"

  - id: "PROB-RF069-009"
    titulo: "SOAP Obsoleto com Autenticação Fraca"
    severidade: "ALTA"
    descricao: |
      WebServices ASMX SOAP com autenticação Basic Auth (usuário/senha em
      base64 sem criptografia). Sem suporte a webhooks, versionamento de API.
    impacto: "Risco de segurança, impossibilidade de integração moderna, performance ruim"
    solucao_moderna: "REST API com OAuth2 + JWT, webhooks para notificações proativas, versionamento de API via headers"

  - id: "PROB-RF069-010"
    titulo: "Pausas de SLA Manuais"
    severidade: "MÉDIA"
    descricao: |
      Pausas de SLA gerenciadas manualmente via SQL UPDATE. Dependia de disciplina
      do analista (frequentemente esquecido).
    impacto: "Violações injustas de SLA quando chamado aguardava cliente/fornecedor"
    solucao_moderna: "Pausas automáticas por status do chamado (Fl_Pausa_SLA=true) com auditoria completa"

# ==============================================================================
# METADADOS DE RASTREABILIDADE
# ==============================================================================

metadados:
  total_itens_legado: 18
  itens_assumidos: 7
  itens_substituidos: 10
  itens_descartados: 1
  itens_a_revisar: 0
  cobertura_destinos: "100%"

# ==============================================================================
# CHANGELOG
# ==============================================================================

changelog:
  - versao: "2.0"
    data: "2025-12-30"
    descricao: "Referência completa ao legado com 100% dos itens com campo destino preenchido (ASSUMIDO/SUBSTITUÍDO/DESCARTADO)"
    autor: "Agência ALC - alc.dev.br"
