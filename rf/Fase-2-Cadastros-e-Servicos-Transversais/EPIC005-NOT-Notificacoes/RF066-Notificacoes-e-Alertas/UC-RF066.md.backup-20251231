# Casos de Uso - RF066

**Vers√£o:** 1.0
**Data:** 2025-12-17
**RF Relacionado:** [RF066 - Notificacoes-e-Alertas](./RF066.md)

---

## √çndice de Casos de Uso

| UC | Nome | Descri√ß√£o |
|----|------|-----------|
| UC01 | Configurar Alertas | Caso de uso |
| UC01 | UC01 - Criar Notifica√ß√£o Program√°tica | Caso de uso |
| UC04 | UC04 - Gerenciar Templates de Notifica√ß√£o | Caso de uso |
| UC07 | UC07 - Agendar Notifica√ß√£o Futura | Caso de uso |

---

# UC01: Configurar Alertas

**Modelo de Dados**: [MD-003](../MD-003-Logs-Monitoramento-Observabilidade.md)

---

## üìã Informa√ß√µes B√°sicas

| Atributo | Valor |
|----------|-------|
| **Ator Principal** | Administrador DevOps, Super Administrador |
| **Objetivo** | Criar, editar e configurar alertas proativos baseados em logs e m√©tricas |
| **Pr√©-condi√ß√µes** | Usu√°rio autenticado com permiss√£o `SYS.ALERTS.UPDATE` |
| **P√≥s-condi√ß√µes** | Alerta configurado e ativo; notifica√ß√µes ser√£o disparadas quando condi√ß√£o for atingida |
| **Complexidade** | Alta |

---

## üéØ Fluxo Principal

1. Usu√°rio acessa menu "Sistema ‚Üí Logs e Monitoramento ‚Üí Alertas"
2. Sistema verifica permiss√£o `SYS.ALERTS.UPDATE`
3. Sistema exibe lista de alertas configurados:
   - Nome do alerta
   - Tipo (ErrorRate, ResponseTime, ExceptionType, etc.)
   - Condi√ß√£o (ex: "Error Rate > 5%")
   - Status (Ativo/Inativo)
   - √öltima vez disparado
   - A√ß√µes: Editar, Desabilitar, Hist√≥rico
4. Usu√°rio clica em "Novo Alerta"
5. Sistema exibe formul√°rio:
   - **Identifica√ß√£o**:
     - C√≥digo (auto-gerado ou manual)
     - Nome
     - Descri√ß√£o
   - **Tipo de Alerta**: (dropdown)
     - Taxa de Erros (Error Rate)
     - Tempo de Resposta (Response Time)
     - Tipo de Exce√ß√£o Espec√≠fica
     - M√©trica Customizada
     - Health Check Falho
     - Uso de Recursos (CPU/Mem√≥ria)
   - **Condi√ß√£o de Disparo**:
     - M√©trica: (ex: error_rate, response_time_p95)
     - Operador: Maior que / Menor que / Igual a / Entre
     - Valor: (input num√©rico)
     - Unidade: %, ms, count, GB
   - **Janela de Tempo**:
     - Avaliar nos √∫ltimos: 5, 10, 15, 30 minutos
     - Verificar a cada: 30, 60, 120 segundos
   - **Filtros Adicionais** (opcional):
     - N√≠vel de log: Error, Fatal, Warning
     - Tipo de exce√ß√£o: NullReferenceException, SqlException, etc.
     - Endpoint: /api/usuarios/*, /api/faturas/*
     - Empresa espec√≠fica
   - **Canais de Notifica√ß√£o** (m√∫ltiplos):
     - ‚òë E-mail ‚Üí [Lista de emails]
     - ‚òë Slack ‚Üí [Webhook URL] [Canal]
     - ‚òê Teams ‚Üí [Webhook URL]
     - ‚òê PagerDuty ‚Üí [Integration Key] [Severidade]
     - ‚òê SMS ‚Üí [Lista de telefones]
   - **Configura√ß√µes Avan√ßadas**:
     - Cooldown: N√£o disparar novamente nos pr√≥ximos X minutos
     - M√°ximo de disparos por hora: X
     - Ambientes: DEV, HOM, PROD (checkboxes)
     - Prioridade: Baixa / M√©dia / Alta / Cr√≠tica
6. Usu√°rio preenche formul√°rio e clica em "Salvar"
7. Sistema valida:
   - Nome √∫nico
   - Valor de threshold v√°lido
   - Ao menos um canal de notifica√ß√£o configurado
   - Webhook URLs v√°lidas (teste de conectividade)
8. Sistema salva alerta em `Sistema_Log_Configuracao_Alerta`
9. Sistema registra em auditoria
10. Sistema ativa monitoramento (background job verifica a cada X segundos)
11. Sistema exibe mensagem de sucesso

---

(restante do arquivo omitido por brevidade - veja arquivo original)