# RF-090-Gestao-Categorias-Ativos

**Versao**: 2.0
**Ultima Atualizacao**: 2025-11-03
**Status**: âœ… Estrutura Simplificada (5 secoes)
**Fase**: Fase 1 - Fundacao e Cadastros Base

---

[â† Voltar ao Indice](./README.md)

---

## RESUMO EXECUTIVO

### Descrição Geral

Este requisito especifica o **Sistema de Gestão de Categorias** do IControlIT, responsável por classificar e organizar ativos, serviços de telecom, tipos de chamados, e demais entidades do sistema através de uma estrutura hierárquica e customizável de categorias.

### Conceitos Fundamentais

**Categoria**: Classificação hierárquica de entidades (ativos, serviços, chamados)
- Hierarquia multinível (Categoria Pai → Subcategoria → Subcategoria Filha)
- Categorias customizáveis por empresa/conglomerado
- Atributos dinâmicos por categoria (campos customizados)

**Hierarquia de Categorias**:


### Funcionalidades Principais

1. ✅ **Hierarquia Ilimitada**: Categorias com N níveis de profundidade
2. ✅ **Categorias por Tipo**: Ativos, Serviços, Chamados, Contratos
3. ✅ **Atributos Customizados**: Campos específicos por categoria
4. ✅ **Importação em Massa**: CSV/Excel para carga inicial
5. ✅ **Validação de Hierarquia**: Impedir loops e inconsistências
6. ✅ **Controle de Depreciação**: Taxa de depreciação por categoria de ativo
7. ✅ **Templates de Categoria**: Reutilizar estruturas comuns
8. ✅ **Ícones e Cores**: Personalização visual
9. ✅ **Migração de Categorias**: Mover ativos entre categorias
10. ✅ **Análise de Uso**: Relatório de categorias mais utilizadas

---

---

---

## REGRAS DE NEGOCIO

**RN-CAD-012-01**: Hierarquia máxima de 10 níveis
[Implementacao: ver documentacao tecnica]

**RN-CAD-012-02**: Validação de loops na hierarquia
- Categoria não pode ser filha de si mesma
- Categoria não pode ser movida para dentro de seus próprios descendentes
- Sistema deve validar antes de salvar

**RN-CAD-012-03**: Taxa de depreciação válida
- Deve estar entre 0% e 100%
- Aplicável apenas para categorias do tipo "Ativo"
- Se não informada, usa valor padrão de 20% ao ano

**RN-CAD-012-04**: Atributos obrigatórios devem ser preenchidos
- Ao criar ativo de categoria X, validar que todos atributos obrigatórios foram informados
- Exibir mensagem clara indicando qual atributo está faltando

**RN-CAD-012-05**: Valores únicos devem ser únicos
- Atributos marcados como `Fl_Unico = 1` não podem ter valores duplicados
- Exemplo: Número de série deve ser único em toda categoria

**RN-CAD-012-06**: Tipos de dados validados
[Implementacao: ver documentacao tecnica]

**RN-CAD-012-07**: Categorias de sistema não podem ser excluídas
- Categorias com `Fl_Sistema = 1` são protegidas
- Criadas automaticamente pelo sistema (ex: "Não Categorizado")

**RN-CAD-012-08**: Inativação em cascata opcional
- Ao inativar categoria pai, perguntar se deseja inativar filhas
- Se manter filhas ativas, promover ao nível da categoria pai inativada

**RN-CAD-012-09**: Atributos herdados
- Subcategorias herdam atributos da categoria pai
- Podem adicionar novos atributos específicos
- Não podem remover atributos herdados

**RN-CAD-012-10**: Templates públicos compartilhados
- Templates marcados como `Fl_Publico = 1` são visíveis para todos conglomerados
- Facilita reutilização de estruturas comuns (ex: Categoria de Notebooks)

---

---

---

## REFERENCIAS AO LEGADO

| Legado | Moderno |
|--------|---------|
| `WSCategorias.CadastrarCategoria()` | `POST /api/categorias` |
| `Categorias.aspx` | `/categorias` (Angular) |

---

---

---

## BANCO DE DADOS LEGADO

[Ver banco de dados legado para detalhes do schema]

---

---

---

## WEBSERVICES LEGADO (VB.NET)

**Arquivo**: `D:\IC2\ic1_legado\WebService\WSCategorias.asmx.vb`



---

---

[â† Voltar ao Indice](./README.md)

---

[â† Voltar ao Indice](./README.md)## RF-CAD-011 (Locais/Endereços)

## TELAS DO LEGADO

### Nota
Não foram encontradas telas específicas de cadastro de locais/endereços no legado. O endereço é gerenciado como parte de outras entidades (Empresa, Filial, Consumidor, Fornecedor).

**Modernização Recomendada**:
- ✅ Criar componente reutilizável de endereço (Angular component)
- ✅ Integração com ViaCEP, Google Maps
- ✅ Validação de CEP, coordenadas GPS
- ✅ Histórico de mudanças de endereço
- ✅ Geolocalização automática

---

## RF-090 (Categorias de Ativos)

## TELAS DO LEGADO

### Nota
Categorias de ativos são gerenciadas através de "Grupo" e "Sub Grupo" na tela Ativo_Tipo.aspx (ver RF-CAD-013).

---

## RF-CAD-013 (Tipos de Ativos)

## TELAS DO LEGADO

### Tela: Ativo_Tipo.aspx
**Localização**: `D:\IC2\ic1_legado\IControlIT\IControlIT\Cadastro\Ativo_Tipo.aspx`

**Campos da Tela**:
1. **Descrição** (txtDescricao) - TextBox obrigatório, MaxLength=50
2. **Grupo** (cboGrupoAtivoTipo) - DropDownList obrigatório
3. **Imagem** (txtImagem) - TextBox obrigatório, MaxLength=50
4. **Photo** (txtPhoto) - TextBox obrigatório, MaxLength=50
5. **Estoque Regulador** (txtEstoqueRegulador) - TextBox numérico, MaxLength=5
6. **Tipo Grupo** (cboTipoGrupo) - DropDownList
7. **Sub Grupo** (cboSubGrupo) - DropDownList
8. **Fornecedor** (cboConglomerado) - DropDownList

#### O Que Modernizar
1. **UI/UX**: Angular + PrimeNG, upload de imagens drag-and-drop
2. **Campos**: Adicionar Código, Categoria, Subcategoria, Vida Útil (meses)
3. **Imagens**: Upload de múltiplas imagens, preview, crop/resize
4. **Atributos Customizados**: Grid dinâmico de atributos (ex: RAM, HD, Processador para computadores)
5. **Depreciação**: Configurar taxa de depreciação mensal
6. **Fornecedores**: Multi-select de fornecedores homologados
7. **Estoque**: Alertas visuais quando estoque < regulador
8. **Performance**: Cache de tipos (Redis - 1 hora)

---

## RF-CAD-013 (Marcas/Modelos)

## TELAS DO LEGADO

### Tela: Ativo_Modelo.aspx
**Localização**: `D:\IC2\ic1_legado\IControlIT\IControlIT\Cadastro\Ativo_Modelo.aspx`

**Campos da Tela**:
1. **Descrição** (txtDescricao) - TextBox obrigatório, MaxLength=50
2. **Tipo do ativo** (cboAtivoTipo) - DropDownList obrigatório
3. **Fabricante** (cboAtivoFabricante) - DropDownList obrigatório

#### O Que Modernizar
1. **UI/UX**: Angular + PrimeNG, autocomplete de modelos existentes
2. **Campos**: Adicionar Código do Modelo, Ano Lançamento, Descontinuado (Sim/Não)
3. **Especificações Técnicas**: Grid dinâmico (Atributo, Valor, Unidade)
4. **Imagens**: Upload de múltiplas fotos do modelo
5. **Preço Referência**: Valor de mercado (atualizado mensalmente)
6. **Fornecedores**: Lista de fornecedores que comercializam este modelo
7. **Ativos Existentes**: Grid de ativos cadastrados com este modelo
8. **Comparação**: Comparar especificações de modelos similares
9. **Performance**: Cache de fabricantes (Redis - 2 horas)

---

## RF-AUD-002, RF-CFG-001, RF-REF-048, RF-SIS-001, RF-SIS-002 (RFs de Sistema)

## TELAS DO LEGADO

### Nota
RFs de Sistema (Auditoria, Configurações, i18n, Logs, Monitoramento) geralmente não possuem telas de cadastro tradicionais no legado. São funcionalidades transversais implementadas via:
- Web.config (configurações)
- Logs em arquivos .txt
- Consultas SQL diretas ao banco

**Modernização Recomendada**:

### RF-AUD-002 (Auditoria/Logs):
- ✅ Tela de consulta de logs com filtros avançados (usuário, ação, período, entidade)
- ✅ Visualização de diff (antes/depois) das alterações
- ✅ Exportar logs para Excel/CSV
- ✅ Dashboard de auditoria (ações mais comuns, usuários mais ativos)
- ✅ Elasticsearch para busca full-text em logs
- ✅ Retenção configurável (ex: 90 dias online, 7 anos em cold storage)

### RF-CFG-001 (Parâmetros do Sistema):
- ✅ Tela de configurações agrupadas por categoria
- ✅ Tipos: String, Number, Boolean, JSON, Encrypted
- ✅ Validação de valores (regex, min/max, enum)
- ✅ Histórico de alterações de parâmetros
- ✅ Importar/exportar configurações (JSON)
- ✅ Cache de configurações (Redis - invalidar ao alterar)

### RF-REF-048 (Internacionalização):
- ✅ Tela de gestão de idiomas suportados
- ✅ Editor de traduções (grid: Chave, PT-BR, EN-US, ES-ES)
- ✅ Importar/exportar traduções (JSON, XLSX)
- ✅ Detecção de chaves faltantes (missing translations)
- ✅ Tradução automática via Google Translate API
- ✅ Pluralização e formatação de moeda/data por locale

### RF-SIS-001 (Configurações):
- ✅ Interface web para appsettings.json
- ✅ Validação de JSON antes de salvar
- ✅ Backup automático antes de alterar
- ✅ Ambiente-specific (dev, staging, prod)
- ✅ Azure Key Vault para secrets

### RF-SIS-002 (Logs/Monitoramento):
- ✅ Dashboard em tempo real (SignalR)
- ✅ Métricas: Requests/s, Erros/min, Tempo médio de resposta
- ✅ Gráficos de linha (últimas 24h, 7 dias, 30 dias)
- ✅ Alertas configuráveis (erro rate > 5%, response time > 3s)
- ✅ Integração com Application Insights, Grafana
- ✅ Health checks de dependências (DB, Redis, APIs externas)
