# ==============================================================================
# RF060 - Gestão de Tipos de Chamado (YAML Estruturado)
# ==============================================================================

rf_id: RF060
rf_title: "Gestão de Tipos de Chamado"
rf_codigo: "GES.TIPOS_CHAMADO"

versao_governanca: "2.0"
data_criacao: "2025-01-14"
data_migracao: "2025-12-30"
autor: "Equipe IControlIT"
status: "Aprovado"

# ==============================================================================
# METADADOS
# ==============================================================================

metadados:
  fase: "Fase-2-Cadastros-e-Servicos-Transversais"
  epic: "EPIC003-CAD-Cadastros-Base"
  modulo: "Service Desk"
  complexidade: "MUITO_ALTA"
  prioridade_negocio: "CRÍTICA"
  total_regras_negocio: 15
  total_funcionalidades: 15
  total_endpoints: 20
  total_permissoes: 10
  total_eventos_auditoria: 9
  linhas_documentacao_md: 862

# ==============================================================================
# VISÃO GERAL
# ==============================================================================

visao_geral:
  objetivo: |
    Implementar sistema especializado para gerenciar tipos de chamados técnicos de Service Desk
    com classificação ITIL v4 (Incidente, Requisição de Serviço, Mudança, Problema), permitindo
    configuração de SLA por tipo/prioridade, formulários dinâmicos personalizados, templates de
    resolução reutilizáveis, escalonamento automático e métricas ITIL.

  contexto_negocio: |
    O Service Desk precisa padronizar o atendimento com base em ITIL v4, onde cada tipo de chamado
    possui características, SLAs, formulários e processos específicos. A gestão de tipos de chamado
    permite padronização, SLA diferenciado, knowledge base, escalonamento inteligente e métricas ITIL.

  beneficios_esperados:
    - reducao_tempo_classificacao: "60%"
    - aumento_sla_compliance: "70% → 95%"
    - reducao_mttr: "40%"
    - aumento_fcr: "45% → 70%"
    - dashboards_gerenciais: true

  escopo:
    incluido:
      - "CRUD de tipos de chamado"
      - "Configuração de SLA por tipo e prioridade"
      - "Formulários dinâmicos com campos customizados"
      - "Templates de resolução (knowledge base)"
      - "Regras de escalonamento por tipo"
      - "Cálculo automático de prioridade (matriz impacto × urgência)"
      - "Aprovação CAB para mudanças"
      - "Vinculação incidente → problema"
      - "Categorização hierárquica (3 níveis)"
      - "Atribuição de especialistas preferenciais"
      - "Métricas ITIL (MTTR, MTBF, FCR)"
      - "Integração com CMDB"
      - "Janelas de mudança configuráveis"
      - "Cálculo de custos por tipo"
      - "Relatórios gerenciais"

    excluido:
      - "Abertura de chamados (RF separado)"
      - "Atendimento de chamados (RF separado)"
      - "Gestão de filas (RF separado)"
      - "Chat/WhatsApp/E-mail (RF separado)"

  stakeholders:
    - papel: "Gestores de TI"
      responsabilidade: "Configuração de tipos e SLAs"
    - papel: "Analistas de Service Desk"
      responsabilidade: "Utilização de templates e escalonamento"
    - papel: "Change Advisory Board (CAB)"
      responsabilidade: "Aprovação de mudanças"
    - papel: "Especialistas"
      responsabilidade: "Resolução de chamados específicos"
    - papel: "Auditoria"
      responsabilidade: "Compliance ITIL e rastreabilidade"

# ==============================================================================
# FUNCIONALIDADES
# ==============================================================================

funcionalidades:
  - id: "F01"
    nome: "CRUD de Tipos de Chamado"
    descricao: "Sistema permite criar, visualizar, editar e excluir tipos de chamado"
    campos:
      - "Código único (ex: INC-001, REQ-002)"
      - "Nome descritivo"
      - "Categoria ITIL v4"
      - "Categorização hierárquica"
      - "Status ativo/inativo"
      - "Multi-tenancy (EmpresaId)"

  - id: "F02"
    nome: "Configuração de SLA por Tipo"
    descricao: "Configurar SLA específico por prioridade"
    campos:
      - "Tempo de resposta"
      - "Tempo de resolução"
      - "Horário de atendimento"
      - "Calendário de feriados"
      - "Cálculo automático de deadline"

  - id: "F03"
    nome: "Formulários Dinâmicos"
    descricao: "Criar formulários customizados por tipo"
    tipos_campo:
      - "TEXT"
      - "NUMBER"
      - "SELECT"
      - "DATE"
      - "TEXTAREA"
      - "CHECKBOX"
      - "MULTI-SELECT"

  - id: "F04"
    nome: "Templates de Resolução"
    descricao: "Knowledge base integrado"
    campos:
      - "Título da solução"
      - "Descrição do problema"
      - "Passos para resolução"
      - "Anexos"
      - "Quantidade de usos"
      - "Taxa de sucesso"
      - "Avaliação (1-5 estrelas)"

  - id: "F05"
    nome: "Escalonamento Automático"
    descricao: "Regras de escalonamento por tipo"
    niveis:
      - "N1: Suporte Básico"
      - "N2: Suporte Avançado"
      - "N3: Especialistas"

  - id: "F06"
    nome: "Cálculo de Prioridade"
    descricao: "Matriz ITIL 3×3 (impacto × urgência)"
    matriz:
      - "Alto × Alta = Crítica"
      - "Alto × Média = Alta"
      - "Médio × Alta = Alta"
      - "Médio × Média = Média"
      - "Baixo × Baixa = Baixa"

  - id: "F07"
    nome: "Aprovação CAB"
    descricao: "Workflow de aprovação para mudanças"
    requisitos:
      - "Obrigatório para tipos 'Mudança'"
      - "Membros CAB configuráveis"
      - "Quorum mínimo (ex: 3 de 5)"
      - "Prazo de aprovação (ex: 48h)"

  - id: "F08"
    nome: "Vinculação Incidente → Problema"
    descricao: "Vincular múltiplos incidentes a um problema raiz"
    regras:
      - "Um problema pode ter N incidentes"
      - "Um incidente vinculado a apenas 1 problema"
      - "Resolver problema fecha incidentes vinculados"

  - id: "F09"
    nome: "Categorização Hierárquica"
    descricao: "Árvore de categorias com 3 níveis"
    exemplo:
      - "Hardware → Desktop → Teclado"
      - "Software → Servidor → Virtual"

  - id: "F10"
    nome: "Especialistas Preferenciais"
    descricao: "Atribuir especialistas por tipo"
    campos:
      - "Técnico preferencial"
      - "Backup"
      - "Horários de disponibilidade"
      - "Taxa de resolução"

  - id: "F11"
    nome: "Métricas ITIL"
    descricao: "Dashboards com indicadores por tipo"
    metricas:
      - "MTTR (Mean Time to Resolve)"
      - "MTBF (Mean Time Between Failures)"
      - "FCR (First Call Resolution)"
      - "Backlog"
      - "SLA Compliance"
      - "Trending"

  - id: "F12"
    nome: "Integração CMDB"
    descricao: "Vincular chamados a Configuration Items"
    recursos:
      - "Selecionar CI afetado"
      - "Histórico de chamados do CI"
      - "Impacto calculado por criticidade do CI"
      - "Notificação de mudanças em CIs críticos"

  - id: "F13"
    nome: "Janelas de Mudança"
    descricao: "Janelas permitidas para mudanças"
    campos:
      - "Dia da semana"
      - "Horário"
      - "Frequência (semanal, mensal)"
      - "Aprovação emergencial"

  - id: "F14"
    nome: "Custos por Tipo"
    descricao: "Calcular custo médio de atendimento"
    componentes:
      - "Custo técnico (horas × valor/hora)"
      - "Custo de ferramentas"
      - "Custo de terceiros"
      - "Budget vs. Real"

  - id: "F15"
    nome: "Relatórios Gerenciais"
    descricao: "Dashboards executivos"
    tipos:
      - "Volume por tipo (gráfico pizza)"
      - "SLA Compliance (gráfico barras)"
      - "Top 10 tipos mais frequentes"
      - "Trending mensal/anual"
      - "Exportação Excel/PDF"

# ==============================================================================
# REGRAS DE NEGÓCIO
# ==============================================================================

regras_negocio:
  - id: "RN-RF060-001"
    titulo: "Classificação ITIL v4 Obrigatória"
    descricao: |
      Todos os tipos de chamado DEVEM ser classificados em uma das 4 categorias ITIL v4:
      Incidente, Requisição de Serviço, Mudança ou Problema.
    criticidade: "CRÍTICA"
    implementacao:
      backend: true
      frontend: true
    validacao:
      tipo: "enum"
      mensagem_erro: "Categoria ITIL inválida. Selecione uma das 4 opções."
      http_code: 400

  - id: "RN-RF060-002"
    titulo: "SLA Diferenciado por Tipo e Prioridade"
    descricao: |
      Cada tipo de chamado DEVE ter SLA específico configurado por prioridade (Crítica, Alta, Média, Baixa),
      com tempo de resposta e resolução distintos.
    criticidade: "CRÍTICA"
    implementacao:
      backend: true
      frontend: true
    validacao:
      tipo: "business_rule"
      mensagem_erro: "SLA não configurado para este tipo/prioridade."
      http_code: 400

  - id: "RN-RF060-003"
    titulo: "Formulários Dinâmicos Configuráveis"
    descricao: |
      Cada tipo de chamado PODE ter formulário customizado com campos obrigatórios e opcionais,
      sendo que formulários dinâmicos DEVEM ser validados antes de abrir o chamado.
    criticidade: "IMPORTANTE"
    implementacao:
      backend: true
      frontend: true
    validacao:
      tipo: "dynamic_form"
      mensagem_erro: "Preencha todos os campos obrigatórios do formulário."
      http_code: 400

  - id: "RN-RF060-004"
    titulo: "Templates de Resolução com Knowledge Base"
    descricao: |
      Sistema DEVE permitir cadastro de templates de resolução reutilizáveis,
      com controle de quantidade de usos e taxa de sucesso.
    criticidade: "IMPORTANTE"
    implementacao:
      backend: true
      frontend: true
    validacao:
      tipo: "business_rule"
      mensagem_erro: "Template inválido ou inativo."
      http_code: 400

  - id: "RN-RF060-005"
    titulo: "Escalonamento Automático por Tempo"
    descricao: |
      Sistema DEVE escalonar automaticamente chamados para nível superior
      se não forem atendidos dentro do tempo configurado.
    criticidade: "CRÍTICA"
    implementacao:
      backend: true
      frontend: false
      job_hangfire: true
    validacao:
      tipo: "job"
      mensagem_erro: "Erro ao escalonar chamado."
      http_code: 500

  - id: "RN-RF060-006"
    titulo: "Matriz de Prioridade Automática"
    descricao: |
      Sistema DEVE calcular prioridade automaticamente usando matriz ITIL 3×3 (impacto × urgência).
    criticidade: "CRÍTICA"
    implementacao:
      backend: true
      frontend: true
    validacao:
      tipo: "calculation"
      mensagem_erro: "Impacto e Urgência devem ser selecionados."
      http_code: 400

  - id: "RN-RF060-007"
    titulo: "Aprovação CAB para Mudanças"
    descricao: |
      Tipos classificados como "Mudança" DEVEM obrigatoriamente passar por aprovação
      do Change Advisory Board (CAB) antes de execução.
    criticidade: "CRÍTICA"
    implementacao:
      backend: true
      frontend: true
    validacao:
      tipo: "workflow"
      mensagem_erro: "Mudança requer aprovação CAB."
      http_code: 403

  - id: "RN-RF060-008"
    titulo: "Vinculação de Incidentes a Problemas"
    descricao: |
      Sistema DEVE permitir vincular múltiplos incidentes a um problema raiz,
      e ao resolver o problema, todos os incidentes vinculados DEVEM ser automaticamente fechados.
    criticidade: "IMPORTANTE"
    implementacao:
      backend: true
      frontend: true
    validacao:
      tipo: "business_rule"
      mensagem_erro: "Incidente já vinculado a outro problema."
      http_code: 400

  - id: "RN-RF060-009"
    titulo: "Categorização Hierárquica de 3 Níveis"
    descricao: |
      Sistema DEVE permitir categorização hierárquica com até 3 níveis
      (Categoria → Subcategoria → Item).
    criticidade: "MÉDIA"
    implementacao:
      backend: true
      frontend: true
    validacao:
      tipo: "hierarchy"
      mensagem_erro: "Hierarquia inválida (máximo 3 níveis)."
      http_code: 400

  - id: "RN-RF060-010"
    titulo: "Especialistas Preferenciais por Tipo"
    descricao: |
      Cada tipo de chamado PODE ter técnicos especialistas preferenciais configurados,
      que recebem prioridade na atribuição de chamados.
    criticidade: "MÉDIA"
    implementacao:
      backend: true
      frontend: true
    validacao:
      tipo: "business_rule"
      mensagem_erro: "Especialista não disponível ou sem permissão."
      http_code: 400

  - id: "RN-RF060-011"
    titulo: "Métricas ITIL Obrigatórias"
    descricao: |
      Sistema DEVE calcular automaticamente métricas ITIL por tipo de chamado:
      MTTR, MTBF, First Call Resolution.
    criticidade: "IMPORTANTE"
    implementacao:
      backend: true
      frontend: true
    validacao:
      tipo: "calculation"
      mensagem_erro: null
      http_code: null

  - id: "RN-RF060-012"
    titulo: "Integração com CMDB Obrigatória"
    descricao: |
      Chamados DEVEM poder ser vinculados a Configuration Items (CIs) do CMDB,
      e o impacto DEVE ser calculado automaticamente com base na criticidade do CI.
    criticidade: "IMPORTANTE"
    implementacao:
      backend: true
      frontend: true
    validacao:
      tipo: "business_rule"
      mensagem_erro: "CI inválido ou inativo."
      http_code: 400

  - id: "RN-RF060-013"
    titulo: "Janelas de Mudança Configuráveis"
    descricao: |
      Tipos "Mudança" DEVEM ter janelas de execução configuradas,
      e mudanças NÃO PODEM ser executadas fora da janela sem aprovação emergencial.
    criticidade: "IMPORTANTE"
    implementacao:
      backend: true
      frontend: true
    validacao:
      tipo: "business_rule"
      mensagem_erro: "Mudança fora da janela permitida. Requer aprovação emergencial."
      http_code: 403

  - id: "RN-RF060-014"
    titulo: "Cálculo de Custos por Tipo"
    descricao: |
      Sistema DEVE calcular custo médio de atendimento por tipo de chamado,
      considerando horas técnicas, ferramentas e terceiros.
    criticidade: "MÉDIA"
    implementacao:
      backend: true
      frontend: true
    validacao:
      tipo: "calculation"
      mensagem_erro: null
      http_code: null

  - id: "RN-RF060-015"
    titulo: "Relatórios Gerenciais Obrigatórios"
    descricao: |
      Sistema DEVE gerar relatórios gerenciais com volume de chamados por tipo,
      SLA compliance e trending.
    criticidade: "IMPORTANTE"
    implementacao:
      backend: true
      frontend: true
    validacao:
      tipo: "report"
      mensagem_erro: null
      http_code: null

# ==============================================================================
# IMPACTO E DEPENDÊNCIAS
# ==============================================================================

impacto_dependencias:
  impacto_modulos:
    - rf: "RF061"
      nome: "Abertura de Chamados"
      impacto: "Utiliza tipos de chamado e formulários dinâmicos"
    - rf: "RF062"
      nome: "Atendimento de Chamados"
      impacto: "Utiliza templates de resolução e escalonamento"
    - rf: "RF063"
      nome: "Gestão de Filas"
      impacto: "Utiliza priorização automática"
    - rf: "RF064"
      nome: "Dashboards Service Desk"
      impacto: "Consome métricas ITIL"
    - rf: "RF065"
      nome: "CMDB"
      impacto: "Integração com Configuration Items"

  dependencias_tecnicas:
    backend:
      - ".NET 10"
      - "Entity Framework Core"
      - "MediatR"
      - "FluentValidation"
    frontend:
      - "Angular 19"
      - "Angular Material"
      - "Transloco"
    jobs:
      - "Hangfire (escalonamento automático)"
      - "Hangfire (notificações SLA)"
    notificacoes:
      - "SignalR (tempo real)"
    storage:
      - "Azure Blob Storage (anexos de templates)"

  requisitos_infraestrutura:
    - "Job Hangfire a cada 5 minutos (escalonamento)"
    - "Job Hangfire a cada 15 minutos (notificação SLA)"
    - "SignalR hub configurado"
    - "Redis para cache de SLAs"

# ==============================================================================
# CENTRAL DE FUNCIONALIDADES
# ==============================================================================

central_funcionalidades:
  codigo: "GES.TIPOS_CHAMADO"
  nome: "Gestão de Tipos de Chamado"
  descricao: |
    Gerenciamento de tipos de chamados técnicos com classificação ITIL v4,
    SLA configurável, formulários dinâmicos, templates de resolução e escalonamento automático.
  modulo: "Service Desk"

# ==============================================================================
# PERMISSÕES RBAC
# ==============================================================================

permissoes_rbac:
  - permission_code: "GES.TIPOS_CHAMADO.VIEW"
    descricao: "Visualizar tipos de chamado"
    roles_autorizadas:
      - "Analista Service Desk"
      - "Gestor TI"
      - "Administrador"

  - permission_code: "GES.TIPOS_CHAMADO.CREATE"
    descricao: "Criar tipos de chamado"
    roles_autorizadas:
      - "Gestor TI"
      - "Administrador"

  - permission_code: "GES.TIPOS_CHAMADO.EDIT"
    descricao: "Editar tipos de chamado"
    roles_autorizadas:
      - "Gestor TI"
      - "Administrador"

  - permission_code: "GES.TIPOS_CHAMADO.DELETE"
    descricao: "Excluir tipos de chamado"
    roles_autorizadas:
      - "Administrador"

  - permission_code: "GES.TIPOS_CHAMADO.MANAGE_SLA"
    descricao: "Gerenciar SLAs de tipos"
    roles_autorizadas:
      - "Gestor TI"
      - "Administrador"

  - permission_code: "GES.TIPOS_CHAMADO.MANAGE_FORMS"
    descricao: "Gerenciar formulários dinâmicos"
    roles_autorizadas:
      - "Gestor TI"
      - "Administrador"

  - permission_code: "GES.TIPOS_CHAMADO.MANAGE_TEMPLATES"
    descricao: "Gerenciar templates de resolução"
    roles_autorizadas:
      - "Analista Service Desk"
      - "Gestor TI"
      - "Administrador"

  - permission_code: "GES.TIPOS_CHAMADO.MANAGE_ESCALATION"
    descricao: "Gerenciar regras de escalonamento"
    roles_autorizadas:
      - "Gestor TI"
      - "Administrador"

  - permission_code: "GES.TIPOS_CHAMADO.CREATE_CHANGE"
    descricao: "Criar tipos de mudança"
    roles_autorizadas:
      - "Gestor TI"
      - "Change Manager"
      - "Administrador"

  - permission_code: "GES.TIPOS_CHAMADO.APPROVE_CAB"
    descricao: "Aprovar mudanças no CAB"
    roles_autorizadas:
      - "Change Manager"
      - "Gestor TI"
      - "Administrador"

# ==============================================================================
# EVENTOS DE AUDITORIA
# ==============================================================================

eventos_auditoria:
  - codigo: "TIPO_CHAMADO_CRIADO"
    descricao: "Tipo de chamado criado"
    campos_registrados:
      - "Id"
      - "Codigo"
      - "Nome"
      - "Categoria ITIL"

  - codigo: "TIPO_CHAMADO_ATUALIZADO"
    descricao: "Tipo de chamado atualizado"
    campos_registrados:
      - "Id"
      - "Campos alterados"

  - codigo: "TIPO_CHAMADO_EXCLUIDO"
    descricao: "Tipo de chamado excluído"
    campos_registrados:
      - "Id"
      - "Nome"

  - codigo: "SLA_CONFIGURADO"
    descricao: "SLA configurado para tipo/prioridade"
    campos_registrados:
      - "TipoChamadoId"
      - "Prioridade"
      - "TempoResposta"
      - "TempoResolucao"

  - codigo: "FORMULARIO_CRIADO"
    descricao: "Formulário dinâmico criado"
    campos_registrados:
      - "TipoChamadoId"
      - "Quantidade de campos"

  - codigo: "TEMPLATE_APLICADO"
    descricao: "Template de resolução aplicado"
    campos_registrados:
      - "TemplateId"
      - "ChamadoId"
      - "TaxaSucesso"

  - codigo: "CHAMADO_ESCALONADO"
    descricao: "Chamado escalonado automaticamente"
    campos_registrados:
      - "ChamadoId"
      - "NivelOrigem"
      - "NivelDestino"
      - "Motivo"

  - codigo: "MUDANCA_APROVADA_CAB"
    descricao: "Mudança aprovada pelo CAB"
    campos_registrados:
      - "MudancaId"
      - "Quorum"
      - "Membros que aprovaram"

  - codigo: "MUDANCA_REJEITADA_CAB"
    descricao: "Mudança rejeitada pelo CAB"
    campos_registrados:
      - "MudancaId"
      - "Motivo"

# ==============================================================================
# ENDPOINTS API
# ==============================================================================

endpoints:
  - method: "GET"
    route: "/api/tipos-chamado"
    descricao: "Listar tipos de chamado com paginação"
    autenticacao: true
    authorization_policy: "TiposChamadoView"
    parametros:
      - "page"
      - "pageSize"
      - "search"
    response_code: 200

  - method: "GET"
    route: "/api/tipos-chamado/{id}"
    descricao: "Obter detalhes de tipo de chamado"
    autenticacao: true
    authorization_policy: "TiposChamadoView"
    response_code: 200

  - method: "POST"
    route: "/api/tipos-chamado"
    descricao: "Criar tipo de chamado"
    autenticacao: true
    authorization_policy: "TiposChamadoCreate"
    response_code: 201

  - method: "PUT"
    route: "/api/tipos-chamado/{id}"
    descricao: "Atualizar tipo de chamado"
    autenticacao: true
    authorization_policy: "TiposChamadoEdit"
    response_code: 204

  - method: "DELETE"
    route: "/api/tipos-chamado/{id}"
    descricao: "Excluir tipo de chamado"
    autenticacao: true
    authorization_policy: "TiposChamadoDelete"
    response_code: 204

  - method: "GET"
    route: "/api/tipos-chamado/{id}/slas"
    descricao: "Listar SLAs de tipo de chamado"
    autenticacao: true
    authorization_policy: "TiposChamadoView"
    response_code: 200

  - method: "POST"
    route: "/api/tipos-chamado/{id}/slas"
    descricao: "Configurar SLA para tipo/prioridade"
    autenticacao: true
    authorization_policy: "TiposChamadoManageSLA"
    response_code: 201

  - method: "GET"
    route: "/api/tipos-chamado/{id}/formulario"
    descricao: "Obter formulário dinâmico do tipo"
    autenticacao: true
    authorization_policy: "TiposChamadoView"
    response_code: 200

  - method: "POST"
    route: "/api/tipos-chamado/{id}/formulario"
    descricao: "Configurar formulário dinâmico"
    autenticacao: true
    authorization_policy: "TiposChamadoManageForms"
    response_code: 201

  - method: "GET"
    route: "/api/tipos-chamado/{id}/templates"
    descricao: "Listar templates de resolução"
    autenticacao: true
    authorization_policy: "TiposChamadoView"
    response_code: 200

  - method: "POST"
    route: "/api/tipos-chamado/{id}/templates"
    descricao: "Criar template de resolução"
    autenticacao: true
    authorization_policy: "TiposChamadoManageTemplates"
    response_code: 201

  - method: "GET"
    route: "/api/tipos-chamado/{id}/escalonamento"
    descricao: "Listar regras de escalonamento"
    autenticacao: true
    authorization_policy: "TiposChamadoView"
    response_code: 200

  - method: "POST"
    route: "/api/tipos-chamado/{id}/escalonamento"
    descricao: "Configurar escalonamento"
    autenticacao: true
    authorization_policy: "TiposChamadoManageEscalation"
    response_code: 201

  - method: "POST"
    route: "/api/tipos-chamado/calcular-prioridade"
    descricao: "Calcular prioridade com base em impacto × urgência"
    autenticacao: true
    authorization_policy: "TiposChamadoView"
    parametros:
      - "impacto"
      - "urgencia"
    response_code: 200

  - method: "GET"
    route: "/api/tipos-chamado/{id}/metricas"
    descricao: "Obter métricas ITIL do tipo"
    autenticacao: true
    authorization_policy: "TiposChamadoView"
    response_code: 200

  - method: "GET"
    route: "/api/tipos-chamado/{id}/custos"
    descricao: "Obter custos do tipo"
    autenticacao: true
    authorization_policy: "TiposChamadoView"
    response_code: 200

  - method: "GET"
    route: "/api/tipos-chamado/relatorios/volume"
    descricao: "Relatório de volume por tipo"
    autenticacao: true
    authorization_policy: "TiposChamadoView"
    response_code: 200

  - method: "GET"
    route: "/api/tipos-chamado/relatorios/sla-compliance"
    descricao: "Relatório de SLA compliance"
    autenticacao: true
    authorization_policy: "TiposChamadoView"
    response_code: 200

  - method: "GET"
    route: "/api/tipos-chamado/categorias/hierarquia"
    descricao: "Obter hierarquia de categorias"
    autenticacao: true
    authorization_policy: "TiposChamadoView"
    response_code: 200

  - method: "POST"
    route: "/api/tipos-chamado/mudancas/{id}/aprovar-cab"
    descricao: "Aprovar mudança no CAB"
    autenticacao: true
    authorization_policy: "TiposChamadoApproveCAB"
    response_code: 200

# ==============================================================================
# REQUISITOS NÃO FUNCIONAIS
# ==============================================================================

requisitos_nao_funcionais:
  performance:
    - "Classificação automática de prioridade em < 500ms"
    - "Cálculo de deadline SLA em < 200ms"
    - "Renderização de formulários dinâmicos em < 1s"
    - "Busca de templates com até 10.000 registros em < 2s"
    - "Dashboard de métricas ITIL carrega em < 3s"

  usabilidade:
    - "Wizard intuitivo para criação de tipos"
    - "Autocomplete na categorização hierárquica"
    - "Preview de templates ao selecionar"
    - "Drag-and-drop para ordenar campos"
    - "Notificações em tempo real (SignalR)"

  compliance:
    - "Aderência total a ITIL v4"
    - "Auditoria de todas as mudanças"
    - "Rastreabilidade de escalonamentos"
    - "Histórico de aprovações CAB"
    - "Logs de cálculos de SLA"

  seguranca:
    - "Multi-tenancy obrigatório (EmpresaId)"
    - "Permissões RBAC granulares"
    - "Validação de formulários dinâmicos"
    - "Sanitização de HTML em descrições"
    - "Rate limiting (100 req/min)"

  disponibilidade:
    - "Jobs Hangfire resilientes (retry automático)"
    - "Cache Redis para SLAs (fallback banco)"
    - "SignalR com reconnect automático"
    - "Backup de templates no Azure Blob Storage"

# ==============================================================================
# GLOSSÁRIO
# ==============================================================================

glossario:
  - termo: "ITIL"
    definicao: "Information Technology Infrastructure Library (framework de boas práticas)"
  - termo: "SLA"
    definicao: "Service Level Agreement (acordo de nível de serviço)"
  - termo: "CAB"
    definicao: "Change Advisory Board (comitê de aprovação de mudanças)"
  - termo: "MTTR"
    definicao: "Mean Time to Resolve (tempo médio de resolução)"
  - termo: "MTBF"
    definicao: "Mean Time Between Failures (tempo médio entre falhas)"
  - termo: "FCR"
    definicao: "First Call Resolution (resolução no primeiro contato)"
  - termo: "CMDB"
    definicao: "Configuration Management Database (banco de dados de configuração)"
  - termo: "CI"
    definicao: "Configuration Item (item de configuração)"
  - termo: "N1/N2/N3"
    definicao: "Níveis de suporte (básico, avançado, especialista)"

# ==============================================================================
# RISCOS E MITIGAÇÕES
# ==============================================================================

riscos:
  tecnicos:
    - risco: "Formulários dinâmicos com performance ruim"
      impacto: "Alto"
      probabilidade: "Média"
      mitigacao: "Cache de schemas, lazy loading de campos"

    - risco: "Jobs Hangfire com falhas"
      impacto: "Alto"
      probabilidade: "Baixa"
      mitigacao: "Retry policy, logging detalhado, alertas"

    - risco: "Cálculo de SLA incorreto"
      impacto: "Crítico"
      probabilidade: "Baixa"
      mitigacao: "Testes extensivos, validação de fórmulas, casos de borda"

    - risco: "Escalação não acontecendo"
      impacto: "Alto"
      probabilidade: "Média"
      mitigacao: "Monitoramento de jobs, alertas se job não executar"

  negocio:
    - risco: "Usuários não seguindo ITIL"
      impacto: "Alto"
      probabilidade: "Alta"
      mitigacao: "Treinamento, wizard intuitivo, validações obrigatórias"

    - risco: "CAB demorando para aprovar"
      impacto: "Médio"
      probabilidade: "Média"
      mitigacao: "Prazo máximo configurável, notificações escaladas"

    - risco: "Templates desatualizados"
      impacto: "Médio"
      probabilidade: "Alta"
      mitigacao: "Revisão trimestral, taxa de sucesso baixa gera alerta"

# ==============================================================================
# HISTÓRICO DE REVISÕES
# ==============================================================================

historico_revisoes:
  - versao: "1.0"
    data: "2025-01-14"
    autor: "Equipe IControlIT"
    descricao: "Versão inicial aprovada"

  - versao: "2.0"
    data: "2025-12-30"
    autor: "Claude Code"
    descricao: "Migração v1.0 → v2.0 (Governança - Separação RF/RL)"
