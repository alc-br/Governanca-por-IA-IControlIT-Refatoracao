# RF060 - Gestão de Tipos de Chamado

**Versão:** 2.0
**Data de Criação:** 2025-01-14
**Última Atualização:** 2025-12-30
**Autor:** Equipe IControlIT
**Status:** Aprovado
**Governança:** v2.0 (Separação RF/RL)

---

## 1. VISÃO GERAL

### 1.1 Objetivo do Requisito

Implementar sistema especializado para gerenciar tipos de chamados técnicos de Service Desk com classificação ITIL v4 (Incidente, Requisição de Serviço, Mudança, Problema), permitindo configuração de SLA por tipo/prioridade, formulários dinâmicos personalizados, templates de resolução reutilizáveis, escalonamento automático e métricas ITIL.

### 1.2 Contexto de Negócio

O Service Desk precisa padronizar o atendimento com base em ITIL v4, onde cada tipo de chamado possui características, SLAs, formulários e processos específicos. A gestão de tipos de chamado permite:

- **Padronização**: Classificação consistente baseada em ITIL v4
- **SLA Diferenciado**: Tempos de resposta e resolução específicos por tipo e prioridade
- **Knowledge Base**: Templates de resolução para problemas recorrentes
- **Escalonamento Inteligente**: Regras de escalonamento configuráveis por tipo
- **Métricas ITIL**: MTTR, MTBF, First Call Resolution por categoria

### 1.3 Benefícios Esperados

- Redução de tempo de classificação de chamados em 60%
- Aumento de compliance com SLA de 70% para 95%
- Redução de MTTR (Mean Time to Resolve) em 40% com templates
- Aumento de First Call Resolution de 45% para 70%
- Dashboards gerenciais com trending por tipo de chamado

### 1.4 Escopo

**Incluído:**
- CRUD de tipos de chamado
- Configuração de SLA por tipo e prioridade
- Formulários dinâmicos com campos customizados
- Templates de resolução (knowledge base)
- Regras de escalonamento por tipo
- Cálculo automático de prioridade (matriz impacto × urgência)
- Aprovação CAB para mudanças
- Vinculação incidente → problema
- Categorização hierárquica (Categoria → Subcategoria → Item)
- Atribuição de especialistas preferenciais
- Métricas ITIL (MTTR, MTBF, FCR)
- Integração com CMDB (Configuration Management Database)
- Janelas de mudança configuráveis
- Cálculo de custos por tipo
- Relatórios gerenciais

**Excluído:**
- Abertura de chamados (RF separado)
- Atendimento de chamados (RF separado)
- Gestão de filas (RF separado)
- Chat/WhatsApp/E-mail (RF separado)

### 1.5 Stakeholders

- **Gestores de TI**: Configuração de tipos e SLAs
- **Analistas de Service Desk**: Utilização de templates e escalonamento
- **Change Advisory Board (CAB)**: Aprovação de mudanças
- **Especialistas**: Resolução de chamados específicos
- **Auditoria**: Compliance ITIL e rastreabilidade

---

## 2. FUNCIONALIDADES

### F01 - CRUD de Tipos de Chamado

Sistema permite criar, visualizar, editar e excluir tipos de chamado com:
- Código único (ex: INC-001, REQ-002, CHG-003, PRB-004)
- Nome descritivo (ex: "Incidente de Rede", "Requisição de Software")
- Categoria ITIL v4 (Incidente, Requisição de Serviço, Mudança, Problema)
- Categorização hierárquica (ex: Hardware → Desktop → Teclado)
- Status ativo/inativo
- Multi-tenancy (isolamento por EmpresaId)

### F02 - Configuração de SLA por Tipo

Para cada tipo de chamado, configurar SLA específico por prioridade:
- Tempo de resposta (ex: Crítico = 30 min, Normal = 2h)
- Tempo de resolução (ex: Crítico = 4h, Normal = 24h)
- Horário de atendimento (ex: 24x7, comercial, customizado)
- Calendário de feriados
- Cálculo automático de deadline com base em prioridade

### F03 - Formulários Dinâmicos

Criar formulários customizados por tipo de chamado:
- Campos obrigatórios/opcionais
- Tipos de campo: TEXT, NUMBER, SELECT, DATE, TEXTAREA, CHECKBOX, MULTI-SELECT
- Validações personalizadas (regex, range, tamanho)
- Opções de seleção configuráveis
- Condicionais (campo aparece se outro = X)
- Ordem de exibição dos campos

### F04 - Templates de Resolução

Knowledge base integrado com:
- Título da solução
- Descrição do problema
- Passos para resolução (step-by-step)
- Anexos (screenshots, documentos)
- Quantidade de usos
- Taxa de sucesso (% de chamados resolvidos com o template)
- Avaliação por técnicos (1-5 estrelas)
- Busca por palavras-chave

### F05 - Escalonamento Automático

Configurar regras de escalonamento por tipo:
- Nível 1, 2, 3 (N1 → N2 → N3)
- Grupo de atendimento por nível
- Tempo de escalonamento (ex: se não atendido em 2h → escalar para N2)
- Notificações automáticas por e-mail/SignalR
- Bypass manual para casos urgentes

### F06 - Cálculo de Prioridade

Matriz ITIL 3×3 (impacto × urgência):
- Impacto: Alto, Médio, Baixo
- Urgência: Alta, Média, Baixa
- Prioridade resultante: Crítica, Alta, Média, Baixa
- Cálculo automático ao criar chamado
- Possibilidade de override manual com justificativa

### F07 - Aprovação CAB

Tipos "Mudança" possuem workflow de aprovação:
- Obrigatório passar por Change Advisory Board (CAB)
- Membros CAB configuráveis por tipo
- Quorum mínimo (ex: 3 de 5 membros)
- Prazo de aprovação (ex: 48h)
- Notificações de pendência
- Histórico de aprovações/rejeições

### F08 - Vinculação Incidente → Problema

Permitir vincular múltiplos incidentes a um problema raiz:
- Um problema pode ter N incidentes associados
- Resolver problema fecha todos os incidentes vinculados
- Dashboard de problemas recorrentes
- Análise de causa raiz

### F09 - Categorização Hierárquica

Árvore de categorias com até 3 níveis:
- Categoria (ex: Hardware, Software, Rede)
- Subcategoria (ex: Desktop, Servidor, Storage)
- Item (ex: Teclado, Mouse, Monitor)
- Pesquisa por autocomplete
- Estatísticas por categoria

### F10 - Especialistas Preferenciais

Atribuir especialistas por tipo:
- Técnico preferencial (primeiro da fila)
- Backup (se preferencial indisponível)
- Horários de disponibilidade
- Taxa de resolução do especialista
- Histórico de atendimentos

### F11 - Métricas ITIL

Dashboards com indicadores por tipo:
- **MTTR** (Mean Time to Resolve): Tempo médio de resolução
- **MTBF** (Mean Time Between Failures): Tempo médio entre falhas
- **FCR** (First Call Resolution): Resolução no primeiro contato (%)
- **Backlog**: Quantidade de chamados em aberto
- **SLA Compliance**: % de chamados dentro do SLA
- **Trending**: Evolução temporal por tipo

### F12 - Integração CMDB

Vincular chamados a Configuration Items (CIs):
- Selecionar CI afetado (servidor, rede, aplicação)
- Histórico de chamados do CI
- Impacto calculado com base no CI (ex: servidor crítico = impacto alto)
- Notificação de mudanças em CIs críticos

### F13 - Janelas de Mudança

Definir janelas permitidas para mudanças:
- Dia da semana (ex: sábado 02:00-06:00)
- Frequência (semanal, mensal)
- Bloqueio fora da janela
- Aprovação emergencial (com justificativa)
- Calendário visual de janelas

### F14 - Custos por Tipo

Calcular custo médio de atendimento:
- Custo técnico (horas × valor/hora)
- Custo de ferramentas
- Custo de terceiros
- Total por tipo de chamado
- Trending de custos
- Budget vs. Real

### F15 - Relatórios Gerenciais

Dashboards executivos:
- Volume de chamados por tipo (gráfico pizza)
- SLA Compliance por tipo (gráfico barras)
- Top 10 tipos mais frequentes
- Trending mensal/anual
- Exportação Excel/PDF
- Agendamento de envio por e-mail

---

## 3. REGRAS DE NEGÓCIO

### RN-RF060-001: Classificação ITIL v4 Obrigatória

**Descrição:** Todos os tipos de chamado DEVEM ser classificados em uma das 4 categorias ITIL v4: Incidente, Requisição de Serviço, Mudança ou Problema.

**Critério de Aceite:**
- Sistema possui enum `CategoriaITIL` com 4 valores
- Campo `Categoria` é obrigatório no cadastro
- Dropdown apresenta apenas as 4 opções ITIL
- Não é possível criar tipo sem categoria

**Validações:**
- Categoria DEVE ser uma das 4 opções ITIL
- NÃO é permitido categoria customizada fora de ITIL
- Campo Categoria NÃO pode ser nulo ou vazio

**Prioridade:** CRÍTICA

---

### RN-RF060-002: SLA Diferenciado por Tipo e Prioridade

**Descrição:** Cada tipo de chamado DEVE ter SLA específico configurado por prioridade (Crítica, Alta, Média, Baixa), com tempo de resposta e resolução distintos.

**Critério de Aceite:**
- Tabela `SLATipoChamado` vincula tipo × prioridade × tempos
- Sistema calcula deadline automaticamente ao criar chamado
- Considera horário de atendimento e feriados
- Notifica antes de vencer SLA (ex: 80% do tempo)

**Validações:**
- Tempo de resposta DEVE ser menor que tempo de resolução
- Tempos DEVEM ser maiores que zero
- Prioridades Crítica e Alta DEVEM ter SLA mais curto que Média e Baixa
- NÃO é possível criar chamado sem SLA configurado para seu tipo/prioridade

**Exemplo:**
```
Tipo: Incidente de Rede
Prioridade Crítica: Resposta 30 min, Resolução 4h
Prioridade Alta: Resposta 1h, Resolução 8h
Prioridade Média: Resposta 2h, Resolução 24h
Prioridade Baixa: Resposta 4h, Resolução 72h
```

**Prioridade:** CRÍTICA

---

### RN-RF060-003: Formulários Dinâmicos Configuráveis

**Descrição:** Cada tipo de chamado PODE ter formulário customizado com campos obrigatórios e opcionais, sendo que formulários dinâmicos DEVEM ser validados antes de abrir o chamado.

**Critério de Aceite:**
- Campos customizados são criados por tipo de chamado
- Tipos de campo: TEXT, NUMBER, SELECT, DATE, TEXTAREA, CHECKBOX, MULTI-SELECT
- Campos obrigatórios bloqueiam criação de chamado se não preenchidos
- Frontend renderiza formulário dinamicamente com base em JSON

**Validações:**
- Campos obrigatórios NÃO podem ser vazios
- Campos NUMBER DEVEM aceitar apenas números
- Campos DATE DEVEM aceitar apenas datas válidas
- Campos SELECT DEVEM ter ao menos 2 opções

**Exemplo:**
```json
{
  "campos": [
    {
      "nome": "NumeroPatrimonio",
      "tipo": "TEXT",
      "obrigatorio": true,
      "tamanho_max": 20
    },
    {
      "nome": "LocalizacaoEquipamento",
      "tipo": "SELECT",
      "obrigatorio": true,
      "opcoes": ["Andar 1", "Andar 2", "Data Center"]
    }
  ]
}
```

**Prioridade:** IMPORTANTE

---

### RN-RF060-004: Templates de Resolução com Knowledge Base

**Descrição:** Sistema DEVE permitir cadastro de templates de resolução reutilizáveis, com controle de quantidade de usos e taxa de sucesso.

**Critério de Aceite:**
- Templates vinculados a tipos de chamado
- Contador de usos incrementa ao aplicar template
- Taxa de sucesso calculada com base em avaliação do técnico
- Busca por palavras-chave no título/descrição
- Ranking de templates mais efetivos (maior taxa de sucesso)

**Validações:**
- Template DEVE ter título e descrição
- Template DEVE ter ao menos 1 passo de resolução
- Taxa de sucesso DEVE estar entre 0-100%
- Template NÃO pode ser excluído se tiver usos (apenas inativado)

**Prioridade:** IMPORTANTE

---

### RN-RF060-005: Escalonamento Automático por Tempo

**Descrição:** Sistema DEVE escalonar automaticamente chamados para nível superior se não forem atendidos dentro do tempo configurado.

**Critério de Aceite:**
- Hangfire job verifica chamados a cada 5 minutos
- Se tempo de escalonamento excedido → transfere para grupo N+1
- Notifica técnico atual e novo grupo via e-mail + SignalR
- Registra evento de escalonamento na auditoria
- Permite bypass manual (escalação imediata)

**Validações:**
- Tempo de escalonamento DEVE ser maior que zero
- Tempo de escalonamento DEVE ser menor que SLA de resolução
- DEVE existir grupo de atendimento configurado para o nível
- Escalação NÃO ocorre se chamado já estiver em atendimento

**Exemplo:**
```
N1: Suporte Básico (tempo: 2h)
N2: Suporte Avançado (tempo: 4h)
N3: Especialistas (sem tempo - última instância)
```

**Prioridade:** CRÍTICA

---

### RN-RF060-006: Matriz de Prioridade Automática

**Descrição:** Sistema DEVE calcular prioridade automaticamente usando matriz ITIL 3×3 (impacto × urgência).

**Critério de Aceite:**
- Usuário seleciona Impacto (Alto, Médio, Baixo)
- Usuário seleciona Urgência (Alta, Média, Baixa)
- Sistema calcula Prioridade conforme tabela:
  - Alto × Alta = Crítica
  - Alto × Média = Alta
  - Médio × Alta = Alta
  - Médio × Média = Média
  - Baixo × Baixa = Baixa
- Permite override manual com justificativa obrigatória

**Validações:**
- Impacto e Urgência DEVEM ser selecionados
- Prioridade DEVE ser calculada antes de salvar
- Override DEVE ter justificativa (mínimo 20 caracteres)
- Override é registrado em auditoria

**Prioridade:** CRÍTICA

---

### RN-RF060-007: Aprovação CAB para Mudanças

**Descrição:** Tipos classificados como "Mudança" DEVEM obrigatoriamente passar por aprovação do Change Advisory Board (CAB) antes de execução.

**Critério de Aceite:**
- Ao criar mudança, status inicial = "Aguardando Aprovação CAB"
- Notifica membros CAB via e-mail
- Quorum mínimo configurável (ex: 3 de 5 aprovações)
- Prazo de aprovação configurável (ex: 48h)
- Se rejeitado, mudança é cancelada com motivo
- Se aprovado, mudança pode ser agendada

**Validações:**
- Mudança NÃO pode ser executada sem aprovação CAB
- Mudança emergencial PODE pular CAB com aprovação gerencial + auditoria
- Todos os votos CAB DEVEM ter justificativa
- Após prazo, mudança é automaticamente rejeitada

**Prioridade:** CRÍTICA

---

### RN-RF060-008: Vinculação de Incidentes a Problemas

**Descrição:** Sistema DEVE permitir vincular múltiplos incidentes a um problema raiz, e ao resolver o problema, todos os incidentes vinculados DEVEM ser automaticamente fechados.

**Critério de Aceite:**
- Um problema pode ter N incidentes associados
- Um incidente pode estar vinculado a apenas 1 problema
- Dashboard mostra problemas com mais incidentes vinculados (recorrentes)
- Resolver problema fecha incidentes com solução copiada
- Notifica usuários dos incidentes vinculados

**Validações:**
- Problema DEVE existir antes de vincular incidentes
- Incidente NÃO pode estar vinculado a 2 problemas simultaneamente
- Problema NÃO pode ser excluído se tiver incidentes vinculados (apenas inativado)

**Prioridade:** IMPORTANTE

---

### RN-RF060-009: Categorização Hierárquica de 3 Níveis

**Descrição:** Sistema DEVE permitir categorização hierárquica com até 3 níveis (Categoria → Subcategoria → Item).

**Critério de Aceite:**
- Categoria (ex: Hardware, Software, Rede)
- Subcategoria (ex: Desktop, Servidor, Storage)
- Item (ex: Teclado, Mouse, Monitor)
- Campo de busca com autocomplete
- Estatísticas agregadas por nível da hierarquia

**Validações:**
- Categoria DEVE ter ao menos 1 subcategoria
- Subcategoria DEVE ter ao menos 1 item
- Item DEVE ter nome único dentro da subcategoria
- Hierarquia NÃO pode ser alterada se houver chamados vinculados

**Exemplo:**
```
Hardware
  ├─ Desktop
  │   ├─ Teclado
  │   ├─ Mouse
  │   └─ Monitor
  └─ Servidor
      ├─ Físico
      └─ Virtual
```

**Prioridade:** MÉDIA

---

### RN-RF060-010: Especialistas Preferenciais por Tipo

**Descrição:** Cada tipo de chamado PODE ter técnicos especialistas preferenciais configurados, que recebem prioridade na atribuição de chamados.

**Critério de Aceite:**
- Ao criar chamado, sistema sugere especialista preferencial
- Se especialista indisponível, sugere backup
- Especialista DEVE ter horário de disponibilidade configurado
- Dashboard mostra taxa de resolução do especialista por tipo

**Validações:**
- Especialista DEVE ter permissão para atender o tipo
- Especialista NÃO pode ter mais de 10 chamados simultâneos (limite configurável)
- Se especialista em férias/afastado, sistema escolhe backup automaticamente

**Prioridade:** MÉDIA

---

### RN-RF060-011: Métricas ITIL Obrigatórias

**Descrição:** Sistema DEVE calcular automaticamente métricas ITIL por tipo de chamado: MTTR, MTBF, First Call Resolution.

**Critério de Aceite:**
- **MTTR** (Mean Time to Resolve): Tempo médio entre abertura e fechamento
- **MTBF** (Mean Time Between Failures): Tempo médio entre chamados do mesmo CI
- **FCR** (First Call Resolution): % de chamados resolvidos sem reabrir
- Dashboards com trending mensal/anual
- Exportação para Excel/PDF

**Validações:**
- Métricas DEVEM ser calculadas apenas para chamados fechados
- MTTR DEVE excluir tempo em estado "Aguardando Usuário"
- FCR DEVE considerar apenas chamados não reabertos em 7 dias

**Prioridade:** IMPORTANTE

---

### RN-RF060-012: Integração com CMDB Obrigatória

**Descrição:** Chamados DEVEM poder ser vinculados a Configuration Items (CIs) do CMDB, e o impacto DEVE ser calculado automaticamente com base na criticidade do CI.

**Critério de Aceite:**
- Dropdown de CIs filtrado por tipo de chamado
- Histórico de chamados do CI exibido ao selecionar
- Impacto calculado:
  - CI Crítico → Impacto Alto
  - CI Importante → Impacto Médio
  - CI Normal → Impacto Baixo
- Notifica responsável do CI ao criar chamado

**Validações:**
- CI DEVE existir no CMDB
- CI DEVE estar ativo
- Usuário DEVE ter permissão para visualizar o CI (multi-tenancy)

**Prioridade:** IMPORTANTE

---

### RN-RF060-013: Janelas de Mudança Configuráveis

**Descrição:** Tipos "Mudança" DEVEM ter janelas de execução configuradas, e mudanças NÃO PODEM ser executadas fora da janela sem aprovação emergencial.

**Critério de Aceite:**
- Janelas configuradas por dia da semana e horário
- Frequência: semanal, quinzenal, mensal
- Calendário visual mostra janelas disponíveis
- Mudanças fora da janela requerem aprovação gerencial + justificativa
- Notifica equipe 24h antes da janela

**Validações:**
- Janela DEVE ter duração mínima de 1 hora
- Janelas NÃO podem sobrepor (mesma equipe)
- Mudanças emergenciais DEVEM ter justificativa (mínimo 50 caracteres)
- Aprovação emergencial DEVE ser de gerente ou superior

**Exemplo:**
```
Janela: Sábado 02:00-06:00 (semanal)
Equipe: Infraestrutura
Mudanças Permitidas: Atualizações de SO, patches de segurança
```

**Prioridade:** IMPORTANTE

---

### RN-RF060-014: Cálculo de Custos por Tipo

**Descrição:** Sistema DEVE calcular custo médio de atendimento por tipo de chamado, considerando horas técnicas, ferramentas e terceiros.

**Critério de Aceite:**
- Custo técnico = horas trabalhadas × valor/hora do técnico
- Custo de ferramentas = licenças + recursos utilizados
- Custo de terceiros = valores pagos a fornecedores
- Total por tipo = soma dos 3 custos
- Dashboard com budget vs. real
- Trending mensal/anual de custos

**Validações:**
- Valor/hora do técnico DEVE estar configurado
- Custos DEVEM ser registrados em moeda local (BRL)
- Relatório DEVE permitir filtro por período (mês, trimestre, ano)

**Prioridade:** MÉDIA

---

### RN-RF060-015: Relatórios Gerenciais Obrigatórios

**Descrição:** Sistema DEVE gerar relatórios gerenciais com volume de chamados por tipo, SLA compliance e trending.

**Critério de Aceite:**
- **Volume por Tipo**: Gráfico pizza com % de cada tipo
- **SLA Compliance**: Gráfico barras com % dentro do SLA por tipo
- **Top 10 Tipos**: Ranking dos tipos mais frequentes
- **Trending**: Evolução mensal/anual por tipo
- Exportação Excel/PDF
- Agendamento de envio por e-mail (diário, semanal, mensal)

**Validações:**
- Relatórios DEVEM considerar apenas período selecionado
- Gráficos DEVEM ter cores distintas para cada tipo
- Exportação DEVE incluir data/hora de geração
- E-mail agendado DEVE ser enviado no horário configurado

**Prioridade:** IMPORTANTE

---

## 4. IMPACTO E DEPENDÊNCIAS

### 4.1 Impacto em Outros Módulos

- **RF061 - Abertura de Chamados**: Utiliza tipos de chamado e formulários dinâmicos
- **RF062 - Atendimento de Chamados**: Utiliza templates de resolução e escalonamento
- **RF063 - Gestão de Filas**: Utiliza priorização automática
- **RF064 - Dashboards Service Desk**: Consome métricas ITIL
- **RF065 - CMDB**: Integração com Configuration Items

### 4.2 Dependências Técnicas

- **Backend**: .NET 10, Entity Framework Core, MediatR, FluentValidation
- **Frontend**: Angular 19, Angular Material, Transloco
- **Jobs**: Hangfire (escalonamento automático, notificações SLA)
- **Notificações**: SignalR (tempo real)
- **Storage**: Azure Blob Storage (anexos de templates)

### 4.3 Requisitos de Infraestrutura

- Job Hangfire executando a cada 5 minutos (escalonamento)
- Job Hangfire executando a cada 15 minutos (notificação SLA)
- SignalR hub configurado (notificações em tempo real)
- Redis para cache de SLAs

---

## 5. CENTRAL DE FUNCIONALIDADES

### 5.1 Registro na Central

```sql
INSERT INTO SistemaFuncionalidade (Codigo, Nome, Descricao, Modulo)
VALUES (
  'GES.TIPOS_CHAMADO',
  'Gestão de Tipos de Chamado',
  'Gerenciamento de tipos de chamados técnicos com classificação ITIL v4, SLA configurável, formulários dinâmicos, templates de resolução e escalonamento automático',
  'Service Desk'
);
```

### 5.2 Permissões RBAC

```csharp
public static class TiposChamadoPermissions
{
    public const string View = "GES.TIPOS_CHAMADO.VIEW";
    public const string Create = "GES.TIPOS_CHAMADO.CREATE";
    public const string Edit = "GES.TIPOS_CHAMADO.EDIT";
    public const string Delete = "GES.TIPOS_CHAMADO.DELETE";
    public const string ManageSLA = "GES.TIPOS_CHAMADO.MANAGE_SLA";
    public const string ManageForms = "GES.TIPOS_CHAMADO.MANAGE_FORMS";
    public const string ManageTemplates = "GES.TIPOS_CHAMADO.MANAGE_TEMPLATES";
    public const string ManageEscalation = "GES.TIPOS_CHAMADO.MANAGE_ESCALATION";
    public const string CreateChange = "GES.TIPOS_CHAMADO.CREATE_CHANGE";
    public const string ApproveCAB = "GES.TIPOS_CHAMADO.APPROVE_CAB";
}
```

### 5.3 Eventos de Auditoria

- `TIPO_CHAMADO_CRIADO`
- `TIPO_CHAMADO_ATUALIZADO`
- `TIPO_CHAMADO_EXCLUIDO`
- `SLA_CONFIGURADO`
- `FORMULARIO_CRIADO`
- `TEMPLATE_APLICADO`
- `CHAMADO_ESCALONADO`
- `MUDANCA_APROVADA_CAB`
- `MUDANCA_REJEITADA_CAB`

### 5.4 Chaves de Tradução (i18n)

```json
{
  "tipos_chamado": {
    "titulo": "Tipos de Chamado",
    "criar": "Criar Tipo de Chamado",
    "editar": "Editar Tipo de Chamado",
    "categorias": {
      "incidente": "Incidente",
      "requisicao": "Requisição de Serviço",
      "mudanca": "Mudança",
      "problema": "Problema"
    },
    "sla": {
      "tempo_resposta": "Tempo de Resposta",
      "tempo_resolucao": "Tempo de Resolução"
    },
    "formularios": {
      "campos_customizados": "Campos Customizados",
      "adicionar_campo": "Adicionar Campo"
    },
    "templates": {
      "titulo": "Templates de Resolução",
      "criar": "Criar Template",
      "taxa_sucesso": "Taxa de Sucesso"
    },
    "escalonamento": {
      "nivel": "Nível",
      "tempo": "Tempo de Escalonamento",
      "grupo": "Grupo de Atendimento"
    },
    "metricas": {
      "mttr": "MTTR (Mean Time to Resolve)",
      "mtbf": "MTBF (Mean Time Between Failures)",
      "fcr": "FCR (First Call Resolution)"
    }
  }
}
```

---

## 6. REQUISITOS NÃO FUNCIONAIS

### 6.1 Performance

- Classificação automática de prioridade em < 500ms
- Cálculo de deadline SLA em < 200ms
- Renderização de formulários dinâmicos em < 1s
- Busca de templates com até 10.000 registros em < 2s
- Dashboard de métricas ITIL carrega em < 3s

### 6.2 Usabilidade

- Wizard intuitivo para criação de tipos de chamado
- Autocomplete na categorização hierárquica
- Preview de templates ao selecionar
- Drag-and-drop para ordenar campos de formulário
- Notificações em tempo real (SignalR)

### 6.3 Compliance

- Aderência total a ITIL v4
- Auditoria de todas as mudanças de classificação
- Rastreabilidade de escalonamentos
- Histórico de aprovações CAB
- Logs de cálculos de SLA

### 6.4 Segurança

- Multi-tenancy obrigatório (EmpresaId)
- Permissões RBAC granulares
- Validação de todos os campos de formulário dinâmico
- Sanitização de HTML em descrições
- Rate limiting em APIs (100 req/min por usuário)

### 6.5 Disponibilidade

- Jobs Hangfire resilientes (retry automático)
- Cache Redis para SLAs (fallback para banco)
- SignalR com reconnect automático
- Backup de templates no Azure Blob Storage

---

## 7. CRITÉRIOS DE ACEITE

### 7.1 Funcional

- [ ] CRUD de tipos de chamado implementado com validações
- [ ] SLA configurável por tipo e prioridade
- [ ] Formulários dinâmicos renderizados corretamente
- [ ] Templates de resolução com taxa de sucesso
- [ ] Escalonamento automático funcionando via Hangfire
- [ ] Matriz de prioridade calculada corretamente
- [ ] Aprovação CAB para mudanças com quorum
- [ ] Vinculação incidente → problema funcionando
- [ ] Categorização hierárquica com 3 níveis
- [ ] Especialistas preferenciais sugeridos
- [ ] Métricas ITIL (MTTR, MTBF, FCR) calculadas
- [ ] Integração com CMDB operacional
- [ ] Janelas de mudança respeitadas
- [ ] Custos por tipo calculados
- [ ] Relatórios gerenciais exportáveis

### 7.2 Técnico

- [ ] Clean Architecture com CQRS
- [ ] Commands e Queries com FluentValidation
- [ ] Auditoria automática (AuditInterceptor)
- [ ] Multi-tenancy em todas as tabelas (EmpresaId)
- [ ] Permissões RBAC implementadas
- [ ] Jobs Hangfire configurados
- [ ] SignalR para notificações
- [ ] Cache Redis para SLAs
- [ ] Logs estruturados
- [ ] Testes unitários (cobertura > 80%)
- [ ] Testes de integração (APIs)
- [ ] Testes E2E (Playwright)

### 7.3 Documentação

- [ ] RF060.md v2.0 (11 seções canônicas)
- [ ] RF060.yaml (sincronizado com RF.md)
- [ ] RL-RF060.md (referência ao legado - se aplicável)
- [ ] RL-RF060.yaml (rastreabilidade - se aplicável)
- [ ] UC-RF060.md (casos de uso)
- [ ] MD-RF060.md (modelo de dados com DDL)
- [ ] WF-RF060.md (wireframes)
- [ ] TC-RF060-BACKEND.md (casos de teste backend)
- [ ] TC-RF060-FRONTEND.md (casos de teste frontend)
- [ ] TC-RF060-SEGURANCA.md (casos de teste segurança)
- [ ] TC-RF060-E2E.md (casos de teste E2E)
- [ ] STATUS.yaml atualizado (v2.0)

### 7.4 Qualidade

- [ ] Build sem erros
- [ ] Todos os testes passando (100%)
- [ ] Validador RF/RL passou (se aplicável)
- [ ] Validador RF→UC→TC passou (100% cobertura)
- [ ] Code review aprovado
- [ ] Sem vulnerabilidades críticas (SonarQube)

---

## 8. RISCOS E MITIGAÇÕES

### 8.1 Riscos Técnicos

| Risco | Impacto | Probabilidade | Mitigação |
|-------|---------|---------------|-----------|
| Formulários dinâmicos com performance ruim | Alto | Média | Cache de schemas, lazy loading de campos |
| Jobs Hangfire com falhas | Alto | Baixa | Retry policy, logging detalhado, alertas |
| Cálculo de SLA incorreto | Crítico | Baixa | Testes extensivos, validação de fórmulas, casos de borda |
| Escalação não acontecendo | Alto | Média | Monitoramento de jobs, alertas se job não executar |

### 8.2 Riscos de Negócio

| Risco | Impacto | Probabilidade | Mitigação |
|-------|---------|---------------|-----------|
| Usuários não seguindo ITIL | Alto | Alta | Treinamento, wizard intuitivo, validações obrigatórias |
| CAB demorando para aprovar | Médio | Média | Prazo máximo configurável, notificações escaladas |
| Templates desatualizados | Médio | Alta | Revisão trimestral, taxa de sucesso baixa gera alerta |

---

## 9. GLOSSÁRIO

- **ITIL**: Information Technology Infrastructure Library (framework de boas práticas)
- **SLA**: Service Level Agreement (acordo de nível de serviço)
- **CAB**: Change Advisory Board (comitê de aprovação de mudanças)
- **MTTR**: Mean Time to Resolve (tempo médio de resolução)
- **MTBF**: Mean Time Between Failures (tempo médio entre falhas)
- **FCR**: First Call Resolution (resolução no primeiro contato)
- **CMDB**: Configuration Management Database (banco de dados de configuração)
- **CI**: Configuration Item (item de configuração)
- **N1/N2/N3**: Níveis de suporte (básico, avançado, especialista)

---

## 10. APROVAÇÕES

| Papel | Nome | Data | Assinatura |
|-------|------|------|------------|
| Product Owner | [Nome] | [Data] | [Assinatura] |
| Tech Lead | [Nome] | [Data] | [Assinatura] |
| Arquiteto | [Nome] | [Data] | [Assinatura] |
| Gerente de TI | [Nome] | [Data] | [Assinatura] |

---

## 11. HISTÓRICO DE REVISÕES

| Versão | Data | Autor | Descrição |
|--------|------|-------|-----------|
| 1.0 | 2025-01-14 | Equipe IControlIT | Versão inicial aprovada |
| 2.0 | 2025-12-30 | Claude Code | Migração v1.0 → v2.0 (Governança - Separação RF/RL) |

---

**Documento controlado pela Governança v2.0 - IControlIT**
**Última revisão:** 2025-12-30
