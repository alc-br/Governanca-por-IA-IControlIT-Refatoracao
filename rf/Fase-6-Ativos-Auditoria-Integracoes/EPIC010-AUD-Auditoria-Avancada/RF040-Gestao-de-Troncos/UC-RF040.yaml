# =============================================
# UC-RF040 - Gestão de Troncos Telefônicos
# Versão: 2.0
# Autor: Agência ALC - alc.dev.br
# Data: 2025-12-31
# =============================================

uc:
  rf: "RF040"
  versao: "2.0"
  data: "2025-12-31"

casos_de_uso:

  - id: "UC00"
    nome: "Listar Troncos"
    ator_principal: "usuario_autenticado"
    tipo: "leitura"
    impacta_dados: false

    covers:
      rf_items:
        - "RF-CRUD-02"
        - "RF-SEC-01"
        - "RF-MON-01"
      uc_items:
        - id: "FP-UC00-001"
          title: "Usuário acessa a funcionalidade Troncos"
          required: true
        - id: "FP-UC00-002"
          title: "Sistema valida permissão GES.TRONCOS.VISUALIZAR"
          required: true
        - id: "FP-UC00-003"
          title: "Sistema carrega troncos do tenant (Id_Fornecedor)"
          required: true
        - id: "FP-UC00-004"
          title: "Sistema exibe listagem com campos"
          required: true
        - id: "FP-UC00-005"
          title: "Sistema aplica paginação padrão"
          required: true
        - id: "FP-UC00-006"
          title: "Sistema exibe indicador visual de utilização"
          required: true
        - id: "FA-UC00-001"
          title: "Buscar por identificação ou operadora"
          required: false
        - id: "FA-UC00-002"
          title: "Ordenar por coluna"
          required: false
        - id: "FA-UC00-003"
          title: "Filtrar por status"
          required: false
        - id: "FA-UC00-004"
          title: "Filtrar por tipo de tronco"
          required: false
        - id: "FA-UC00-005"
          title: "Filtrar por localização"
          required: false
        - id: "FE-UC00-001"
          title: "Usuário sem permissão → acesso negado (HTTP 403)"
          required: true
        - id: "FE-UC00-002"
          title: "Nenhum tronco cadastrado → estado vazio"
          required: true
        - id: "FE-UC00-003"
          title: "Erro ao carregar dados"
          required: true

    precondicoes:
      - permissao: "GES.TRONCOS.VISUALIZAR"

    gatilho: "Usuario acessa funcionalidade Troncos pelo menu"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "acessa_menu_troncos"
      - passo: 2
        ator: "sistema"
        acao: "validar_permissao"
      - passo: 3
        ator: "sistema"
        acao: "carregar_troncos_tenant"
      - passo: 4
        ator: "sistema"
        acao: "exibir_listagem"
      - passo: 5
        ator: "sistema"
        acao: "aplicar_paginacao"
      - passo: 6
        ator: "sistema"
        acao: "exibir_indicador_utilizacao"

    fluxos_alternativos:
      - id: "FA-UC00-01"
        condicao: "usuario_busca_termo"
        resultado: "lista_filtrada"
      - id: "FA-UC00-02"
        condicao: "usuario_ordena_coluna"
        resultado: "lista_reordenada"
      - id: "FA-UC00-03"
        condicao: "usuario_filtra_status"
        resultado: "lista_filtrada_status"

    fluxos_excecao:
      - id: "FE-UC00-01"
        condicao: "sem_permissao"
        resultado: "acesso_negado_403"
      - id: "FE-UC00-02"
        condicao: "nenhum_tronco_cadastrado"
        resultado: "estado_vazio"

    regras_aplicadas:
      - "RN-UC-00-001"
      - "RN-UC-00-002"
      - "RN-UC-00-003"
      - "RN-UC-00-004"
      - "RN-UC-00-005"

    resultado_final:
      estado: "lista_exibida"

  - id: "UC01"
    nome: "Criar Configuração de Tronco"
    ator_principal: "usuario_autenticado"
    tipo: "crud"
    impacta_dados: true

    covers:
      rf_items:
        - "RF-CRUD-01"
        - "RF-VAL-01"
        - "RF-VAL-02"
        - "RF-VAL-03"
        - "RF-VAL-04"
        - "RF-SEC-01"
        - "RF-SEC-03"
        - "RF-SEC-04"
        - "RF-MON-01"
      uc_items:
        - id: "FP-UC01-001"
          title: "Usuário clica em Novo Tronco"
          required: true
        - id: "FP-UC01-002"
          title: "Sistema valida permissão GES.TRONCOS.CONFIGURAR"
          required: true
        - id: "FP-UC01-003"
          title: "Sistema exibe formulário"
          required: true
        - id: "FP-UC01-004"
          title: "Usuário preenche campos obrigatórios"
          required: true
        - id: "FP-UC01-005"
          title: "Usuário clica em Salvar"
          required: true
        - id: "FP-UC01-006"
          title: "Sistema valida dados"
          required: true
        - id: "FP-UC01-007"
          title: "Sistema cria registro"
          required: true
        - id: "FP-UC01-008"
          title: "Sistema inicia monitoramento automático"
          required: true
        - id: "FP-UC01-009"
          title: "Sistema registra auditoria"
          required: true
        - id: "FP-UC01-010"
          title: "Sistema atualiza integração PABX"
          required: true
        - id: "FP-UC01-011"
          title: "Sistema exibe mensagem de sucesso"
          required: true
        - id: "FA-UC01-001"
          title: "Salvar e criar outro"
          required: false
        - id: "FA-UC01-002"
          title: "Cancelar criação"
          required: false
        - id: "FE-UC01-001"
          title: "Erro de validação"
          required: true
        - id: "FE-UC01-002"
          title: "Identificação duplicada"
          required: true
        - id: "FE-UC01-003"
          title: "Erro ao validar credenciais PABX"
          required: true
        - id: "FE-UC01-004"
          title: "Tronco backup não disponível"
          required: true
        - id: "FE-UC01-005"
          title: "DDR_Final menor que DDR_Inicial"
          required: true
        - id: "FE-UC01-006"
          title: "Erro inesperado"
          required: true

    precondicoes:
      - permissao: "GES.TRONCOS.CONFIGURAR"

    gatilho: "Usuario clica em Novo Tronco"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "clicar_novo_tronco"
      - passo: 2
        ator: "sistema"
        acao: "validar_permissao"
      - passo: 3
        ator: "sistema"
        acao: "exibir_formulario"
      - passo: 4
        ator: "usuario"
        acao: "preencher_campos"
      - passo: 5
        ator: "usuario"
        acao: "salvar"
      - passo: 6
        ator: "sistema"
        acao: "validar_dados"
      - passo: 7
        ator: "sistema"
        acao: "criar_registro"
      - passo: 8
        ator: "sistema"
        acao: "iniciar_monitoramento"
      - passo: 9
        ator: "sistema"
        acao: "registrar_auditoria"
      - passo: 10
        ator: "sistema"
        acao: "atualizar_pabx"
      - passo: 11
        ator: "sistema"
        acao: "exibir_sucesso"

    fluxos_alternativos:
      - id: "FA-UC01-01"
        condicao: "usuario_salva_e_cria_outro"
        resultado: "formulario_mantido_aberto"
      - id: "FA-UC01-02"
        condicao: "usuario_cancela"
        resultado: "retorna_listagem"

    fluxos_excecao:
      - id: "FE-UC01-01"
        condicao: "validacao_falhou"
        resultado: "exibir_erros"
      - id: "FE-UC01-02"
        condicao: "identificacao_duplicada"
        resultado: "exibir_erro_duplicacao"
      - id: "FE-UC01-03"
        condicao: "credenciais_pabx_invalidas"
        resultado: "exibir_erro_credenciais"

    regras_aplicadas:
      - "RN-UC-01-001"
      - "RN-UC-01-002"
      - "RN-UC-01-003"
      - "RN-UC-01-004"
      - "RN-UC-01-005"
      - "RN-UC-01-006"
      - "RN-UC-01-007"
      - "RN-UC-01-008"
      - "RN-UC-01-009"
      - "RN-UC-01-010"
      - "RN-UC-01-011"

    resultado_final:
      estado: "tronco_criado_monitoramento_ativo"

  - id: "UC02"
    nome: "Visualizar Dashboard de Monitoramento"
    ator_principal: "usuario_autenticado"
    tipo: "leitura"
    impacta_dados: false

    covers:
      rf_items:
        - "RF-MON-01"
        - "RF-MON-02"
        - "RF-MON-03"
      uc_items:
        - id: "FP-UC02-001"
          title: "Usuário acessa Dashboard de Monitoramento"
          required: true
        - id: "FP-UC02-002"
          title: "Sistema valida permissão GES.TRONCOS.DASHBOARD"
          required: true
        - id: "FP-UC02-003"
          title: "Sistema carrega dados do tenant"
          required: true
        - id: "FP-UC02-004"
          title: "Sistema exibe dashboard completo"
          required: true
        - id: "FP-UC02-005"
          title: "Sistema estabelece conexão SignalR"
          required: true
        - id: "FP-UC02-006"
          title: "Sistema atualiza dashboard a cada 30 segundos"
          required: true
        - id: "FA-UC02-001"
          title: "Selecionar período do gráfico"
          required: false
        - id: "FA-UC02-002"
          title: "Clicar em tronco específico (drill-down)"
          required: false
        - id: "FA-UC02-003"
          title: "Exportar dashboard (PNG, PDF)"
          required: false
        - id: "FE-UC02-001"
          title: "Usuário sem permissão → acesso negado"
          required: true
        - id: "FE-UC02-002"
          title: "Nenhum tronco cadastrado → estado vazio"
          required: true
        - id: "FE-UC02-003"
          title: "Erro ao conectar SignalR"
          required: true

    precondicoes:
      - permissao: "GES.TRONCOS.DASHBOARD"

    gatilho: "Usuario acessa Dashboard de Monitoramento"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "acessa_dashboard"
      - passo: 2
        ator: "sistema"
        acao: "validar_permissao"
      - passo: 3
        ator: "sistema"
        acao: "carregar_dados_tenant"
      - passo: 4
        ator: "sistema"
        acao: "exibir_dashboard"
      - passo: 5
        ator: "sistema"
        acao: "conectar_signalr"
      - passo: 6
        ator: "sistema"
        acao: "atualizar_automaticamente_30s"

    fluxos_alternativos:
      - id: "FA-UC02-01"
        condicao: "usuario_seleciona_periodo"
        resultado: "grafico_atualizado"
      - id: "FA-UC02-02"
        condicao: "usuario_clica_tronco"
        resultado: "drill_down_exibido"

    fluxos_excecao:
      - id: "FE-UC02-01"
        condicao: "sem_permissao"
        resultado: "acesso_negado_403"
      - id: "FE-UC02-02"
        condicao: "nenhum_tronco"
        resultado: "estado_vazio"

    regras_aplicadas:
      - "RN-UC-02-001"
      - "RN-UC-02-002"
      - "RN-UC-02-003"
      - "RN-UC-02-004"
      - "RN-UC-02-005"
      - "RN-UC-02-006"

    resultado_final:
      estado: "dashboard_exibido_tempo_real"

  - id: "UC03"
    nome: "Executar Failover Manual"
    ator_principal: "usuario_autenticado"
    tipo: "acao"
    impacta_dados: true

    covers:
      rf_items:
        - "RF-AUT-01"
        - "RF-SEC-02"
      uc_items:
        - id: "FP-UC03-001"
          title: "Usuário acessa Monitoramento de Troncos"
          required: true
        - id: "FP-UC03-002"
          title: "Sistema exibe troncos com problemas"
          required: true
        - id: "FP-UC03-003"
          title: "Usuário seleciona tronco com falha"
          required: true
        - id: "FP-UC03-004"
          title: "Usuário clica em Executar Failover Manual"
          required: true
        - id: "FP-UC03-005"
          title: "Sistema valida permissão GES.TRONCOS.FAILOVER_MANUAL"
          required: true
        - id: "FP-UC03-006"
          title: "Sistema exibe modal de confirmação"
          required: true
        - id: "FP-UC03-007"
          title: "Usuário confirma failover"
          required: true
        - id: "FP-UC03-008"
          title: "Sistema executa failover"
          required: true
        - id: "FP-UC03-009"
          title: "Sistema envia notificações"
          required: true
        - id: "FP-UC03-010"
          title: "Sistema registra auditoria"
          required: true
        - id: "FP-UC03-011"
          title: "Sistema exibe mensagem de sucesso"
          required: true
        - id: "FA-UC03-001"
          title: "Cancelar failover"
          required: false
        - id: "FE-UC03-001"
          title: "Usuário sem permissão"
          required: true
        - id: "FE-UC03-002"
          title: "Tronco backup não configurado"
          required: true
        - id: "FE-UC03-003"
          title: "Tronco backup também indisponível"
          required: true
        - id: "FE-UC03-004"
          title: "Erro ao atualizar PABX"
          required: true
        - id: "FE-UC03-005"
          title: "Failover excede 5 segundos"
          required: true

    precondicoes:
      - permissao: "GES.TRONCOS.FAILOVER_MANUAL"
      - status_tronco_origem: "indisponivel ou congestionado"
      - tronco_backup_disponivel: true

    gatilho: "Usuario clica em Executar Failover Manual"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "acessar_monitoramento"
      - passo: 2
        ator: "sistema"
        acao: "exibir_troncos_problemas"
      - passo: 3
        ator: "usuario"
        acao: "selecionar_tronco_falha"
      - passo: 4
        ator: "usuario"
        acao: "clicar_executar_failover"
      - passo: 5
        ator: "sistema"
        acao: "validar_permissao"
      - passo: 6
        ator: "sistema"
        acao: "exibir_modal_confirmacao"
      - passo: 7
        ator: "usuario"
        acao: "confirmar_failover"
      - passo: 8
        ator: "sistema"
        acao: "executar_failover"
      - passo: 9
        ator: "sistema"
        acao: "enviar_notificacoes"
      - passo: 10
        ator: "sistema"
        acao: "registrar_auditoria"
      - passo: 11
        ator: "sistema"
        acao: "exibir_sucesso"

    fluxos_alternativos:
      - id: "FA-UC03-01"
        condicao: "usuario_cancela"
        resultado: "modal_fechado"

    fluxos_excecao:
      - id: "FE-UC03-01"
        condicao: "sem_permissao"
        resultado: "acesso_negado_403"
      - id: "FE-UC03-02"
        condicao: "backup_nao_configurado"
        resultado: "erro_configuracao"
      - id: "FE-UC03-03"
        condicao: "backup_indisponivel"
        resultado: "erro_backup"
      - id: "FE-UC03-04"
        condicao: "erro_pabx"
        resultado: "retry_3_tentativas"

    regras_aplicadas:
      - "RN-UC-03-001"
      - "RN-UC-03-002"
      - "RN-UC-03-003"
      - "RN-UC-03-004"
      - "RN-UC-03-005"
      - "RN-UC-03-006"
      - "RN-UC-03-007"

    resultado_final:
      estado: "failover_executado_notificacoes_enviadas"

  - id: "UC04"
    nome: "Gerar Relatório de Disponibilidade"
    ator_principal: "usuario_autenticado"
    tipo: "leitura"
    impacta_dados: false

    covers:
      rf_items:
        - "RN-RF040-09"
      uc_items:
        - id: "FP-UC04-001"
          title: "Usuário acessa Relatórios de Troncos"
          required: true
        - id: "FP-UC04-002"
          title: "Sistema valida permissão GES.TRONCOS.RELATORIOS"
          required: true
        - id: "FP-UC04-003"
          title: "Sistema exibe formulário"
          required: true
        - id: "FP-UC04-004"
          title: "Usuário seleciona período e formato"
          required: true
        - id: "FP-UC04-005"
          title: "Usuário clica em Gerar Relatório"
          required: true
        - id: "FP-UC04-006"
          title: "Sistema valida período (mínimo 30 dias)"
          required: true
        - id: "FP-UC04-007"
          title: "Sistema calcula métricas por tronco"
          required: true
        - id: "FP-UC04-008"
          title: "Sistema gera relatório completo"
          required: true
        - id: "FP-UC04-009"
          title: "Sistema calcula créditos automaticamente"
          required: true
        - id: "FP-UC04-010"
          title: "Sistema gera arquivo PDF/Excel"
          required: true
        - id: "FP-UC04-011"
          title: "Sistema envia por e-mail (se solicitado)"
          required: true
        - id: "FP-UC04-012"
          title: "Sistema exibe link para download"
          required: true
        - id: "FA-UC04-001"
          title: "Enviar por e-mail"
          required: false
        - id: "FA-UC04-002"
          title: "Agendar envio recorrente"
          required: false
        - id: "FE-UC04-001"
          title: "Período com menos de 30 dias"
          required: true
        - id: "FE-UC04-002"
          title: "Erro ao gerar PDF/Excel"
          required: true
        - id: "FE-UC04-003"
          title: "Erro ao enviar e-mail"
          required: true

    precondicoes:
      - permissao: "GES.TRONCOS.RELATORIOS"
      - historico_minimo: "30 dias completos"

    gatilho: "Usuario clica em Gerar Relatorio"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "acessar_relatorios"
      - passo: 2
        ator: "sistema"
        acao: "validar_permissao"
      - passo: 3
        ator: "sistema"
        acao: "exibir_formulario"
      - passo: 4
        ator: "usuario"
        acao: "selecionar_periodo_formato"
      - passo: 5
        ator: "usuario"
        acao: "clicar_gerar"
      - passo: 6
        ator: "sistema"
        acao: "validar_periodo"
      - passo: 7
        ator: "sistema"
        acao: "calcular_metricas"
      - passo: 8
        ator: "sistema"
        acao: "gerar_relatorio"
      - passo: 9
        ator: "sistema"
        acao: "calcular_creditos"
      - passo: 10
        ator: "sistema"
        acao: "gerar_arquivo"
      - passo: 11
        ator: "sistema"
        acao: "enviar_email"
      - passo: 12
        ator: "sistema"
        acao: "exibir_link_download"

    fluxos_alternativos:
      - id: "FA-UC04-01"
        condicao: "usuario_solicita_email"
        resultado: "relatorio_enviado_email"
      - id: "FA-UC04-02"
        condicao: "usuario_agenda_recorrente"
        resultado: "job_agendado_hangfire"

    fluxos_excecao:
      - id: "FE-UC04-01"
        condicao: "periodo_insuficiente"
        resultado: "erro_validacao_periodo"
      - id: "FE-UC04-02"
        condicao: "erro_geracao_arquivo"
        resultado: "erro_geracao"

    regras_aplicadas:
      - "RN-UC-04-001"
      - "RN-UC-04-002"
      - "RN-UC-04-003"
      - "RN-UC-04-004"
      - "RN-UC-04-005"
      - "RN-UC-04-006"

    resultado_final:
      estado: "relatorio_gerado_disponivel"

  - id: "UC05"
    nome: "Configurar Alertas de QoS"
    ator_principal: "usuario_autenticado"
    tipo: "crud"
    impacta_dados: true

    covers:
      rf_items:
        - "RN-RF040-11"
        - "RF-AUT-03"
      uc_items:
        - id: "FP-UC05-001"
          title: "Usuário acessa Configurar Alertas de QoS"
          required: true
        - id: "FP-UC05-002"
          title: "Sistema valida permissão GES.TRONCOS.CONFIGURAR"
          required: true
        - id: "FP-UC05-003"
          title: "Sistema exibe formulário de alerta"
          required: true
        - id: "FP-UC05-004"
          title: "Usuário configura alerta"
          required: true
        - id: "FP-UC05-005"
          title: "Usuário clica em Salvar Alerta"
          required: true
        - id: "FP-UC05-006"
          title: "Sistema valida dados"
          required: true
        - id: "FP-UC05-007"
          title: "Sistema cria registro ConfiguracaoAlerta"
          required: true
        - id: "FP-UC05-008"
          title: "Sistema ativa monitoramento contínuo"
          required: true
        - id: "FP-UC05-009"
          title: "Sistema exibe mensagem de sucesso"
          required: true
        - id: "FA-UC05-001"
          title: "Editar alerta existente"
          required: false
        - id: "FA-UC05-002"
          title: "Desativar alerta temporariamente"
          required: false
        - id: "FA-UC05-003"
          title: "Duplicar alerta para outro tronco"
          required: false
        - id: "FE-UC05-001"
          title: "Valor de referência inválido"
          required: true
        - id: "FE-UC05-002"
          title: "Duração mínima <1"
          required: true
        - id: "FE-UC05-003"
          title: "Nenhum canal de notificação selecionado"
          required: true

    precondicoes:
      - permissao: "GES.TRONCOS.CONFIGURAR"

    gatilho: "Usuario clica em Salvar Alerta"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "acessar_configurar_alertas"
      - passo: 2
        ator: "sistema"
        acao: "validar_permissao"
      - passo: 3
        ator: "sistema"
        acao: "exibir_formulario"
      - passo: 4
        ator: "usuario"
        acao: "configurar_alerta"
      - passo: 5
        ator: "usuario"
        acao: "salvar"
      - passo: 6
        ator: "sistema"
        acao: "validar_dados"
      - passo: 7
        ator: "sistema"
        acao: "criar_configuracao_alerta"
      - passo: 8
        ator: "sistema"
        acao: "ativar_monitoramento"
      - passo: 9
        ator: "sistema"
        acao: "exibir_sucesso"

    fluxos_alternativos:
      - id: "FA-UC05-01"
        condicao: "usuario_edita_existente"
        resultado: "alerta_atualizado"
      - id: "FA-UC05-02"
        condicao: "usuario_desativa"
        resultado: "alerta_inativo"

    fluxos_excecao:
      - id: "FE-UC05-01"
        condicao: "valor_invalido"
        resultado: "erro_validacao"
      - id: "FE-UC05-02"
        condicao: "duracao_invalida"
        resultado: "erro_validacao_duracao"

    regras_aplicadas:
      - "RN-UC-05-001"
      - "RN-UC-05-002"
      - "RN-UC-05-003"
      - "RN-UC-05-004"
      - "RN-UC-05-005"

    resultado_final:
      estado: "alerta_configurado_monitoramento_ativo"

  - id: "UC06"
    nome: "Simular Migração SIP vs E1"
    ator_principal: "usuario_autenticado"
    tipo: "leitura"
    impacta_dados: false

    covers:
      rf_items:
        - "RN-RF040-12"
      uc_items:
        - id: "FP-UC06-001"
          title: "Usuário acessa Simulador de Economia"
          required: true
        - id: "FP-UC06-002"
          title: "Sistema valida permissão GES.TRONCOS.RELATORIOS"
          required: true
        - id: "FP-UC06-003"
          title: "Sistema valida pré-requisitos (mínimo 6 meses)"
          required: true
        - id: "FP-UC06-004"
          title: "Sistema exibe formulário"
          required: true
        - id: "FP-UC06-005"
          title: "Usuário configura simulação"
          required: true
        - id: "FP-UC06-006"
          title: "Usuário clica em Simular"
          required: true
        - id: "FP-UC06-007"
          title: "Sistema calcula com base em 6 meses"
          required: true
        - id: "FP-UC06-008"
          title: "Sistema gera relatório de simulação"
          required: true
        - id: "FP-UC06-009"
          title: "Sistema exibe simulação"
          required: true
        - id: "FP-UC06-010"
          title: "Sistema permite exportar"
          required: true
        - id: "FA-UC06-001"
          title: "Ajustar custos manualmente"
          required: false
        - id: "FA-UC06-002"
          title: "Comparar 3 operadoras SIP"
          required: false
        - id: "FE-UC06-001"
          title: "Histórico insuficiente (<6 meses)"
          required: true
        - id: "FE-UC06-002"
          title: "Custos desatualizados (>90 dias)"
          required: true
        - id: "FE-UC06-003"
          title: "Economia negativa (SIP mais caro)"
          required: true

    precondicoes:
      - permissao: "GES.TRONCOS.RELATORIOS"
      - historico_minimo: "6 meses"
      - custos_atualizados: "<90 dias"

    gatilho: "Usuario clica em Simular"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "acessar_simulador"
      - passo: 2
        ator: "sistema"
        acao: "validar_permissao"
      - passo: 3
        ator: "sistema"
        acao: "validar_pre_requisitos"
      - passo: 4
        ator: "sistema"
        acao: "exibir_formulario"
      - passo: 5
        ator: "usuario"
        acao: "configurar_simulacao"
      - passo: 6
        ator: "usuario"
        acao: "clicar_simular"
      - passo: 7
        ator: "sistema"
        acao: "calcular_roi"
      - passo: 8
        ator: "sistema"
        acao: "gerar_relatorio"
      - passo: 9
        ator: "sistema"
        acao: "exibir_simulacao"
      - passo: 10
        ator: "sistema"
        acao: "permitir_exportar"

    fluxos_alternativos:
      - id: "FA-UC06-01"
        condicao: "usuario_ajusta_custos"
        resultado: "simulacao_recalculada"
      - id: "FA-UC06-02"
        condicao: "usuario_compara_3_operadoras"
        resultado: "comparativo_exibido"

    fluxos_excecao:
      - id: "FE-UC06-01"
        condicao: "historico_insuficiente"
        resultado: "erro_validacao_historico"
      - id: "FE-UC06-02"
        condicao: "custos_desatualizados"
        resultado: "alerta_imprecisao"

    regras_aplicadas:
      - "RN-UC-06-001"
      - "RN-UC-06-002"
      - "RN-UC-06-003"
      - "RN-UC-06-004"
      - "RN-UC-06-005"
      - "RN-UC-06-006"

    resultado_final:
      estado: "simulacao_gerada_recomendacao_fornecida"

  - id: "UC07"
    nome: "Analisar TCO por Tecnologia"
    ator_principal: "usuario_autenticado"
    tipo: "leitura"
    impacta_dados: false

    covers:
      rf_items:
        - "RN-RF040-14"
      uc_items:
        - id: "FP-UC07-001"
          title: "Usuário acessa Análise de TCO"
          required: true
        - id: "FP-UC07-002"
          title: "Sistema valida permissão GES.TRONCOS.RELATORIOS"
          required: true
        - id: "FP-UC07-003"
          title: "Sistema exibe formulário"
          required: true
        - id: "FP-UC07-004"
          title: "Usuário seleciona período e tecnologias"
          required: true
        - id: "FP-UC07-005"
          title: "Usuário clica em Analisar TCO"
          required: true
        - id: "FP-UC07-006"
          title: "Sistema calcula TCO por tecnologia"
          required: true
        - id: "FP-UC07-007"
          title: "Sistema gera relatório comparativo"
          required: true
        - id: "FP-UC07-008"
          title: "Sistema exibe análise"
          required: true
        - id: "FP-UC07-009"
          title: "Sistema permite exportar"
          required: true
        - id: "FA-UC07-001"
          title: "Ajustar custos manualmente"
          required: false
        - id: "FA-UC07-002"
          title: "Desconsiderar inflação"
          required: false
        - id: "FE-UC07-001"
          title: "Custos não configurados"
          required: true
        - id: "FE-UC07-002"
          title: "Erro ao calcular TCO"
          required: true

    precondicoes:
      - permissao: "GES.TRONCOS.RELATORIOS"

    gatilho: "Usuario clica em Analisar TCO"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "acessar_analise_tco"
      - passo: 2
        ator: "sistema"
        acao: "validar_permissao"
      - passo: 3
        ator: "sistema"
        acao: "exibir_formulario"
      - passo: 4
        ator: "usuario"
        acao: "selecionar_periodo_tecnologias"
      - passo: 5
        ator: "usuario"
        acao: "clicar_analisar"
      - passo: 6
        ator: "sistema"
        acao: "calcular_tco"
      - passo: 7
        ator: "sistema"
        acao: "gerar_relatorio"
      - passo: 8
        ator: "sistema"
        acao: "exibir_analise"
      - passo: 9
        ator: "sistema"
        acao: "permitir_exportar"

    fluxos_alternativos:
      - id: "FA-UC07-01"
        condicao: "usuario_ajusta_custos"
        resultado: "tco_recalculado"
      - id: "FA-UC07-02"
        condicao: "usuario_desconsidera_inflacao"
        resultado: "tco_sem_inflacao"

    fluxos_excecao:
      - id: "FE-UC07-01"
        condicao: "custos_nao_configurados"
        resultado: "erro_configuracao"
      - id: "FE-UC07-02"
        condicao: "erro_calculo"
        resultado: "erro_processamento"

    regras_aplicadas:
      - "RN-UC-07-001"
      - "RN-UC-07-002"
      - "RN-UC-07-003"
      - "RN-UC-07-004"
      - "RN-UC-07-005"
      - "RN-UC-07-006"

    resultado_final:
      estado: "analise_tco_gerada_recomendacao_fornecida"

  - id: "UC08"
    nome: "Visualizar Métricas de QoS Históricas"
    ator_principal: "usuario_autenticado"
    tipo: "leitura"
    impacta_dados: false

    covers:
      rf_items:
        - "RN-RF040-11"
        - "RF-MON-02"
        - "RF-MON-03"
      uc_items:
        - id: "FP-UC08-001"
          title: "Usuário acessa Histórico de QoS"
          required: true
        - id: "FP-UC08-002"
          title: "Sistema valida permissão GES.TRONCOS.MONITORAR"
          required: true
        - id: "FP-UC08-003"
          title: "Sistema exibe formulário"
          required: true
        - id: "FP-UC08-004"
          title: "Usuário seleciona tronco e período"
          required: true
        - id: "FP-UC08-005"
          title: "Usuário clica em Visualizar Histórico"
          required: true
        - id: "FP-UC08-006"
          title: "Sistema carrega dados históricos (90 dias)"
          required: true
        - id: "FP-UC08-007"
          title: "Sistema exibe gráficos interativos"
          required: true
        - id: "FP-UC08-008"
          title: "Sistema exibe análise de tendências"
          required: true
        - id: "FP-UC08-009"
          title: "Sistema permite drill-down"
          required: true
        - id: "FA-UC08-001"
          title: "Selecionar período customizado"
          required: false
        - id: "FA-UC08-002"
          title: "Exportar gráfico (PNG, PDF)"
          required: false
        - id: "FA-UC08-003"
          title: "Exportar dados brutos (CSV)"
          required: false
        - id: "FE-UC08-001"
          title: "Histórico insuficiente (<24h)"
          required: true
        - id: "FE-UC08-002"
          title: "Erro ao carregar dados"
          required: true

    precondicoes:
      - permissao: "GES.TRONCOS.MONITORAR"
      - historico_minimo: "24 horas"

    gatilho: "Usuario clica em Visualizar Historico"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "acessar_historico_qos"
      - passo: 2
        ator: "sistema"
        acao: "validar_permissao"
      - passo: 3
        ator: "sistema"
        acao: "exibir_formulario"
      - passo: 4
        ator: "usuario"
        acao: "selecionar_tronco_periodo"
      - passo: 5
        ator: "usuario"
        acao: "clicar_visualizar"
      - passo: 6
        ator: "sistema"
        acao: "carregar_dados_90_dias"
      - passo: 7
        ator: "sistema"
        acao: "exibir_graficos"
      - passo: 8
        ator: "sistema"
        acao: "exibir_tendencias"
      - passo: 9
        ator: "sistema"
        acao: "permitir_drill_down"

    fluxos_alternativos:
      - id: "FA-UC08-01"
        condicao: "usuario_seleciona_periodo_customizado"
        resultado: "dados_periodo_carregados"
      - id: "FA-UC08-02"
        condicao: "usuario_exporta_grafico"
        resultado: "arquivo_png_pdf_gerado"

    fluxos_excecao:
      - id: "FE-UC08-01"
        condicao: "historico_insuficiente"
        resultado: "erro_validacao_historico"
      - id: "FE-UC08-02"
        condicao: "erro_carregar_dados"
        resultado: "erro_processamento"

    regras_aplicadas:
      - "RN-UC-08-001"
      - "RN-UC-08-002"
      - "RN-UC-08-003"
      - "RN-UC-08-004"
      - "RN-UC-08-005"

    resultado_final:
      estado: "historico_qos_exibido_tendencias_analisadas"

exclusions:
  uc_items: []

historico:
  - versao: "2.0"
    data: "2025-12-31"
    autor: "Agência ALC - alc.dev.br"
    descricao: "Migração para Governança v2.0 - Estrutura completa com 9 UCs, rastreabilidade RF→UC 100%, sincronizado com UC-RF040.md"
  - versao: "1.0"
    data: "2025-12-18"
    autor: "Architect Agent"
    descricao: "Versão inicial"
