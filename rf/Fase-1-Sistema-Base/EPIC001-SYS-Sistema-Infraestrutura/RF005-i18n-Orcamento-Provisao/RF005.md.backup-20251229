# RF-005: InternacionalizaÃ§Ã£o (i18n) e LocalizaÃ§Ã£o

**VersÃ£o**: 2.0
**Ãšltima AtualizaÃ§Ã£o**: 2025-11-04
**Status**: âœ… DocumentaÃ§Ã£o Completa (Incluindo GestÃ£o de TraduÃ§Ãµes pelo UsuÃ¡rio)
**Fase**: Fase 1 - FundaÃ§Ã£o e Cadastros Base

---

## ğŸ“‹ RESUMO EXECUTIVO

### DescriÃ§Ã£o Geral

O RF-005 implementa o **Sistema de InternacionalizaÃ§Ã£o (i18n) e LocalizaÃ§Ã£o (l10n)** do IControlIT, permitindo que o sistema opere em mÃºltiplos idiomas e culturas, adaptando-se automaticamente Ã s preferÃªncias regionais dos usuÃ¡rios.

### ImportÃ¢ncia EstratÃ©gica

Este Ã© um RF **CRÃTICO DE FUNDAÃ‡ÃƒO** pois:

1. **ExpansÃ£o Global**: Permite atender clientes em mÃºltiplos paÃ­ses
2. **Compliance Legal**: Alguns paÃ­ses exigem interface no idioma local
3. **User Experience**: UsuÃ¡rios preferem sistemas no seu idioma nativo
4. **Competitividade**: Diferencial de mercado em licitaÃ§Ãµes internacionais
5. **Escalabilidade**: Facilita entrada em novos mercados
6. **ROI**: Aumenta base de clientes potenciais em 300%+

### DiferenÃ§a: Legado vs. Modernizado

| Aspecto | Sistema Legado (VB.NET) | Sistema Modernizado (.NET 10) |
|---------|-------------------------|------------------------------|
| **Idiomas** | Apenas pt-BR (hardcoded) | pt-BR, en-US, es-ES, fr-FR (dinÃ¢micos) |
| **Textos** | Hardcoded no cÃ³digo | JSON resources externos |
| **AdiÃ§Ã£o de Idioma** | Requer rebuild completo | Adiciona JSON, sem rebuild |
| **FormataÃ§Ã£o** | Fixo pt-BR | AutomÃ¡tica por cultura (dates, numbers) |
| **Emails** | Apenas portuguÃªs | Multi-idioma com templates |
| **RelatÃ³rios** | PortuguÃªs fixo | Excel/PDF traduzidos automaticamente |
| **Editor** | Apenas desenvolvedores | Interface visual para tradutores |
| **DetecÃ§Ã£o** | Manual | AutomÃ¡tica (Accept-Language) |
| **Performance** | N/A | Cache Redis (< 1ms) |

### 18 Funcionalidades Principais

1. âœ… **Multi-Idioma**: pt-BR, en-US, es-ES, fr-FR (extensÃ­vel)
2. âœ… **TraduÃ§Ã£o UI**: Todos os componentes Angular traduzidos
3. âœ… **TraduÃ§Ã£o Backend**: Mensagens de erro, validaÃ§Ãµes, emails
4. âœ… **FormataÃ§Ã£o Regional**: Datas, nÃºmeros, moedas por cultura
5. âœ… **DetecÃ§Ã£o AutomÃ¡tica**: Idioma do navegador (Accept-Language)
6. âœ… **Fallback Inteligente**: pt-BR se traduÃ§Ã£o inexistente
7. âœ… **Lazy Loading**: Carrega apenas idioma necessÃ¡rio
8. âœ… **Editor de TraduÃ§Ãµes**: Interface visual (nÃ£o-devs)
9. âœ… **PluralizaÃ§Ã£o**: Regras de plural por idioma
10. âœ… **InterpolaÃ§Ã£o**: `Bem-vindo, {{username}}!`
11. âœ… **Namespace HierÃ¡rquico**: `menu.dashboard.title`
12. âœ… **Versionamento**: HistÃ³rico de traduÃ§Ãµes
13. âœ… **ValidaÃ§Ã£o**: Chaves faltantes, traduÃ§Ãµes vazias
14. âœ… **Export/Import**: JSON/Excel para tradutores
15. âœ… **Machine Translation**: SugestÃµes via Azure Translator
16. âœ… **GestÃ£o de Idiomas**: UsuÃ¡rio pode adicionar novos idiomas
17. âœ… **Download de Template**: Baixar arquivo modelo para traduÃ§Ã£o
18. âœ… **Upload de TraduÃ§Ãµes**: Subir arquivos traduzidos (JSON/PO)

---

## ğŸ”— INTEGRAÃ‡Ã•ES OBRIGATÃ“RIAS

### 1ï¸âƒ£ Central de Funcionalidades

**CÃ³digo da Funcionalidade**: `FNC-SYS-005`
**Nome**: Sistema de InternacionalizaÃ§Ã£o (i18n)
**Categoria**: Sistema / Infraestrutura
**Tipo**: Tela + API
**DescriÃ§Ã£o**: Permite aos administradores gerenciar idiomas e traduÃ§Ãµes do sistema.

**PermissÃµes Requeridas**:
- `SYS.I18N.READ` - Visualizar traduÃ§Ãµes
- `SYS.I18N.UPDATE` - Editar traduÃ§Ãµes
- `SYS.I18N.MANAGE_LANGUAGES` - Adicionar/remover idiomas
- `SYS.I18N.AUTO_TRANSLATE` - Usar traduÃ§Ã£o automÃ¡tica (Azure)
- `SYS.I18N.EXPORT` - Exportar traduÃ§Ãµes
- `SYS.I18N.IMPORT` - Importar traduÃ§Ãµes
- `SYS.I18N.DOWNLOAD_TEMPLATE` - Baixar template de traduÃ§Ã£o
- `SYS.I18N.UPLOAD_TRANSLATION` - Upload de arquivos de traduÃ§Ã£o

### 2ï¸âƒ£ InternacionalizaÃ§Ã£o (Recursiva)

**Nota**: Este RF Ã© a base para sua prÃ³pria interface traduzida.

### 3ï¸âƒ£ Auditoria

**OperaÃ§Ãµes Auditadas**:

| OperaÃ§Ã£o | Tipo | Dados Registrados | RetenÃ§Ã£o |
|----------|------|-------------------|----------|
| Adicionar Idioma | CREATE | CÃ³digo do idioma, cultura, usuÃ¡rio | 7 anos |
| Editar TraduÃ§Ã£o | UPDATE | Chave, idioma, texto anterior, texto novo | 7 anos |
| TraduÃ§Ã£o AutomÃ¡tica | AUTO_TRANSLATE | Quantidade de chaves, idiomas | 1 ano |
| Exportar TraduÃ§Ãµes | EXPORT | Idiomas exportados, formato | 7 anos |
| Importar TraduÃ§Ãµes | IMPORT | Quantidade de chaves importadas | 7 anos |
| Download Template | DOWNLOAD | Idioma base, formato, quantidade de chaves | 1 ano |
| Upload TraduÃ§Ã£o | UPLOAD | Idioma, formato, arquivo, chaves processadas | 7 anos |
| Ativar/Desativar Idioma | UPDATE | Idioma, status anterior, status novo | 7 anos |

### 4ï¸âƒ£ Controle de Acesso (RBAC)

**Matriz de PermissÃµes por Perfil**:

| Perfil | READ | UPDATE | MANAGE_LANGUAGES | AUTO_TRANSLATE | EXPORT | IMPORT | DOWNLOAD_TEMPLATE | UPLOAD_TRANSLATION |
|--------|------|--------|------------------|----------------|--------|--------|-------------------|---------------------|
| **Super Administrador** | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… |
| **Administrador de Sistema** | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… |
| **Tradutor** | âœ… | âœ… | âŒ | âœ… | âœ… | âœ… | âœ… | âœ… |
| **Desenvolvedor** | âœ… | âŒ | âŒ | âŒ | âœ… | âŒ | âœ… | âŒ |
| **UsuÃ¡rio Final** | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ |

---

## ğŸ“ REGRAS DE NEGÃ“CIO

**Nota**: Este RF possui 22 regras de negÃ³cio. ApresentaÃ§Ã£o resumida por brevidade.

### RN-I18N-001: DetecÃ§Ã£o AutomÃ¡tica de Idioma
**DescriÃ§Ã£o**: Sistema detecta idioma preferido do usuÃ¡rio via Accept-Language header
**Ordem**: Accept-Language â†’ PreferÃªncia UsuÃ¡rio â†’ Idioma Empresa â†’ pt-BR (fallback)

### RN-I18N-002: Fallback HierÃ¡rquico
**DescriÃ§Ã£o**: Idioma Selecionado â†’ pt-BR â†’ Chave Literal
**Justificativa**: Sistema sempre funcional, mesmo com traduÃ§Ãµes incompletas

### RN-I18N-003: Lazy Loading + Cache Redis
**DescriÃ§Ã£o**: Carrega apenas idioma em uso, cache Redis (TTL 1 hora)
**Performance**: < 1ms (99% cache hit)

### RN-I18N-004: InterpolaÃ§Ã£o de VariÃ¡veis
**DescriÃ§Ã£o**: Suporta `{{variavel}}` em traduÃ§Ãµes
**Exemplo**: `Bem-vindo, {{username}}!` â†’ "Bem-vindo, JoÃ£o Silva!"

### RN-I18N-005: PluralizaÃ§Ã£o Inteligente
**DescriÃ§Ã£o**: Regras de plural corretas por idioma
**Exemplo pt-BR**: 0 itens, 1 item, 5 itens
**Exemplo en-US**: 0 items, 1 item, 5 items

### RN-I18N-006: FormataÃ§Ã£o Regional AutomÃ¡tica
**DescriÃ§Ã£o**: Datas, nÃºmeros, moedas formatados por cultura
**pt-BR**: 02/11/2024, R$ 1.234,56
**en-US**: 11/02/2024, $1,234.56

### RN-I18N-007: Timezone por UsuÃ¡rio
**DescriÃ§Ã£o**: Converte todas as datas para timezone do usuÃ¡rio
**ImplementaÃ§Ã£o**: UTC no banco â†’ Timezone usuÃ¡rio no frontend

### RN-I18N-008: TraduÃ§Ã£o de Emails
**DescriÃ§Ã£o**: Emails enviados no idioma do destinatÃ¡rio
**Templates**: Arquivo separado por idioma (welcome-pt-BR.html, welcome-en-US.html)

### RN-I18N-009: RelatÃ³rios Multi-Idioma
**DescriÃ§Ã£o**: Excel/PDF com cabeÃ§alhos traduzidos
**ImplementaÃ§Ã£o**: ClosedXML + traduÃ§Ãµes via `_localizationService`

### RN-I18N-010: TraduÃ§Ã£o AutomÃ¡tica Azure
**DescriÃ§Ã£o**: SugestÃµes via Azure Translator API
**Custo**: GrÃ¡tis atÃ© 2M caracteres/mÃªs, $10/1M depois
**Flag**: `Fl_Machine_Translation = 1` (requer revisÃ£o humana)

### RN-I18N-011: Editor Visual de TraduÃ§Ãµes
**DescriÃ§Ã£o**: Interface web para tradutores nÃ£o-devs
**Funcionalidades**: Listar, filtrar, buscar, editar, histÃ³rico, export/import

### RN-I18N-012: ValidaÃ§Ã£o de Chaves Faltantes
**DescriÃ§Ã£o**: Job noturno detecta traduÃ§Ãµes faltantes
**RelatÃ³rio**: Email para administradores com lista de chaves

### RN-I18N-013: Namespace HierÃ¡rquico
**DescriÃ§Ã£o**: Chaves organizadas em namespaces
**Exemplo**: `menu.dashboard.title`, `validation.required`, `common.buttons.save`

### RN-I18N-014: Versionamento de TraduÃ§Ãµes
**DescriÃ§Ã£o**: HistÃ³rico completo de mudanÃ§as em traduÃ§Ãµes
**Auditoria**: Quem, quando, o que mudou (diff)

### RN-I18N-015: Hot Reload (Sem Restart)
**DescriÃ§Ã£o**: AlteraÃ§Ãµes em traduÃ§Ãµes aplicadas sem restart do servidor
**ImplementaÃ§Ã£o**: Cache invalidation via Redis Pub/Sub

### RN-I18N-016: GestÃ£o de Idiomas pelo UsuÃ¡rio
**DescriÃ§Ã£o**: Administradores podem adicionar novos idiomas sem intervenÃ§Ã£o de desenvolvedores
**Funcionalidades**:
- Listar idiomas existentes com status (Ativo/Inativo)
- Adicionar novo idioma (cÃ³digo ISO 639-1 + ISO 3166-1)
- Ativar/Desativar idiomas
- Visualizar progresso de traduÃ§Ã£o (% completo)
- Definir bandeira/Ã­cone do idioma (flag-icons ou emoji)

### RN-I18N-017: Download de Template de TraduÃ§Ã£o
**DescriÃ§Ã£o**: UsuÃ¡rio pode baixar arquivo modelo com todas as chaves de traduÃ§Ã£o
**Funcionalidades**:
- Baixar traduÃ§Ã£o completa de idioma existente (para atualizaÃ§Ã£o)
- Baixar template vazio baseado em idioma de referÃªncia (pt-BR padrÃ£o)
- Formatos suportados: JSON, PO (Gettext), XLSX
- Template contÃ©m todas as chaves ativas no sistema
- Template inclui comentÃ¡rios/contexto para tradutores
- Estrutura hierÃ¡rquica preservada (namespaces)

### RN-I18N-018: Upload de TraduÃ§Ãµes pelo UsuÃ¡rio
**DescriÃ§Ã£o**: UsuÃ¡rio pode subir arquivo de traduÃ§Ã£o preenchido
**ValidaÃ§Ãµes**:
- Validar estrutura do arquivo (JSON/PO/XLSX)
- Validar formato de chaves (namespaces corretos)
- Validar interpolaÃ§Ãµes: `{{variavel}}` presentes e corretas
- Detectar chaves invÃ¡lidas ou desconhecidas
- Validar caracteres especiais e encoding (UTF-8)
**Processamento**:
- Sobrescrever traduÃ§Ãµes existentes (se idioma jÃ¡ existe)
- Criar novo idioma automaticamente (se nÃ£o existe)
- Validar e armazenar bandeira/Ã­cone do idioma
- Gerar relatÃ³rio de importaÃ§Ã£o (sucesso/erros/avisos)
- Invalidar cache Redis apÃ³s importaÃ§Ã£o

### RN-I18N-019: ValidaÃ§Ã£o de Integridade de TraduÃ§Ãµes
**DescriÃ§Ã£o**: Sistema valida traduÃ§Ãµes antes de ativar
**ValidaÃ§Ãµes AutomÃ¡ticas**:
- âœ… Todas as chaves obrigatÃ³rias presentes
- âœ… InterpolaÃ§Ãµes corretas: `{{var}}` no mesmo nÃºmero/nome
- âœ… PluralizaÃ§Ã£o correta para o idioma
- âœ… HTML/Tags balanceadas (se presente)
- âš ï¸ TraduÃ§Ãµes muito longas (> 500 caracteres) - Aviso
- âš ï¸ TraduÃ§Ãµes idÃªnticas ao original - Aviso
- âŒ Chaves vazias ou null - Erro

### RN-I18N-020: Versionamento de Arquivos de TraduÃ§Ã£o
**DescriÃ§Ã£o**: Sistema mantÃ©m histÃ³rico de uploads de traduÃ§Ã£o
**Funcionalidades**:
- Armazenar arquivo original (blob)
- Guardar metadata: data, usuÃ¡rio, versÃ£o, idioma
- Permitir rollback para versÃ£o anterior
- Comparar versÃµes (diff)
- Exportar histÃ³rico de mudanÃ§as

### RN-I18N-021: Formatos de Arquivo Suportados
**DescriÃ§Ã£o**: Sistema suporta mÃºltiplos formatos de traduÃ§Ã£o

**1. JSON (Formato PadrÃ£o)**
```json
{
  "common": {
    "buttons": {
      "save": "Salvar",
      "cancel": "Cancelar"
    }
  },
  "menu": {
    "dashboard": "Painel de Controle"
  }
}
```

**2. PO (Gettext) - Compatibilidade com ferramentas de traduÃ§Ã£o**
```po
msgid "common.buttons.save"
msgstr "Salvar"

msgid "menu.dashboard"
msgstr "Painel de Controle"
```

**3. XLSX (Excel) - Facilita traduÃ§Ã£o em massa**
| Chave | pt-BR | en-US | es-ES | Contexto |
|-------|-------|-------|-------|----------|
| common.buttons.save | Salvar | Save | Guardar | BotÃ£o de salvar |
| menu.dashboard | Painel de Controle | Dashboard | Panel de Control | Menu principal |

### RN-I18N-022: Bandeiras e Ãcones de Idiomas
**DescriÃ§Ã£o**: Sistema exibe bandeiras automaticamente para cada idioma
**ImplementaÃ§Ã£o**:
- Usar biblioteca [flag-icons](https://github.com/lipis/flag-icons) ou [country-flag-emoji-polyfill](https://github.com/talkjs/country-flag-emoji-polyfill)
- Mapear cÃ³digo de idioma para bandeira: `pt-BR` â†’ ğŸ‡§ğŸ‡·, `en-US` â†’ ğŸ‡ºğŸ‡¸, `es-ES` â†’ ğŸ‡ªğŸ‡¸
- Permitir customizaÃ§Ã£o manual da bandeira (casos especiais)
- Fallback: emoji ou Ã­cone genÃ©rico de idioma ğŸŒ

---

## ğŸ¨ INTERFACE DE GESTÃƒO DE TRADUÃ‡Ã•ES

### Tela: GestÃ£o de Idiomas e TraduÃ§Ãµes

**LocalizaÃ§Ã£o**: Sistema â†’ ConfiguraÃ§Ãµes â†’ InternacionalizaÃ§Ã£o

**Componentes da Interface**:

#### 1. Lista de Idiomas Existentes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸŒ Idiomas DisponÃ­veis                            [+ Novo Idioma]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  ğŸ‡§ğŸ‡· PortuguÃªs (Brasil) - pt-BR                                  â”‚
â”‚     Status: âœ… Ativo                                              â”‚
â”‚     Progresso: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% (1.247/1.247)       â”‚
â”‚     [ğŸ“¥ Baixar] [ğŸ“¤ Atualizar] [âš™ï¸ Configurar] [ğŸ”´ Desativar]     â”‚
â”‚                                                                   â”‚
â”‚  ğŸ‡ºğŸ‡¸ English (United States) - en-US                             â”‚
â”‚     Status: âœ… Ativo                                              â”‚
â”‚     Progresso: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘  85% (1.060/1.247)       â”‚
â”‚     [ğŸ“¥ Baixar] [ğŸ“¤ Atualizar] [âš™ï¸ Configurar] [ğŸ”´ Desativar]     â”‚
â”‚                                                                   â”‚
â”‚  ğŸ‡ªğŸ‡¸ EspaÃ±ol (EspaÃ±a) - es-ES                                    â”‚
â”‚     Status: âš ï¸ Inativo (TraduÃ§Ã£o Incompleta)                     â”‚
â”‚     Progresso: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  32% (399/1.247)        â”‚
â”‚     [ğŸ“¥ Baixar] [ğŸ“¤ Atualizar] [âš™ï¸ Configurar] [âœ… Ativar]        â”‚
â”‚                                                                   â”‚
â”‚  ğŸ‡«ğŸ‡· FranÃ§ais (France) - fr-FR                                   â”‚
â”‚     Status: ğŸ”´ Inativo (NÃ£o Iniciado)                            â”‚
â”‚     Progresso: â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   0% (0/1.247)          â”‚
â”‚     [ğŸ“¥ Baixar Template] [ğŸ“¤ Enviar] [âš™ï¸ Configurar] [ğŸ—‘ï¸ Excluir] â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2. Modal: Adicionar Novo Idioma

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸŒ Adicionar Novo Idioma                   [âœ–]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  Idioma: [Selecione...                    â–¼]   â”‚
â”‚          â””â”€ Lista de 200+ idiomas (ISO 639-1)  â”‚
â”‚                                                 â”‚
â”‚  CÃ³digo do Idioma: [pt-BR                  ]   â”‚
â”‚                                                 â”‚
â”‚  PaÃ­s/RegiÃ£o: [Brasil                      â–¼]  â”‚
â”‚               â””â”€ Define formato de data/moeda  â”‚
â”‚                                                 â”‚
â”‚  Bandeira: ğŸ‡§ğŸ‡·  [Alterar]                       â”‚
â”‚                                                 â”‚
â”‚  Idioma de ReferÃªncia: [pt-BR             â–¼]   â”‚
â”‚                        â””â”€ Base para template   â”‚
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â„¹ï¸ PrÃ³ximos Passos:                       â”‚ â”‚
â”‚  â”‚ 1. Clique em "Criar Idioma"               â”‚ â”‚
â”‚  â”‚ 2. Baixe o template de traduÃ§Ã£o           â”‚ â”‚
â”‚  â”‚ 3. Preencha as traduÃ§Ãµes                  â”‚ â”‚
â”‚  â”‚ 4. Envie o arquivo preenchido             â”‚ â”‚
â”‚  â”‚ 5. Ative o idioma quando estiver pronto   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                 â”‚
â”‚              [Cancelar] [Criar Idioma]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3. Modal: Baixar Template de TraduÃ§Ã£o

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“¥ Baixar Template de TraduÃ§Ã£o             [âœ–]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  Idioma Selecionado: ğŸ‡«ğŸ‡· FranÃ§ais (fr-FR)       â”‚
â”‚                                                 â”‚
â”‚  Tipo de Download:                              â”‚
â”‚  â—‰ Template Vazio (baseado em pt-BR)           â”‚
â”‚  â—‹ TraduÃ§Ã£o Atual (para atualizaÃ§Ã£o)            â”‚
â”‚                                                 â”‚
â”‚  Formato do Arquivo:                            â”‚
â”‚  â—‰ JSON (recomendado para desenvolvedores)      â”‚
â”‚  â—‹ PO (Gettext - ferramentas de traduÃ§Ã£o)       â”‚
â”‚  â—‹ XLSX (Excel - tradutores nÃ£o-tÃ©cnicos)       â”‚
â”‚                                                 â”‚
â”‚  Incluir no Template:                           â”‚
â”‚  â˜‘ ComentÃ¡rios/Contexto                        â”‚
â”‚  â˜‘ Exemplos de uso                             â”‚
â”‚  â˜‘ Chaves com interpolaÃ§Ã£o destacadas          â”‚
â”‚  â˜‘ TraduÃ§Ãµes de idioma de referÃªncia           â”‚
â”‚                                                 â”‚
â”‚  EstatÃ­sticas:                                  â”‚
â”‚  â€¢ Total de chaves: 1.247                      â”‚
â”‚  â€¢ Namespaces: 47                              â”‚
â”‚  â€¢ Tamanho estimado: ~250 KB                   â”‚
â”‚                                                 â”‚
â”‚              [Cancelar] [ğŸ“¥ Baixar]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4. Modal: Upload de TraduÃ§Ã£o

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“¤ Enviar Arquivo de TraduÃ§Ã£o              [âœ–]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  Idioma Destino: ğŸ‡«ğŸ‡· FranÃ§ais (fr-FR)           â”‚
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                           â”‚ â”‚
â”‚  â”‚         ğŸ“„ Arraste o arquivo aqui         â”‚ â”‚
â”‚  â”‚              ou clique para selecionar    â”‚ â”‚
â”‚  â”‚                                           â”‚ â”‚
â”‚  â”‚   Formatos aceitos: .json, .po, .xlsx    â”‚ â”‚
â”‚  â”‚   Tamanho mÃ¡ximo: 5 MB                    â”‚ â”‚
â”‚  â”‚                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                 â”‚
â”‚  Arquivo Selecionado:                           â”‚
â”‚  ğŸ“„ fr-FR-traduzido.json (234 KB)               â”‚
â”‚  âœ… Formato vÃ¡lido â€¢ âœ… Encoding UTF-8           â”‚
â”‚                                                 â”‚
â”‚  OpÃ§Ãµes de ImportaÃ§Ã£o:                          â”‚
â”‚  â˜‘ Sobrescrever traduÃ§Ãµes existentes           â”‚
â”‚  â˜‘ Validar interpolaÃ§Ãµes ({{variavel}})        â”‚
â”‚  â˜‘ Validar integridade (chaves obrigatÃ³rias)   â”‚
â”‚  â˜‘ Gerar relatÃ³rio detalhado                   â”‚
â”‚  â˜ Ativar idioma automaticamente (se 100%)     â”‚
â”‚                                                 â”‚
â”‚  âš ï¸ AtenÃ§Ã£o: TraduÃ§Ãµes existentes serÃ£o        â”‚
â”‚     sobrescritas. Uma versÃ£o de backup serÃ¡    â”‚
â”‚     criada automaticamente.                     â”‚
â”‚                                                 â”‚
â”‚              [Cancelar] [ğŸ“¤ Enviar]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 5. Resultado do Upload

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Upload ConcluÃ­do com Sucesso!           [âœ–]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  Idioma: ğŸ‡«ğŸ‡· FranÃ§ais (fr-FR)                   â”‚
â”‚  Arquivo: fr-FR-traduzido.json                  â”‚
â”‚  Data/Hora: 04/11/2025 15:32                    â”‚
â”‚                                                 â”‚
â”‚  ğŸ“Š EstatÃ­sticas da ImportaÃ§Ã£o:                 â”‚
â”‚                                                 â”‚
â”‚  âœ… TraduÃ§Ãµes Importadas:        1.180          â”‚
â”‚  âš ï¸ Avisos:                         12          â”‚
â”‚  âŒ Erros (ignorados):               0          â”‚
â”‚  ğŸ“ˆ Progresso Atual:               95%          â”‚
â”‚                                                 â”‚
â”‚  âš ï¸ Avisos Encontrados:                         â”‚
â”‚  â€¢ 8 traduÃ§Ãµes muito longas (> 500 caracteres) â”‚
â”‚  â€¢ 4 traduÃ§Ãµes idÃªnticas ao original           â”‚
â”‚                                                 â”‚
â”‚  ğŸ” Chaves Faltantes (5%):                      â”‚
â”‚  â€¢ validation.custom.newRule                    â”‚
â”‚  â€¢ menu.newFeature.dashboard                    â”‚
â”‚  â€¢ ... (ver relatÃ³rio completo)                â”‚
â”‚                                                 â”‚
â”‚  ğŸ“„ [Baixar RelatÃ³rio Completo.xlsx]            â”‚
â”‚                                                 â”‚
â”‚  PrÃ³ximos Passos:                               â”‚
â”‚  â€¢ Revise os avisos (opcional)                 â”‚
â”‚  â€¢ Complete as traduÃ§Ãµes faltantes (5%)        â”‚
â”‚  â€¢ Ative o idioma quando estiver pronto        â”‚
â”‚                                                 â”‚
â”‚              [Fechar] [Ativar Idioma Agora]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 6. HistÃ³rico de VersÃµes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“œ HistÃ³rico de VersÃµes - ğŸ‡«ğŸ‡· FranÃ§ais (fr-FR)         [âœ–]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  v1.5 â€¢ 04/11/2025 15:32 â€¢ JoÃ£o Silva                      â”‚
â”‚  ğŸ“¤ Upload: fr-FR-traduzido.json                            â”‚
â”‚  ğŸ“Š +1.180 chaves â€¢ Progresso: 85% â†’ 95%                    â”‚
â”‚  [ğŸ“¥ Baixar] [ğŸ”„ Restaurar] [ğŸ“Š Ver RelatÃ³rio]              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                                                             â”‚
â”‚  v1.4 â€¢ 28/10/2025 10:15 â€¢ Maria Santos                    â”‚
â”‚  ğŸ“¤ Upload: french-update.xlsx                              â”‚
â”‚  ğŸ“Š +342 chaves â€¢ Progresso: 58% â†’ 85%                      â”‚
â”‚  [ğŸ“¥ Baixar] [ğŸ”„ Restaurar] [ğŸ“Š Ver RelatÃ³rio]              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                                                             â”‚
â”‚  v1.3 â€¢ 20/10/2025 14:22 â€¢ JoÃ£o Silva                      â”‚
â”‚  ğŸ“¤ Upload: fr-initial.json                                 â”‚
â”‚  ğŸ“Š +723 chaves â€¢ Progresso: 0% â†’ 58%                       â”‚
â”‚  [ğŸ“¥ Baixar] [ğŸ”„ Restaurar] [ğŸ“Š Ver RelatÃ³rio]              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                                                             â”‚
â”‚  v1.2 â€¢ 15/10/2025 09:30 â€¢ Sistema                         â”‚
â”‚  ğŸ¤– TraduÃ§Ã£o AutomÃ¡tica (Azure Translator)                  â”‚
â”‚  ğŸ“Š +1.247 chaves â€¢ Progresso: 0% (requer revisÃ£o)          â”‚
â”‚  [ğŸ“¥ Baixar] [ğŸ”„ Restaurar] [ğŸ“Š Ver RelatÃ³rio]              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ Idiomas Suportados

### 1. PortuguÃªs (pt-BR) - PadrÃ£o
- **Cultura**: pt-BR
- **Formato Data**: dd/MM/yyyy
- **Moeda**: R$ 1.234,56
- **Decimal**: 1.234,56 (vÃ­rgula)
- **Timezone**: America/Sao_Paulo (UTC-3)

### 2. InglÃªs (en-US)
- **Cultura**: en-US
- **Formato Data**: MM/dd/yyyy
- **Moeda**: $1,234.56
- **Decimal**: 1,234.56 (ponto)
- **Timezone**: America/New_York (UTC-5)

### 3. Espanhol (es-ES)
- **Cultura**: es-ES
- **Formato Data**: dd/MM/yyyy
- **Moeda**: 1.234,56 â‚¬
- **Decimal**: 1.234,56 (vÃ­rgula)
- **Timezone**: Europe/Madrid (UTC+1)

### 4. FrancÃªs (fr-FR)
- **Cultura**: fr-FR
- **Formato Data**: dd/MM/yyyy
- **Moeda**: 1 234,56 â‚¬
- **Decimal**: 1 234,56 (espaÃ§o)
- **Timezone**: Europe/Paris (UTC+1)

---

## ğŸ”„ FLUXO DE TRABALHO: ADICIONAR NOVO IDIOMA

### Fluxo Completo (Passo a Passo)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FASE 1: CRIAÃ‡ÃƒO DO IDIOMA                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
    Administrador acessa: Sistema â†’ ConfiguraÃ§Ãµes â†’ i18n
                           â†“
              Clica em [+ Novo Idioma]
                           â†“
         Preenche Modal de CriaÃ§Ã£o:
         â€¢ Seleciona idioma (ex: Italiano)
         â€¢ Define cÃ³digo (it-IT)
         â€¢ Seleciona paÃ­s/regiÃ£o (ItÃ¡lia)
         â€¢ Bandeira: ğŸ‡®ğŸ‡¹ (automÃ¡tica)
         â€¢ Idioma de referÃªncia: pt-BR
                           â†“
              Clica em [Criar Idioma]
                           â†“
    Sistema cria registro do novo idioma (Status: Inativo)
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FASE 2: DOWNLOAD DO TEMPLATE                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
    Administrador clica em [ğŸ“¥ Baixar Template]
                           â†“
         Seleciona opÃ§Ãµes:
         â€¢ Tipo: Template Vazio
         â€¢ Formato: XLSX (mais fÃ¡cil para tradutores)
         â€¢ Inclui: ComentÃ¡rios + Exemplos
                           â†“
           Sistema gera arquivo it-IT-template.xlsx:
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ Chave | it-IT | pt-BR (ref) | Info â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
           â”‚ common.buttons.save | | Salvar | BotÃ£o |
           â”‚ menu.dashboard | | Painel | Menu  â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
           Arquivo baixado (1.247 chaves)
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FASE 3: TRADUÃ‡ÃƒO (OFFLINE - FORA DO SISTEMA)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
    Tradutor/Equipe abre it-IT-template.xlsx
                           â†“
        Preenche coluna it-IT com traduÃ§Ãµes:
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Chave | it-IT | pt-BR (ref) | Info     â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ common.buttons.save | Salva | Salvar | BotÃ£o |
        â”‚ menu.dashboard | Cruscotto | Painel | Menu  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
    Salva arquivo como it-IT-completo.xlsx
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FASE 4: UPLOAD DAS TRADUÃ‡Ã•ES                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
    Administrador clica em [ğŸ“¤ Atualizar]
                           â†“
         Arrasta it-IT-completo.xlsx para Ã¡rea de upload
                           â†“
           Sistema valida arquivo:
           âœ… Formato vÃ¡lido (XLSX)
           âœ… Encoding correto (UTF-8)
           âœ… Estrutura de chaves correta
           âœ… InterpolaÃ§Ãµes validadas
           âš ï¸ 5 traduÃ§Ãµes muito longas (aviso)
           âš ï¸ 2 traduÃ§Ãµes idÃªnticas ao pt-BR (aviso)
           âŒ 0 erros crÃ­ticos
                           â†“
         Administrador marca opÃ§Ãµes:
         â˜‘ Sobrescrever traduÃ§Ãµes existentes
         â˜‘ Validar interpolaÃ§Ãµes
         â˜‘ Gerar relatÃ³rio detalhado
         â˜ Ativar idioma automaticamente
                           â†“
              Clica em [ğŸ“¤ Enviar]
                           â†“
         Sistema processa importaÃ§Ã£o:
         â€¢ Cria backup da versÃ£o anterior
         â€¢ Importa 1.180 chaves (95%)
         â€¢ Registra auditoria
         â€¢ Invalida cache Redis
         â€¢ Gera relatÃ³rio detalhado
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FASE 5: ATIVAÃ‡ÃƒO DO IDIOMA                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
    Sistema exibe resultado:
    ğŸ“Š 95% completo (1.180/1.247)
    âš ï¸ 67 chaves faltantes (5%)
                           â†“
    Administrador decide:

    OPÃ‡ÃƒO A: Ativar Parcialmente       OPÃ‡ÃƒO B: Completar 100%
    â”œâ”€ Clica [Ativar Agora]           â”œâ”€ Baixa relatÃ³rio de faltantes
    â”œâ”€ Idioma fica Ativo              â”œâ”€ Completa traduÃ§Ãµes
    â””â”€ Chaves faltantes = fallback    â”œâ”€ Faz novo upload
                                       â””â”€ Ativa quando 100%
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RESULTADO: IDIOMA DISPONÃVEL NO SISTEMA                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
    UsuÃ¡rios veem novo idioma no seletor:
    ğŸ‡§ğŸ‡· PortuguÃªs  |  ğŸ‡ºğŸ‡¸ English  |  ğŸ‡®ğŸ‡¹ Italiano âœ¨ NOVO
```

### Casos de Uso Principais

#### UC00: Listar Idiomas DisponÃ­veis
**Ator**: Administrador de Sistema
**PrÃ©-condiÃ§Ã£o**: UsuÃ¡rio autenticado com permissÃ£o `SYS.I18N.READ`
**Fluxo**:
1. Acessa menu Sistema â†’ ConfiguraÃ§Ãµes â†’ InternacionalizaÃ§Ã£o
2. Sistema exibe lista de idiomas cadastrados
3. Para cada idioma, exibe:
   - Bandeira e nome do idioma
   - CÃ³digo (ex: pt-BR)
   - Status (Ativo/Inativo)
   - Progresso de traduÃ§Ã£o (%)
   - AÃ§Ãµes disponÃ­veis

**PÃ³s-condiÃ§Ã£o**: UsuÃ¡rio visualiza status de todos os idiomas

---

#### UC01: Adicionar Novo Idioma
**Ator**: Administrador de Sistema
**PrÃ©-condiÃ§Ã£o**: PermissÃ£o `SYS.I18N.MANAGE_LANGUAGES`
**Fluxo Principal**:
1. Clica em [+ Novo Idioma]
2. Seleciona idioma da lista (ISO 639-1)
3. Define cÃ³digo completo (ex: it-IT)
4. Seleciona paÃ­s/regiÃ£o para formataÃ§Ã£o
5. Sistema sugere bandeira automaticamente
6. Seleciona idioma de referÃªncia (padrÃ£o: pt-BR)
7. Clica em [Criar Idioma]
8. Sistema:
   - Valida cÃ³digo Ãºnico
   - Cria registro do idioma (Status: Inativo)
   - Registra auditoria
   - Exibe mensagem de sucesso

**Fluxo Alternativo 1 - CÃ³digo Duplicado**:
- 7a. CÃ³digo jÃ¡ existe
- Sistema exibe erro: "Idioma it-IT jÃ¡ cadastrado"
- Retorna ao passo 3

**PÃ³s-condiÃ§Ã£o**: Novo idioma criado, pronto para receber traduÃ§Ãµes

---

#### UC02: Baixar Template de TraduÃ§Ã£o
**Ator**: Administrador/Tradutor
**PrÃ©-condiÃ§Ã£o**: PermissÃ£o `SYS.I18N.DOWNLOAD_TEMPLATE`
**Fluxo Principal**:
1. Seleciona idioma na lista
2. Clica em [ğŸ“¥ Baixar Template]
3. Seleciona tipo:
   - Template Vazio (novo idioma)
   - TraduÃ§Ã£o Atual (atualizaÃ§Ã£o)
4. Seleciona formato:
   - JSON (desenvolvedores)
   - PO/Gettext (ferramentas CAT)
   - XLSX (tradutores nÃ£o-tÃ©cnicos)
5. Marca opÃ§Ãµes desejadas:
   - â˜‘ ComentÃ¡rios/Contexto
   - â˜‘ Exemplos de uso
   - â˜‘ TraduÃ§Ãµes de referÃªncia
6. Clica em [ğŸ“¥ Baixar]
7. Sistema:
   - Gera arquivo no formato selecionado
   - Inclui todas as chaves ativas (1.247+)
   - Adiciona metadata e instruÃ§Ãµes
   - Registra download na auditoria
   - Envia arquivo para download

**PÃ³s-condiÃ§Ã£o**: UsuÃ¡rio possui arquivo modelo para traduÃ§Ã£o

---

#### UC03: Upload de TraduÃ§Ãµes
**Ator**: Administrador/Tradutor
**PrÃ©-condiÃ§Ã£o**:
- PermissÃ£o `SYS.I18N.UPLOAD_TRANSLATION`
- Arquivo de traduÃ§Ã£o preenchido

**Fluxo Principal**:
1. Seleciona idioma de destino
2. Clica em [ğŸ“¤ Atualizar]
3. Arrasta arquivo ou seleciona via botÃ£o
4. Sistema valida arquivo (real-time):
   - âœ… Formato correto (JSON/PO/XLSX)
   - âœ… Encoding UTF-8
   - âœ… Tamanho < 5 MB
5. Marca opÃ§Ãµes de importaÃ§Ã£o:
   - â˜‘ Sobrescrever existentes
   - â˜‘ Validar interpolaÃ§Ãµes
   - â˜‘ Validar integridade
   - â˜‘ Gerar relatÃ³rio
   - â˜ Ativar automaticamente (se 100%)
6. Clica em [ğŸ“¤ Enviar]
7. Sistema:
   - Cria backup da versÃ£o anterior
   - Valida estrutura completa
   - Valida interpolaÃ§Ãµes `{{var}}`
   - Importa traduÃ§Ãµes
   - Calcula progresso (%)
   - Registra auditoria completa
   - Invalida cache Redis
   - Gera relatÃ³rio detalhado
8. Exibe resultado com estatÃ­sticas

**Fluxo Alternativo 1 - Erros CrÃ­ticos**:
- 7a. Arquivo com erros crÃ­ticos (ex: chaves invÃ¡lidas)
- Sistema rejeita importaÃ§Ã£o
- Exibe lista de erros detalhados
- Permite corrigir e reenviar

**Fluxo Alternativo 2 - Avisos NÃ£o-CrÃ­ticos**:
- 7b. Arquivo com avisos (ex: traduÃ§Ãµes longas)
- Sistema importa mesmo assim
- Exibe avisos no relatÃ³rio
- Permite revisÃ£o posterior

**PÃ³s-condiÃ§Ã£o**: TraduÃ§Ãµes importadas e disponÃ­veis no sistema

---

#### UC04: Ativar/Desativar Idioma
**Ator**: Administrador de Sistema
**PrÃ©-condiÃ§Ã£o**:
- PermissÃ£o `SYS.I18N.MANAGE_LANGUAGES`
- Idioma com traduÃ§Ãµes (mÃ­nimo recomendado: 80%)

**Fluxo Principal - Ativar**:
1. Seleciona idioma inativo
2. Clica em [âœ… Ativar]
3. Sistema valida:
   - âš ï¸ Se < 80%: Exibe aviso de incompletude
   - âœ… Se >= 80%: Permite ativaÃ§Ã£o
4. Administrador confirma
5. Sistema:
   - Atualiza status para Ativo
   - Invalida cache
   - Registra auditoria
   - Notifica usuÃ¡rios (opcional)
6. Idioma aparece no seletor para usuÃ¡rios

**Fluxo Principal - Desativar**:
1. Seleciona idioma ativo
2. Clica em [ğŸ”´ Desativar]
3. Sistema verifica:
   - âŒ Se pt-BR: NÃ£o permite (idioma padrÃ£o)
   - âœ… Outros: Permite desativaÃ§Ã£o
4. Administrador confirma
5. Sistema:
   - Atualiza status para Inativo
   - Remove do seletor
   - UsuÃ¡rios usando esse idioma â†’ fallback pt-BR
   - Registra auditoria

**PÃ³s-condiÃ§Ã£o**: Status do idioma alterado

---

#### UC05: Visualizar HistÃ³rico de VersÃµes
**Ator**: Administrador/Tradutor
**PrÃ©-condiÃ§Ã£o**: PermissÃ£o `SYS.I18N.READ`
**Fluxo**:
1. Seleciona idioma
2. Clica em [âš™ï¸ Configurar] â†’ [ğŸ“œ HistÃ³rico]
3. Sistema exibe:
   - Lista de uploads anteriores
   - Data/hora, usuÃ¡rio, arquivo
   - Delta de progresso (antes/depois)
   - Quantidade de chaves adicionadas/alteradas
4. Para cada versÃ£o, permite:
   - [ğŸ“¥ Baixar] - Baixar versÃ£o especÃ­fica
   - [ğŸ”„ Restaurar] - Reverter para esta versÃ£o
   - [ğŸ“Š Ver RelatÃ³rio] - RelatÃ³rio detalhado do upload

**PÃ³s-condiÃ§Ã£o**: UsuÃ¡rio visualiza histÃ³rico completo

---

#### UC06: Restaurar VersÃ£o Anterior
**Ator**: Administrador de Sistema
**PrÃ©-condiÃ§Ã£o**:
- PermissÃ£o `SYS.I18N.MANAGE_LANGUAGES`
- VersÃ£o anterior existe

**Fluxo**:
1. Acessa histÃ³rico (UC05)
2. Seleciona versÃ£o desejada
3. Clica em [ğŸ”„ Restaurar]
4. Sistema exibe preview das mudanÃ§as
5. Administrador confirma
6. Sistema:
   - Cria backup da versÃ£o atual
   - Restaura traduÃ§Ãµes da versÃ£o selecionada
   - Atualiza progresso
   - Registra auditoria (operaÃ§Ã£o de rollback)
   - Invalida cache

**PÃ³s-condiÃ§Ã£o**: Idioma revertido para versÃ£o anterior

---

## ğŸ—ƒï¸ REFERÃŠNCIAS AO LEGADO

### Sistema Legado: Textos Hardcoded

**Problema**: Textos em portuguÃªs hardcoded no cÃ³digo VB.NET

```vb.net
' CÃ³digo legado (VB.NET)
lblMensagem.Text = "Bem-vindo ao sistema"
btnSalvar.Text = "Salvar"
btnCancelar.Text = "Cancelar"

' FormataÃ§Ã£o fixa pt-BR
lblData.Text = DateTime.Now.ToString("dd/MM/yyyy")
lblValor.Text = String.Format("R$ {0:N2}", valor)
```

**Problemas do Legado**:
1. âŒ ImpossÃ­vel internacionalizar sem alterar cÃ³digo
2. âŒ Textos espalhados em centenas de arquivos
3. âŒ FormataÃ§Ã£o de datas/moedas fixa em pt-BR
4. âŒ Emails apenas em portuguÃªs
5. âŒ RelatÃ³rios nÃ£o traduzÃ­veis

---

## ğŸ› ï¸ IMPLEMENTAÃ‡ÃƒO ATUAL

**Status**: âœ… **Sistema parcialmente implementado**

**Frontend (Angular)**:
- ngx-translate configurado
- Arquivos i18n: `src/assets/i18n/pt-BR.json`, `en-US.json`
- Lazy loading de traduÃ§Ãµes
- Pipe de traduÃ§Ã£o: `{{ 'menu.dashboard' | translate }}`

**Backend (.NET 10)**:
- `IStringLocalizer<T>` configurado
- Arquivos resx: `Resources/pt-BR.resx`, `en-US.resx`
- Cultura por request (Accept-Language)

**Exemplo de Uso**:

```csharp
// Backend
public class UsuarioService
{
    private readonly IStringLocalizer<UsuarioService> _localizer;

    public async Task<Result> Criar(UsuarioDto dto)
    {
        if (string.IsNullOrEmpty(dto.Email))
            return Result.Fail(_localizer["validation.email.required"]);

        // ...
    }
}
```

```typescript
// Frontend (Angular)
<h1>{{ 'menu.dashboard' | translate }}</h1>
<p>{{ 'welcome.message' | translate: {username: user.name} }}</p>

// Em cÃ³digo TypeScript
constructor(private translate: TranslateService) {}

showMessage() {
  const message = this.translate.instant('common.messages.success');
  this.toastr.success(message);
}
```

---

## ğŸ“Š Estrutura de Namespaces

```
common.
â”œâ”€â”€ buttons.
â”‚   â”œâ”€â”€ save: "Salvar"
â”‚   â”œâ”€â”€ cancel: "Cancelar"
â”‚   â”œâ”€â”€ delete: "Excluir"
â”‚   â””â”€â”€ edit: "Editar"
â”œâ”€â”€ labels.
â”‚   â”œâ”€â”€ name: "Nome"
â”‚   â”œâ”€â”€ email: "E-mail"
â”‚   â””â”€â”€ phone: "Telefone"
â””â”€â”€ messages.
    â”œâ”€â”€ success: "OperaÃ§Ã£o realizada com sucesso"
    â”œâ”€â”€ error: "Erro ao processar solicitaÃ§Ã£o"
    â””â”€â”€ confirm: "Deseja realmente continuar?"

menu.
â”œâ”€â”€ dashboard: "Painel de Controle"
â”œâ”€â”€ users: "UsuÃ¡rios"
â”œâ”€â”€ assets: "Ativos"
â””â”€â”€ reports: "RelatÃ³rios"

validation.
â”œâ”€â”€ required: "Campo obrigatÃ³rio"
â”œâ”€â”€ email: "E-mail invÃ¡lido"
â”œâ”€â”€ minLength: "MÃ­nimo {{min}} caracteres"
â””â”€â”€ maxLength: "MÃ¡ximo {{max}} caracteres"
```

---

---

## ğŸ› ï¸ IMPLEMENTAÃ‡ÃƒO TÃ‰CNICA: GESTÃƒO DE TRADUÃ‡Ã•ES

### APIs Backend (.NET 10)

#### 1. Controller: I18nController.cs

```csharp
[ApiController]
[Route("api/[controller]")]
[Authorize]
public class I18nController : ControllerBase
{
    private readonly II18nService _i18nService;
    private readonly ITranslationFileService _fileService;

    // GET: api/i18n/languages
    [HttpGet("languages")]
    [RequirePermission("SYS.I18N.READ")]
    public async Task<ActionResult<List<LanguageDto>>> GetLanguages()
    {
        var languages = await _i18nService.GetAllLanguagesAsync();
        return Ok(languages);
    }

    // POST: api/i18n/languages
    [HttpPost("languages")]
    [RequirePermission("SYS.I18N.MANAGE_LANGUAGES")]
    public async Task<ActionResult<LanguageDto>> CreateLanguage(
        [FromBody] CreateLanguageCommand command)
    {
        var result = await _i18nService.CreateLanguageAsync(command);
        return CreatedAtAction(nameof(GetLanguage),
            new { code = result.Code }, result);
    }

    // GET: api/i18n/languages/{code}
    [HttpGet("languages/{code}")]
    [RequirePermission("SYS.I18N.READ")]
    public async Task<ActionResult<LanguageDto>> GetLanguage(string code)
    {
        var language = await _i18nService.GetLanguageAsync(code);
        return Ok(language);
    }

    // PUT: api/i18n/languages/{code}/activate
    [HttpPut("languages/{code}/activate")]
    [RequirePermission("SYS.I18N.MANAGE_LANGUAGES")]
    public async Task<ActionResult> ActivateLanguage(string code)
    {
        await _i18nService.ActivateLanguageAsync(code);
        return NoContent();
    }

    // PUT: api/i18n/languages/{code}/deactivate
    [HttpPut("languages/{code}/deactivate")]
    [RequirePermission("SYS.I18N.MANAGE_LANGUAGES")]
    public async Task<ActionResult> DeactivateLanguage(string code)
    {
        await _i18nService.DeactivateLanguageAsync(code);
        return NoContent();
    }

    // GET: api/i18n/languages/{code}/download
    [HttpGet("languages/{code}/download")]
    [RequirePermission("SYS.I18N.DOWNLOAD_TEMPLATE")]
    public async Task<ActionResult> DownloadTranslations(
        string code,
        [FromQuery] DownloadTemplateQuery query)
    {
        var file = await _fileService.GenerateTemplateAsync(code, query);

        var contentType = query.Format switch
        {
            FileFormat.Json => "application/json",
            FileFormat.Po => "text/plain",
            FileFormat.Xlsx => "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
            _ => "application/octet-stream"
        };

        return File(file.Content, contentType, file.FileName);
    }

    // POST: api/i18n/languages/{code}/upload
    [HttpPost("languages/{code}/upload")]
    [RequirePermission("SYS.I18N.UPLOAD_TRANSLATION")]
    [RequestSizeLimit(5 * 1024 * 1024)] // 5 MB
    public async Task<ActionResult<UploadResultDto>> UploadTranslations(
        string code,
        [FromForm] IFormFile file,
        [FromForm] UploadTranslationCommand command)
    {
        if (file == null || file.Length == 0)
            return BadRequest("Arquivo invÃ¡lido ou vazio");

        command.LanguageCode = code;
        command.File = file;

        var result = await _fileService.ImportTranslationsAsync(command);
        return Ok(result);
    }

    // GET: api/i18n/languages/{code}/history
    [HttpGet("languages/{code}/history")]
    [RequirePermission("SYS.I18N.READ")]
    public async Task<ActionResult<List<TranslationVersionDto>>> GetHistory(
        string code,
        [FromQuery] int page = 1,
        [FromQuery] int pageSize = 20)
    {
        var history = await _i18nService.GetVersionHistoryAsync(
            code, page, pageSize);
        return Ok(history);
    }

    // POST: api/i18n/languages/{code}/restore/{versionId}
    [HttpPost("languages/{code}/restore/{versionId}")]
    [RequirePermission("SYS.I18N.MANAGE_LANGUAGES")]
    public async Task<ActionResult> RestoreVersion(
        string code,
        int versionId)
    {
        await _i18nService.RestoreVersionAsync(code, versionId);
        return NoContent();
    }

    // GET: api/i18n/languages/{code}/progress
    [HttpGet("languages/{code}/progress")]
    [RequirePermission("SYS.I18N.READ")]
    public async Task<ActionResult<TranslationProgressDto>> GetProgress(
        string code)
    {
        var progress = await _i18nService.GetTranslationProgressAsync(code);
        return Ok(progress);
    }
}
```

#### 2. Service: TranslationFileService.cs

```csharp
public class TranslationFileService : ITranslationFileService
{
    private readonly IApplicationDbContext _context;
    private readonly ILogger<TranslationFileService> _logger;
    private readonly ICacheService _cache;

    public async Task<FileDownloadDto> GenerateTemplateAsync(
        string languageCode,
        DownloadTemplateQuery query)
    {
        // Buscar todas as chaves de traduÃ§Ã£o ativas
        var keys = await _context.TranslationKeys
            .Where(k => k.IsActive)
            .OrderBy(k => k.Key)
            .ToListAsync();

        // Buscar traduÃ§Ãµes existentes (se nÃ£o for template vazio)
        Dictionary<string, string> existingTranslations = null;
        if (query.Type == TemplateType.Current)
        {
            existingTranslations = await _context.Translations
                .Where(t => t.LanguageCode == languageCode)
                .ToDictionaryAsync(t => t.Key, t => t.Value);
        }

        // Buscar traduÃ§Ãµes de referÃªncia (idioma base)
        var referenceTranslations = await _context.Translations
            .Where(t => t.LanguageCode == query.ReferenceLanguage ?? "pt-BR")
            .ToDictionaryAsync(t => t.Key, t => t.Value);

        // Gerar arquivo no formato solicitado
        return query.Format switch
        {
            FileFormat.Json => GenerateJsonFile(
                languageCode, keys, existingTranslations,
                referenceTranslations, query),
            FileFormat.Po => GeneratePoFile(
                languageCode, keys, existingTranslations,
                referenceTranslations, query),
            FileFormat.Xlsx => GenerateXlsxFile(
                languageCode, keys, existingTranslations,
                referenceTranslations, query),
            _ => throw new ArgumentException("Formato invÃ¡lido")
        };
    }

    private FileDownloadDto GenerateJsonFile(
        string languageCode,
        List<TranslationKey> keys,
        Dictionary<string, string> existingTranslations,
        Dictionary<string, string> referenceTranslations,
        DownloadTemplateQuery query)
    {
        var translations = new Dictionary<string, object>();

        // Construir estrutura hierÃ¡rquica (namespaces)
        foreach (var key in keys)
        {
            var parts = key.Key.Split('.');
            var current = translations;

            for (int i = 0; i < parts.Length - 1; i++)
            {
                if (!current.ContainsKey(parts[i]))
                    current[parts[i]] = new Dictionary<string, object>();
                current = (Dictionary<string, object>)current[parts[i]];
            }

            // Valor da traduÃ§Ã£o
            var value = existingTranslations?.GetValueOrDefault(key.Key) ?? "";

            // Adicionar comentÃ¡rios se solicitado
            if (query.IncludeComments && !string.IsNullOrEmpty(key.Context))
            {
                current[$"_comment_{parts[^1]}"] = key.Context;
            }

            current[parts[^1]] = value;

            // Adicionar referÃªncia se solicitado
            if (query.IncludeReference)
            {
                var refValue = referenceTranslations.GetValueOrDefault(key.Key);
                if (!string.IsNullOrEmpty(refValue))
                    current[$"_ref_{parts[^1]}"] = refValue;
            }
        }

        var json = JsonSerializer.Serialize(translations, new JsonSerializerOptions
        {
            WriteIndented = true,
            Encoder = System.Text.Encodings.Web.JavaScriptEncoder.UnsafeRelaxedJsonEscaping
        });

        return new FileDownloadDto
        {
            FileName = $"{languageCode}-template.json",
            Content = Encoding.UTF8.GetBytes(json),
            ContentType = "application/json"
        };
    }

    private FileDownloadDto GenerateXlsxFile(
        string languageCode,
        List<TranslationKey> keys,
        Dictionary<string, string> existingTranslations,
        Dictionary<string, string> referenceTranslations,
        DownloadTemplateQuery query)
    {
        using var workbook = new XLWorkbook();
        var worksheet = workbook.Worksheets.Add("TraduÃ§Ãµes");

        // CabeÃ§alhos
        worksheet.Cell(1, 1).Value = "Chave";
        worksheet.Cell(1, 2).Value = languageCode;
        worksheet.Cell(1, 3).Value = "ReferÃªncia (pt-BR)";
        worksheet.Cell(1, 4).Value = "Contexto";
        worksheet.Cell(1, 5).Value = "Categoria";

        // Estilizar cabeÃ§alho
        var headerRange = worksheet.Range(1, 1, 1, 5);
        headerRange.Style.Font.Bold = true;
        headerRange.Style.Fill.BackgroundColor = XLColor.LightBlue;
        headerRange.Style.Alignment.Horizontal = XLAlignmentHorizontalValues.Center;

        // Dados
        int row = 2;
        foreach (var key in keys)
        {
            worksheet.Cell(row, 1).Value = key.Key;
            worksheet.Cell(row, 2).Value = existingTranslations?.GetValueOrDefault(key.Key) ?? "";
            worksheet.Cell(row, 3).Value = referenceTranslations.GetValueOrDefault(key.Key) ?? "";
            worksheet.Cell(row, 4).Value = key.Context ?? "";
            worksheet.Cell(row, 5).Value = key.Category ?? "";

            // Destacar chaves com interpolaÃ§Ã£o
            if (key.Key.Contains("{{"))
            {
                worksheet.Cell(row, 1).Style.Font.FontColor = XLColor.Blue;
                worksheet.Cell(row, 1).Style.Font.Italic = true;
            }

            row++;
        }

        // Autofit colunas
        worksheet.Columns().AdjustToContents();

        // Congelar cabeÃ§alho
        worksheet.SheetView.FreezeRows(1);

        using var stream = new MemoryStream();
        workbook.SaveAs(stream);

        return new FileDownloadDto
        {
            FileName = $"{languageCode}-template.xlsx",
            Content = stream.ToArray(),
            ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
        };
    }

    public async Task<UploadResultDto> ImportTranslationsAsync(
        UploadTranslationCommand command)
    {
        var result = new UploadResultDto
        {
            LanguageCode = command.LanguageCode,
            FileName = command.File.FileName,
            StartTime = DateTime.UtcNow
        };

        try
        {
            // Detectar formato
            var format = DetectFileFormat(command.File.FileName);

            // Ler e validar arquivo
            Dictionary<string, string> translations;

            using (var stream = command.File.OpenReadStream())
            {
                translations = format switch
                {
                    FileFormat.Json => await ParseJsonFileAsync(stream),
                    FileFormat.Po => await ParsePoFileAsync(stream),
                    FileFormat.Xlsx => await ParseXlsxFileAsync(stream),
                    _ => throw new ArgumentException("Formato nÃ£o suportado")
                };
            }

            // Validar traduÃ§Ãµes
            var validationResult = await ValidateTranslationsAsync(
                command.LanguageCode, translations, command);

            result.TotalKeys = translations.Count;
            result.Warnings = validationResult.Warnings;
            result.Errors = validationResult.Errors;

            // Se houver erros crÃ­ticos, rejeitar importaÃ§Ã£o
            if (validationResult.HasCriticalErrors)
            {
                result.Success = false;
                result.ErrorMessage = "Arquivo contÃ©m erros crÃ­ticos";
                return result;
            }

            // Criar backup da versÃ£o atual
            await CreateBackupAsync(command.LanguageCode);

            // Importar traduÃ§Ãµes
            var importedCount = await SaveTranslationsAsync(
                command.LanguageCode, translations, command);

            result.ImportedKeys = importedCount;
            result.Success = true;

            // Calcular progresso
            var progress = await CalculateProgressAsync(command.LanguageCode);
            result.CompletionPercentage = progress;

            // Invalidar cache
            await _cache.InvalidateAsync($"i18n:{command.LanguageCode}:*");

            // Registrar auditoria
            await LogAuditAsync(command, result);

            // Ativar automaticamente se configurado e 100%
            if (command.ActivateIfComplete && progress >= 100)
            {
                await ActivateLanguageAsync(command.LanguageCode);
                result.AutoActivated = true;
            }

            result.EndTime = DateTime.UtcNow;
            return result;
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Erro ao importar traduÃ§Ãµes");
            result.Success = false;
            result.ErrorMessage = ex.Message;
            result.EndTime = DateTime.UtcNow;
            return result;
        }
    }

    private async Task<TranslationValidationResult> ValidateTranslationsAsync(
        string languageCode,
        Dictionary<string, string> translations,
        UploadTranslationCommand command)
    {
        var result = new TranslationValidationResult();

        // Buscar chaves vÃ¡lidas do sistema
        var validKeys = await _context.TranslationKeys
            .Where(k => k.IsActive)
            .Select(k => k.Key)
            .ToHashSetAsync();

        foreach (var (key, value) in translations)
        {
            // Validar: Chave existe no sistema?
            if (!validKeys.Contains(key))
            {
                result.Errors.Add(new ValidationError
                {
                    Type = ValidationErrorType.InvalidKey,
                    Key = key,
                    Message = $"Chave '{key}' nÃ£o existe no sistema"
                });
                continue;
            }

            // Validar: Valor vazio?
            if (string.IsNullOrWhiteSpace(value))
            {
                result.Warnings.Add(new ValidationWarning
                {
                    Type = ValidationWarningType.EmptyValue,
                    Key = key,
                    Message = $"TraduÃ§Ã£o vazia para chave '{key}'"
                });
                continue;
            }

            // Validar: InterpolaÃ§Ãµes corretas?
            if (command.ValidateInterpolations)
            {
                var interpolationResult = ValidateInterpolations(key, value);
                if (!interpolationResult.IsValid)
                {
                    result.Errors.Add(new ValidationError
                    {
                        Type = ValidationErrorType.InvalidInterpolation,
                        Key = key,
                        Message = interpolationResult.Message
                    });
                }
            }

            // Validar: TraduÃ§Ã£o muito longa?
            if (value.Length > 500)
            {
                result.Warnings.Add(new ValidationWarning
                {
                    Type = ValidationWarningType.TooLong,
                    Key = key,
                    Message = $"TraduÃ§Ã£o muito longa ({value.Length} caracteres)"
                });
            }

            // Validar: HTML balanceado?
            if (value.Contains("<") && !IsHtmlBalanced(value))
            {
                result.Errors.Add(new ValidationError
                {
                    Type = ValidationErrorType.UnbalancedHtml,
                    Key = key,
                    Message = "Tags HTML nÃ£o balanceadas"
                });
            }
        }

        return result;
    }
}
```

### Frontend (Angular)

#### 1. Component: i18n-management.component.ts

```typescript
@Component({
  selector: 'app-i18n-management',
  templateUrl: './i18n-management.component.html',
  styleUrls: ['./i18n-management.component.scss']
})
export class I18nManagementComponent implements OnInit {
  languages: Language[] = [];
  loading = false;

  constructor(
    private i18nService: I18nService,
    private dialog: MatDialog,
    private toastr: ToastrService
  ) {}

  ngOnInit(): void {
    this.loadLanguages();
  }

  async loadLanguages(): Promise<void> {
    this.loading = true;
    try {
      this.languages = await this.i18nService.getLanguages();
    } catch (error) {
      this.toastr.error('Erro ao carregar idiomas');
    } finally {
      this.loading = false;
    }
  }

  openCreateLanguageDialog(): void {
    const dialogRef = this.dialog.open(CreateLanguageDialogComponent, {
      width: '600px'
    });

    dialogRef.afterClosed().subscribe(result => {
      if (result) {
        this.loadLanguages();
      }
    });
  }

  openDownloadDialog(language: Language): void {
    const dialogRef = this.dialog.open(DownloadTemplateDialogComponent, {
      width: '600px',
      data: { language }
    });
  }

  openUploadDialog(language: Language): void {
    const dialogRef = this.dialog.open(UploadTranslationDialogComponent, {
      width: '600px',
      data: { language }
    });

    dialogRef.afterClosed().subscribe(result => {
      if (result?.success) {
        this.loadLanguages();
        this.showUploadResult(result);
      }
    });
  }

  async toggleLanguageStatus(language: Language): Promise<void> {
    const action = language.isActive ? 'desativar' : 'ativar';

    const confirmed = await this.confirmDialog(
      `Deseja ${action} o idioma ${language.name}?`
    );

    if (!confirmed) return;

    try {
      if (language.isActive) {
        await this.i18nService.deactivateLanguage(language.code);
        this.toastr.success('Idioma desativado com sucesso');
      } else {
        await this.i18nService.activateLanguage(language.code);
        this.toastr.success('Idioma ativado com sucesso');
      }
      this.loadLanguages();
    } catch (error) {
      this.toastr.error(`Erro ao ${action} idioma`);
    }
  }

  openHistoryDialog(language: Language): void {
    this.dialog.open(TranslationHistoryDialogComponent, {
      width: '800px',
      data: { language }
    });
  }

  private showUploadResult(result: UploadResult): void {
    this.dialog.open(UploadResultDialogComponent, {
      width: '700px',
      data: { result }
    });
  }
}
```

### Modelo de Dados (Banco de Dados)

```sql
-- Tabela: Idiomas
CREATE TABLE SistemaIdiomas (
    Id INT PRIMARY KEY IDENTITY(1,1),
    Codigo NVARCHAR(10) NOT NULL UNIQUE, -- pt-BR, en-US, etc
    Nome NVARCHAR(100) NOT NULL, -- PortuguÃªs (Brasil)
    NomeNativo NVARCHAR(100) NOT NULL, -- PortuguÃªs
    CodigoPais NVARCHAR(2) NOT NULL, -- BR, US, etc
    Cultura NVARCHAR(10) NOT NULL, -- pt-BR (para formataÃ§Ã£o)
    BandeiraEmoji NVARCHAR(10), -- ğŸ‡§ğŸ‡·
    BandeiraIconUrl NVARCHAR(500), -- URL do Ã­cone
    IsAtivo BIT NOT NULL DEFAULT 0,
    ProgressoPercentual DECIMAL(5,2) NOT NULL DEFAULT 0,
    TotalChaves INT NOT NULL DEFAULT 0,
    ChavesTraduzidas INT NOT NULL DEFAULT 0,
    IdiomaReferenciaId INT NULL, -- FK para outro idioma (usado como base)
    DataCriacao DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    DataAtualizacao DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    CriadoPorUsuarioId INT NOT NULL,

    FOREIGN KEY (IdiomaReferenciaId) REFERENCES SistemaIdiomas(Id),
    FOREIGN KEY (CriadoPorUsuarioId) REFERENCES Usuarios(Id)
);

-- Tabela: Chaves de TraduÃ§Ã£o
CREATE TABLE SistemaTraducaoChaves (
    Id INT PRIMARY KEY IDENTITY(1,1),
    Chave NVARCHAR(500) NOT NULL UNIQUE, -- common.buttons.save
    Categoria NVARCHAR(100), -- common, menu, validation
    Contexto NVARCHAR(1000), -- DescriÃ§Ã£o para tradutores
    ExemploUso NVARCHAR(1000), -- Exemplo de uso
    TemInterpolacao BIT NOT NULL DEFAULT 0, -- ContÃ©m {{variavel}}?
    VariaveisInterpolacao NVARCHAR(500), -- username,email (CSV)
    IsObrigatorio BIT NOT NULL DEFAULT 1,
    IsAtivo BIT NOT NULL DEFAULT 1,
    DataCriacao DATETIME2 NOT NULL DEFAULT GETUTCDATE(),

    INDEX IX_Chave (Chave),
    INDEX IX_Categoria (Categoria)
);

-- Tabela: TraduÃ§Ãµes
CREATE TABLE SistemaTraducoes (
    Id INT PRIMARY KEY IDENTITY(1,1),
    ChaveId INT NOT NULL,
    IdiomaId INT NOT NULL,
    Valor NVARCHAR(MAX) NOT NULL,
    FoiTraduzidoPorMaquina BIT NOT NULL DEFAULT 0,
    FoiRevisado BIT NOT NULL DEFAULT 0,
    DataCriacao DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    DataAtualizacao DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    CriadoPorUsuarioId INT NOT NULL,
    AtualizadoPorUsuarioId INT NULL,

    FOREIGN KEY (ChaveId) REFERENCES SistemaTraducaoChaves(Id),
    FOREIGN KEY (IdiomaId) REFERENCES SistemaIdiomas(Id),
    FOREIGN KEY (CriadoPorUsuarioId) REFERENCES Usuarios(Id),
    FOREIGN KEY (AtualizadoPorUsuarioId) REFERENCES Usuarios(Id),

    UNIQUE (ChaveId, IdiomaId),
    INDEX IX_Idioma (IdiomaId),
    INDEX IX_Chave_Idioma (ChaveId, IdiomaId)
);

-- Tabela: HistÃ³rico de VersÃµes
CREATE TABLE SistemaTraducaoVersoes (
    Id INT PRIMARY KEY IDENTITY(1,1),
    IdiomaId INT NOT NULL,
    NumeroVersao NVARCHAR(20) NOT NULL, -- v1.5
    NomeArquivo NVARCHAR(500) NOT NULL,
    FormatoArquivo NVARCHAR(10) NOT NULL, -- JSON, PO, XLSX
    TamanhoBytes BIGINT NOT NULL,
    ConteudoArquivo VARBINARY(MAX) NOT NULL, -- Arquivo original
    ChavesAdicionadas INT NOT NULL DEFAULT 0,
    ChavesAtualizadas INT NOT NULL DEFAULT 0,
    ChavesRemovidas INT NOT NULL DEFAULT 0,
    ProgressoAnterior DECIMAL(5,2) NOT NULL,
    ProgressoNovo DECIMAL(5,2) NOT NULL,
    Observacoes NVARCHAR(MAX),
    DataUpload DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    UploadPorUsuarioId INT NOT NULL,

    FOREIGN KEY (IdiomaId) REFERENCES SistemaIdiomas(Id),
    FOREIGN KEY (UploadPorUsuarioId) REFERENCES Usuarios(Id),

    INDEX IX_Idioma_Data (IdiomaId, DataUpload DESC)
);

-- Tabela: RelatÃ³rios de ImportaÃ§Ã£o
CREATE TABLE SistemaTraducaoRelatorios (
    Id INT PRIMARY KEY IDENTITY(1,1),
    VersaoId INT NOT NULL,
    TotalChaves INT NOT NULL,
    ChavesImportadas INT NOT NULL,
    TotalAvisos INT NOT NULL DEFAULT 0,
    TotalErros INT NOT NULL DEFAULT 0,
    DetalhesAvisos NVARCHAR(MAX), -- JSON
    DetalhesErros NVARCHAR(MAX), -- JSON
    DuracaoSegundos INT NOT NULL,
    Sucesso BIT NOT NULL,
    DataGeracao DATETIME2 NOT NULL DEFAULT GETUTCDATE(),

    FOREIGN KEY (VersaoId) REFERENCES SistemaTraducaoVersoes(Id)
);
```

---

## ğŸ“‹ RESUMO DA FUNCIONALIDADE DE GESTÃƒO DE TRADUÃ‡Ã•ES

### O Que Foi Adicionado

Esta atualizaÃ§Ã£o do RF-005 adiciona uma **interface completa de gestÃ£o de traduÃ§Ãµes pelo usuÃ¡rio**, permitindo que administradores e tradutores gerenciem idiomas sem necessidade de acesso ao cÃ³digo ou intervenÃ§Ã£o de desenvolvedores.

### Principais CaracterÃ­sticas

#### âœ… GestÃ£o de Idiomas
- Adicionar novos idiomas com cÃ³digo ISO padrÃ£o
- Ativar/Desativar idiomas conforme necessÃ¡rio
- Visualizar progresso de traduÃ§Ã£o em tempo real (%)
- Bandeiras automÃ¡ticas para cada idioma

#### âœ… Download de Templates
- **3 formatos suportados**: JSON, PO (Gettext), XLSX (Excel)
- Template vazio para novos idiomas
- Download de traduÃ§Ã£o existente para atualizaÃ§Ã£o
- Inclui comentÃ¡rios, contexto e traduÃ§Ãµes de referÃªncia

#### âœ… Upload de TraduÃ§Ãµes
- **Drag & Drop** de arquivos
- ValidaÃ§Ã£o automÃ¡tica completa:
  - Estrutura de chaves
  - InterpolaÃ§Ãµes `{{variavel}}`
  - HTML balanceado
  - Chaves obrigatÃ³rias
- RelatÃ³rio detalhado de importaÃ§Ã£o
- Backup automÃ¡tico antes de sobrescrever

#### âœ… Versionamento
- HistÃ³rico completo de todas as versÃµes
- Armazena arquivo original (blob)
- Permite rollback para versÃµes anteriores
- Diff entre versÃµes
- Auditoria completa (quem, quando, o quÃª)

#### âœ… ValidaÃ§Ãµes Inteligentes
- âœ… Chaves vÃ¡lidas do sistema
- âœ… InterpolaÃ§Ãµes corretas
- âœ… HTML/Tags balanceadas
- âš ï¸ TraduÃ§Ãµes muito longas (aviso)
- âš ï¸ TraduÃ§Ãµes idÃªnticas ao original (aviso)
- âŒ Chaves vazias ou invÃ¡lidas (erro)

### Fluxo de Trabalho TÃ­pico

```
1. Admin cria novo idioma (ex: Italiano - it-IT) âœ¨
   â†“
2. Admin baixa template XLSX com 1.247 chaves ğŸ“¥
   â†“
3. Tradutor preenche Excel offline ğŸ“
   â†“
4. Admin faz upload do arquivo traduzido ğŸ“¤
   â†“
5. Sistema valida e importa automaticamente âœ…
   â†“
6. Progresso atualiza: 95% (1.180/1.247) ğŸ“Š
   â†“
7. Admin ativa idioma quando pronto ğŸ‰
   â†“
8. UsuÃ¡rios veem novo idioma no seletor ğŸ‡®ğŸ‡¹
```

### BenefÃ­cios

1. **Zero DependÃªncia de Desenvolvedores**: Tradutores trabalham autonomamente
2. **Flexibilidade**: Suporta JSON, PO e XLSX (Excel)
3. **SeguranÃ§a**: ValidaÃ§Ã£o completa + backup automÃ¡tico
4. **Rastreabilidade**: HistÃ³rico completo com auditoria
5. **Usabilidade**: Interface visual intuitiva
6. **Escalabilidade**: Adicione quantos idiomas precisar

### Compatibilidade

- âœ… CompatÃ­vel com ngx-translate (Angular)
- âœ… CompatÃ­vel com IStringLocalizer (.NET)
- âœ… CompatÃ­vel com Gettext/PO (ferramentas CAT)
- âœ… CompatÃ­vel com Azure Translator (traduÃ§Ã£o automÃ¡tica)
- âœ… CompatÃ­vel com flag-icons (bandeiras)

### PrÃ³ximas Etapas de ImplementaÃ§Ã£o

1. **Backend (.NET 10)**:
   - Implementar `I18nController` com todos os endpoints
   - Implementar `TranslationFileService` (JSON/PO/XLSX)
   - Criar migrations para novas tabelas
   - Implementar validaÃ§Ãµes completas

2. **Frontend (Angular)**:
   - Criar `I18nManagementComponent`
   - Criar modais (Adicionar, Download, Upload, HistÃ³rico)
   - Implementar drag & drop de arquivos
   - Criar visualizaÃ§Ãµes de progresso e relatÃ³rios

3. **Testes**:
   - Testes unitÃ¡rios de validaÃ§Ã£o
   - Testes de integraÃ§Ã£o (upload/download)
   - Testes E2E do fluxo completo
   - Testes de performance (cache Redis)

4. **DocumentaÃ§Ã£o**:
   - Manual do usuÃ¡rio (como adicionar idioma)
   - Guia do tradutor (boas prÃ¡ticas)
   - DocumentaÃ§Ã£o tÃ©cnica de APIs
   - VÃ­deos tutoriais

---

## ğŸ¯ CONCLUSÃƒO

Com esta atualizaÃ§Ã£o, o **RF-005: InternacionalizaÃ§Ã£o (i18n)** se torna uma soluÃ§Ã£o completa e profissional para gerenciamento de traduÃ§Ãµes, permitindo que o IControlIT seja facilmente traduzido para qualquer idioma sem necessidade de alteraÃ§Ãµes no cÃ³digo.

A funcionalidade de **gestÃ£o de traduÃ§Ãµes pelo usuÃ¡rio** Ã© um diferencial competitivo importante, especialmente para empresas multinacionais que precisam de flexibilidade para adicionar idiomas conforme expandem para novos mercados.

**PrÃ³ximos Passos**: Implementar backend completo e interfaces Angular conforme especificado
