# =============================================
# UC - Casos de Uso (Contrato Comportamental)
# RF-002: Sistema de Configurações e Parametrização Avançada
# Versão: 1.0
# Autor: Agência ALC - alc.dev.br
# =============================================

uc:
  rf: "RF002"
  versao: "1.0"
  data: "2025-12-29"

casos_de_uso:

  - id: "UC00"
    nome: "Listar Configurações"
    ator_principal: "usuario_autenticado"

    covers:
      rf_items:
        - "RF-CRUD-02"
        - "RN-RF002-01"
        - "RN-RF002-09"
      uc_items:
        - id: "UC00-FP-01"
          title: "Fluxo principal - listagem hierarquizada"
          required: true
        - id: "UC00-FA-01"
          title: "Filtrar por categoria"
          required: false
        - id: "UC00-FA-02"
          title: "Filtrar por grupo visual"
          required: false
        - id: "UC00-FA-03"
          title: "Ordenar colunas"
          required: false
        - id: "UC00-FE-01"
          title: "Sem permissão SYS.CONFIGURACOES.READ"
          required: true

    precondicoes:
      - permissao: "SYS.CONFIGURACOES.READ"

    gatilho: "Usuario acessa menu Sistema > Configurações Gerais"

    fluxo_principal:
      - passo: 1
        ator: "usuario"
        acao: "acessa_menu_configuracoes"
      - passo: 2
        ator: "sistema"
        acao: "validar_permissao_read"
      - passo: 3
        ator: "sistema"
        acao: "aplicar_hierarquia_multitenant"
      - passo: 4
        ator: "sistema"
        acao: "carregar_configuracoes_cache_redis"
      - passo: 5
        ator: "sistema"
        acao: "mascarar_valores_sensiveis"
      - passo: 6
        ator: "sistema"
        acao: "exibir_grid_agrupado_categoria"

    fluxos_alternativos:
      - id: "FA-UC00-01"
        condicao: "usuario_aplica_filtro_categoria"
        resultado: "grid_filtrado_categoria"
      - id: "FA-UC00-02"
        condicao: "usuario_aplica_filtro_grupo"
        resultado: "grid_filtrado_grupo"
      - id: "FA-UC00-03"
        condicao: "usuario_ordena_coluna"
        resultado: "grid_ordenado"

    fluxos_excecao:
      - id: "FE-UC00-01"
        condicao: "sem_permissao_read"
        resultado: "http_403_acesso_negado"

    regras_aplicadas:
      - "RN-RF002-01"
      - "RN-RF002-09"

    resultado_final:
      estado: "grid_configuracoes_exibido"

  - id: "UC01"
    nome: "Criar Configuração"
    ator_principal: "usuario_autenticado"

    covers:
      rf_items:
        - "RF-CRUD-01"
        - "RN-RF002-02"
        - "RN-RF002-03"
        - "RN-RF002-04"
        - "RN-RF002-05"
        - "RN-RF002-06"
        - "RN-RF002-11"
      uc_items:
        - id: "UC01-FP-01"
          title: "Fluxo principal - criação completa"
          required: true
        - id: "UC01-FA-01"
          title: "Ativar criptografia"
          required: false
        - id: "UC01-FA-02"
          title: "Definir validação customizada"
          required: false
        - id: "UC01-FE-01"
          title: "Código duplicado"
          required: true
        - id: "UC01-FE-02"
          title: "Tipo inválido"
          required: true
        - id: "UC01-FE-03"
          title: "Validação regex falhou"
          required: true
        - id: "UC01-FE-04"
          title: "Sem permissão CREATE"
          required: true

    precondicoes:
      - permissao: "SYS.CONFIGURACOES.CREATE"

    gatilho: "Usuario clica em Nova Configuração"

    fluxo_principal:
      - passo: 1
        ator: "sistema"
        acao: "validar_permissao_create"
      - passo: 2
        ator: "sistema"
        acao: "exibir_formulario_hierarquizado"
      - passo: 3
        ator: "usuario"
        acao: "preencher_codigo_nome_categoria"
      - passo: 4
        ator: "usuario"
        acao: "selecionar_tipo_dado"
      - passo: 5
        ator: "usuario"
        acao: "informar_valor"
      - passo: 6
        ator: "usuario"
        acao: "definir_escopo_multitenant"
      - passo: 7
        ator: "usuario"
        acao: "clicar_salvar"
      - passo: 8
        ator: "sistema"
        acao: "validar_tipo_dado"
      - passo: 9
        ator: "sistema"
        acao: "validar_unicidade_codigo_tenant"
      - passo: 10
        ator: "sistema"
        acao: "validar_regex_se_definido"
      - passo: 11
        ator: "sistema"
        acao: "criptografar_se_fl_criptografado"
      - passo: 12
        ator: "sistema"
        acao: "persistir_registro"
      - passo: 13
        ator: "sistema"
        acao: "criar_versao_inicial"
      - passo: 14
        ator: "sistema"
        acao: "invalidar_cache_redis_pubsub"
      - passo: 15
        ator: "sistema"
        acao: "registrar_auditoria_sox"
      - passo: 16
        ator: "sistema"
        acao: "exibir_mensagem_sucesso"

    fluxos_alternativos:
      - id: "FA-UC01-01"
        condicao: "usuario_marca_criptografado"
        resultado: "valor_criptografado_azure_key_vault"
      - id: "FA-UC01-02"
        condicao: "usuario_define_validacao_regex"
        resultado: "validacao_aplicada_antes_persistir"

    fluxos_excecao:
      - id: "FE-UC01-01"
        condicao: "codigo_duplicado_tenant"
        resultado: "http_400_codigo_duplicado"
      - id: "FE-UC01-02"
        condicao: "tipo_invalido"
        resultado: "http_400_tipo_incompativel"
      - id: "FE-UC01-03"
        condicao: "validacao_regex_falhou"
        resultado: "http_400_valor_invalido"
      - id: "FE-UC01-04"
        condicao: "sem_permissao_create"
        resultado: "http_403_acesso_negado"

    regras_aplicadas:
      - "RN-RF002-02"
      - "RN-RF002-03"
      - "RN-RF002-04"
      - "RN-RF002-05"
      - "RN-RF002-06"
      - "RN-RF002-11"

    resultado_final:
      estado: "configuracao_criada_cache_invalidado"

  - id: "UC02"
    nome: "Visualizar Configuração"
    ator_principal: "usuario_autenticado"

    covers:
      rf_items:
        - "RF-CRUD-03"
        - "RN-RF002-09"
      uc_items:
        - id: "UC02-FP-01"
          title: "Fluxo principal - visualização detalhada"
          required: true
        - id: "UC02-FA-01"
          title: "Visualizar histórico de versões"
          required: false
        - id: "UC02-FE-01"
          title: "Valor sensível mascarado"
          required: true
        - id: "UC02-FE-02"
          title: "Sem permissão READ"
          required: true

    precondicoes:
      - permissao: "SYS.CONFIGURACOES.READ"

    gatilho: "Usuario clica em Ver Detalhes"

    fluxo_principal:
      - passo: 1
        ator: "sistema"
        acao: "validar_permissao_read"
      - passo: 2
        ator: "sistema"
        acao: "carregar_configuracao_id"
      - passo: 3
        ator: "sistema"
        acao: "mascarar_se_criptografado"
      - passo: 4
        ator: "sistema"
        acao: "carregar_historico_versoes"
      - passo: 5
        ator: "sistema"
        acao: "exibir_modal_detalhes"

    fluxos_alternativos:
      - id: "FA-UC02-01"
        condicao: "usuario_acessa_aba_historico"
        resultado: "timeline_versoes_exibida"

    fluxos_excecao:
      - id: "FE-UC02-01"
        condicao: "valor_criptografado_usuario_sem_decrypt"
        resultado: "valor_exibido_mascarado_asteriscos"
      - id: "FE-UC02-02"
        condicao: "sem_permissao_read"
        resultado: "http_403_acesso_negado"

    regras_aplicadas:
      - "RN-RF002-09"

    resultado_final:
      estado: "detalhes_configuracao_exibidos"

  - id: "UC03"
    nome: "Editar Configuração"
    ator_principal: "usuario_autenticado"

    covers:
      rf_items:
        - "RF-CRUD-04"
        - "RN-RF002-05"
        - "RN-RF002-06"
        - "RN-RF002-11"
        - "RN-RF002-12"
        - "RN-RF002-13"
        - "RN-RF002-14"
      uc_items:
        - id: "UC03-FP-01"
          title: "Fluxo principal - edição completa"
          required: true
        - id: "UC03-FA-01"
          title: "Executar dry-run antes de salvar"
          required: false
        - id: "UC03-FA-02"
          title: "Alterar valor criptografado"
          required: false
        - id: "UC03-FE-01"
          title: "Configuração somente leitura"
          required: true
        - id: "UC03-FE-02"
          title: "Validação falhou"
          required: true
        - id: "UC03-FE-03"
          title: "Sem permissão UPDATE"
          required: true

    precondicoes:
      - permissao: "SYS.CONFIGURACOES.UPDATE"

    gatilho: "Usuario clica em Editar"

    fluxo_principal:
      - passo: 1
        ator: "sistema"
        acao: "validar_permissao_update"
      - passo: 2
        ator: "sistema"
        acao: "verificar_fl_somente_leitura"
      - passo: 3
        ator: "sistema"
        acao: "carregar_configuracao_formulario"
      - passo: 4
        ator: "usuario"
        acao: "modificar_valor"
      - passo: 5
        ator: "usuario"
        acao: "clicar_salvar"
      - passo: 6
        ator: "sistema"
        acao: "validar_tipo_dado_novo_valor"
      - passo: 7
        ator: "sistema"
        acao: "criar_diff_json_valor_anterior_novo"
      - passo: 8
        ator: "sistema"
        acao: "persistir_alteracao"
      - passo: 9
        ator: "sistema"
        acao: "criar_nova_versao_historico"
      - passo: 10
        ator: "sistema"
        acao: "invalidar_cache_redis_pubsub"
      - passo: 11
        ator: "sistema"
        acao: "registrar_auditoria_sox_diff"
      - passo: 12
        ator: "sistema"
        acao: "enviar_notificacao_slack_teams_se_critica"
      - passo: 13
        ator: "sistema"
        acao: "exibir_mensagem_sucesso"

    fluxos_alternativos:
      - id: "FA-UC03-01"
        condicao: "usuario_clica_dry_run"
        resultado: "simulacao_impacto_exibida_sem_persistir"
      - id: "FA-UC03-02"
        condicao: "usuario_altera_valor_criptografado"
        resultado: "novo_valor_criptografado_azure_key_vault"

    fluxos_excecao:
      - id: "FE-UC03-01"
        condicao: "fl_somente_leitura_ativo"
        resultado: "http_403_forbidden_configuracao_protegida"
      - id: "FE-UC03-02"
        condicao: "validacao_tipo_falhou"
        resultado: "http_400_tipo_incompativel"
      - id: "FE-UC03-03"
        condicao: "sem_permissao_update"
        resultado: "http_403_acesso_negado"

    regras_aplicadas:
      - "RN-RF002-05"
      - "RN-RF002-06"
      - "RN-RF002-11"
      - "RN-RF002-12"
      - "RN-RF002-13"
      - "RN-RF002-14"

    resultado_final:
      estado: "configuracao_atualizada_versionada_cache_invalidado"

  - id: "UC04"
    nome: "Excluir Configuração"
    ator_principal: "usuario_autenticado"

    covers:
      rf_items:
        - "RF-CRUD-05"
        - "RN-RF002-11"
        - "RN-RF002-13"
      uc_items:
        - id: "UC04-FP-01"
          title: "Fluxo principal - exclusão lógica (soft delete)"
          required: true
        - id: "UC04-FA-01"
          title: "Confirmar exclusão"
          required: false
        - id: "UC04-FE-01"
          title: "Configuração somente leitura"
          required: true
        - id: "UC04-FE-02"
          title: "Sem permissão DELETE"
          required: true

    precondicoes:
      - permissao: "SYS.CONFIGURACOES.DELETE"

    gatilho: "Usuario clica em Excluir"

    fluxo_principal:
      - passo: 1
        ator: "sistema"
        acao: "validar_permissao_delete"
      - passo: 2
        ator: "sistema"
        acao: "verificar_fl_somente_leitura"
      - passo: 3
        ator: "sistema"
        acao: "exibir_modal_confirmacao"
      - passo: 4
        ator: "usuario"
        acao: "confirmar_exclusao"
      - passo: 5
        ator: "sistema"
        acao: "marcar_fl_excluido_verdadeiro"
      - passo: 6
        ator: "sistema"
        acao: "registrar_data_exclusao"
      - passo: 7
        ator: "sistema"
        acao: "invalidar_cache_redis_pubsub"
      - passo: 8
        ator: "sistema"
        acao: "registrar_auditoria_sox"
      - passo: 9
        ator: "sistema"
        acao: "exibir_mensagem_sucesso"

    fluxos_alternativos:
      - id: "FA-UC04-01"
        condicao: "usuario_cancela_confirmacao"
        resultado: "modal_fechado_sem_alteracao"

    fluxos_excecao:
      - id: "FE-UC04-01"
        condicao: "fl_somente_leitura_ativo"
        resultado: "http_403_forbidden_configuracao_protegida"
      - id: "FE-UC04-02"
        condicao: "sem_permissao_delete"
        resultado: "http_403_acesso_negado"

    regras_aplicadas:
      - "RN-RF002-11"
      - "RN-RF002-13"

    resultado_final:
      estado: "configuracao_excluida_logicamente_cache_invalidado"

  - id: "UC05"
    nome: "Executar Rollback"
    ator_principal: "usuario_autenticado"

    covers:
      rf_items:
        - "RF-FUNC-02"
        - "RN-RF002-07"
      uc_items:
        - id: "UC05-FP-01"
          title: "Fluxo principal - rollback 1-click"
          required: true
        - id: "UC05-FA-01"
          title: "Visualizar diff antes de rollback"
          required: false
        - id: "UC05-FE-01"
          title: "Sem permissão ROLLBACK"
          required: true

    precondicoes:
      - permissao: "SYS.CONFIGURACOES.ROLLBACK"

    gatilho: "Usuario clica em Rollback para versão anterior"

    fluxo_principal:
      - passo: 1
        ator: "sistema"
        acao: "validar_permissao_rollback"
      - passo: 2
        ator: "sistema"
        acao: "exibir_historico_versoes"
      - passo: 3
        ator: "usuario"
        acao: "selecionar_versao_rollback"
      - passo: 4
        ator: "sistema"
        acao: "exibir_diff_visual_versao_atual_selecionada"
      - passo: 5
        ator: "usuario"
        acao: "confirmar_rollback"
      - passo: 6
        ator: "sistema"
        acao: "restaurar_valor_versao_anterior"
      - passo: 7
        ator: "sistema"
        acao: "criar_nova_versao_historico_nao_modifica_antigas"
      - passo: 8
        ator: "sistema"
        acao: "invalidar_cache_redis_pubsub"
      - passo: 9
        ator: "sistema"
        acao: "registrar_auditoria_sox_rollback"
      - passo: 10
        ator: "sistema"
        acao: "exibir_mensagem_sucesso"

    fluxos_alternativos:
      - id: "FA-UC05-01"
        condicao: "usuario_visualiza_diff_antes"
        resultado: "diff_json_exibido_modal"

    fluxos_excecao:
      - id: "FE-UC05-01"
        condicao: "sem_permissao_rollback"
        resultado: "http_403_acesso_negado"

    regras_aplicadas:
      - "RN-RF002-07"

    resultado_final:
      estado: "configuracao_restaurada_versao_anterior"

  - id: "UC06"
    nome: "Gerenciar Feature Flags"
    ator_principal: "usuario_autenticado"

    covers:
      rf_items:
        - "RF-FUNC-04"
        - "RF-FUNC-08"
        - "RN-RF002-08"
        - "RN-RF002-15"
      uc_items:
        - id: "UC06-FP-01"
          title: "Fluxo principal - criar feature flag com rollout progressivo"
          required: true
        - id: "UC06-FA-01"
          title: "Definir estratégia percentual"
          required: false
        - id: "UC06-FA-02"
          title: "Definir estratégia por usuário"
          required: false
        - id: "UC06-FA-03"
          title: "Definir estratégia por perfil"
          required: false
        - id: "UC06-FA-04"
          title: "Definir estratégia por empresa"
          required: false
        - id: "UC06-FA-05"
          title: "Definir data expiração"
          required: false
        - id: "UC06-FE-01"
          title: "Feature flag expirada automaticamente"
          required: true
        - id: "UC06-FE-02"
          title: "Sem permissão CREATE"
          required: true

    precondicoes:
      - permissao: "SYS.CONFIGURACOES.CREATE"

    gatilho: "Usuario clica em Nova Feature Flag"

    fluxo_principal:
      - passo: 1
        ator: "sistema"
        acao: "validar_permissao_create"
      - passo: 2
        ator: "sistema"
        acao: "exibir_formulario_feature_flag"
      - passo: 3
        ator: "usuario"
        acao: "preencher_codigo_nome"
      - passo: 4
        ator: "usuario"
        acao: "marcar_fl_feature_flag"
      - passo: 5
        ator: "usuario"
        acao: "selecionar_estrategia_rollout"
      - passo: 6
        ator: "usuario"
        acao: "configurar_parametros_estrategia"
      - passo: 7
        ator: "usuario"
        acao: "definir_data_expiracao_opcional"
      - passo: 8
        ator: "usuario"
        acao: "clicar_salvar"
      - passo: 9
        ator: "sistema"
        acao: "validar_configuracao_estrategia"
      - passo: 10
        ator: "sistema"
        acao: "persistir_feature_flag"
      - passo: 11
        ator: "sistema"
        acao: "invalidar_cache_redis_pubsub"
      - passo: 12
        ator: "sistema"
        acao: "registrar_auditoria_sox"
      - passo: 13
        ator: "sistema"
        acao: "exibir_mensagem_sucesso"

    fluxos_alternativos:
      - id: "FA-UC06-01"
        condicao: "usuario_seleciona_percentual"
        resultado: "rollout_aplicado_percentual_usuarios"
      - id: "FA-UC06-02"
        condicao: "usuario_seleciona_usuario"
        resultado: "rollout_aplicado_lista_ids_usuarios"
      - id: "FA-UC06-03"
        condicao: "usuario_seleciona_perfil"
        resultado: "rollout_aplicado_apenas_perfil_selecionado"
      - id: "FA-UC06-04"
        condicao: "usuario_seleciona_empresa"
        resultado: "rollout_aplicado_lista_empresas"
      - id: "FA-UC06-05"
        condicao: "usuario_define_data_expiracao"
        resultado: "job_desabilita_automaticamente_apos_expiracao"

    fluxos_excecao:
      - id: "FE-UC06-01"
        condicao: "data_expiracao_atingida"
        resultado: "job_desabilita_flag_notifica_desenvolvedores"
      - id: "FE-UC06-02"
        condicao: "sem_permissao_create"
        resultado: "http_403_acesso_negado"

    regras_aplicadas:
      - "RN-RF002-08"
      - "RN-RF002-15"

    resultado_final:
      estado: "feature_flag_criada_rollout_progressivo_ativo"

  - id: "UC07"
    nome: "Exportar Configurações"
    ator_principal: "usuario_autenticado"

    covers:
      rf_items:
        - "RF-FUNC-05"
        - "RN-RF002-10"
      uc_items:
        - id: "UC07-FP-01"
          title: "Fluxo principal - exportação JSON/YAML"
          required: true
        - id: "UC07-FA-01"
          title: "Exportar apenas categoria específica"
          required: false
        - id: "UC07-FA-02"
          title: "Exportar apenas configurações críticas"
          required: false
        - id: "UC07-FE-01"
          title: "Sem permissão EXPORT"
          required: true

    precondicoes:
      - permissao: "SYS.CONFIGURACOES.EXPORT"

    gatilho: "Usuario clica em Exportar"

    fluxo_principal:
      - passo: 1
        ator: "sistema"
        acao: "validar_permissao_export"
      - passo: 2
        ator: "sistema"
        acao: "exibir_modal_opcoes_exportacao"
      - passo: 3
        ator: "usuario"
        acao: "selecionar_formato_json_yaml"
      - passo: 4
        ator: "usuario"
        acao: "selecionar_escopo_todas_categoria_criticas"
      - passo: 5
        ator: "usuario"
        acao: "clicar_exportar"
      - passo: 6
        ator: "sistema"
        acao: "carregar_configuracoes_filtro_selecionado"
      - passo: 7
        ator: "sistema"
        acao: "mascarar_valores_sensiveis_se_nao_super_admin"
      - passo: 8
        ator: "sistema"
        acao: "gerar_arquivo_json_yaml"
      - passo: 9
        ator: "sistema"
        acao: "registrar_auditoria_sox_exportacao"
      - passo: 10
        ator: "sistema"
        acao: "download_arquivo"

    fluxos_alternativos:
      - id: "FA-UC07-01"
        condicao: "usuario_exporta_apenas_categoria"
        resultado: "arquivo_apenas_categoria_selecionada"
      - id: "FA-UC07-02"
        condicao: "usuario_exporta_apenas_criticas"
        resultado: "arquivo_apenas_fl_critica_verdadeiro"

    fluxos_excecao:
      - id: "FE-UC07-01"
        condicao: "sem_permissao_export"
        resultado: "http_403_acesso_negado"

    regras_aplicadas:
      - "RN-RF002-10"

    resultado_final:
      estado: "arquivo_configuracoes_exportado"

  - id: "UC08"
    nome: "Importar Configurações"
    ator_principal: "usuario_autenticado"

    covers:
      rf_items:
        - "RF-FUNC-05"
        - "RN-RF002-10"
        - "RN-RF002-14"
      uc_items:
        - id: "UC08-FP-01"
          title: "Fluxo principal - importação com dry-run obrigatório"
          required: true
        - id: "UC08-FA-01"
          title: "Executar dry-run antes de aplicar"
          required: false
        - id: "UC08-FE-01"
          title: "Schema YAML inválido"
          required: true
        - id: "UC08-FE-02"
          title: "Código duplicado"
          required: true
        - id: "UC08-FE-03"
          title: "Sem permissão IMPORT"
          required: true

    precondicoes:
      - permissao: "SYS.CONFIGURACOES.IMPORT"

    gatilho: "Usuario clica em Importar"

    fluxo_principal:
      - passo: 1
        ator: "sistema"
        acao: "validar_permissao_import"
      - passo: 2
        ator: "sistema"
        acao: "exibir_modal_upload_arquivo"
      - passo: 3
        ator: "usuario"
        acao: "upload_arquivo_json_yaml"
      - passo: 4
        ator: "sistema"
        acao: "validar_schema_yaml_json"
      - passo: 5
        ator: "sistema"
        acao: "executar_dry_run_obrigatorio"
      - passo: 6
        ator: "sistema"
        acao: "exibir_relatorio_impacto_dry_run"
      - passo: 7
        ator: "usuario"
        acao: "confirmar_importacao"
      - passo: 8
        ator: "sistema"
        acao: "aplicar_configuracoes_arquivo"
      - passo: 9
        ator: "sistema"
        acao: "invalidar_cache_redis_pubsub"
      - passo: 10
        ator: "sistema"
        acao: "registrar_auditoria_sox_importacao_completa"
      - passo: 11
        ator: "sistema"
        acao: "exibir_mensagem_sucesso"

    fluxos_alternativos:
      - id: "FA-UC08-01"
        condicao: "usuario_revisa_dry_run"
        resultado: "relatorio_impacto_detalhado_exibido"

    fluxos_excecao:
      - id: "FE-UC08-01"
        condicao: "schema_yaml_invalido"
        resultado: "http_400_schema_validation_error"
      - id: "FE-UC08-02"
        condicao: "codigo_duplicado_dry_run"
        resultado: "importacao_bloqueada_exibir_conflitos"
      - id: "FE-UC08-03"
        condicao: "sem_permissao_import"
        resultado: "http_403_acesso_negado"

    regras_aplicadas:
      - "RN-RF002-10"
      - "RN-RF002-14"

    resultado_final:
      estado: "configuracoes_importadas_validadas_aplicadas"

  - id: "UC09"
    nome: "Descriptografar Valor Sensível"
    ator_principal: "super_admin"

    covers:
      rf_items:
        - "RN-RF002-02"
        - "RN-RF002-09"
      uc_items:
        - id: "UC09-FP-01"
          title: "Fluxo principal - visualizar valor descriptografado"
          required: true
        - id: "UC09-FE-01"
          title: "Sem permissão DECRYPT"
          required: true

    precondicoes:
      - permissao: "SYS.CONFIGURACOES.DECRYPT"
      - perfil: "Super Admin"

    gatilho: "Super Admin clica em Visualizar Valor Descriptografado"

    fluxo_principal:
      - passo: 1
        ator: "sistema"
        acao: "validar_permissao_decrypt"
      - passo: 2
        ator: "sistema"
        acao: "validar_perfil_super_admin"
      - passo: 3
        ator: "sistema"
        acao: "carregar_configuracao_criptografada"
      - passo: 4
        ator: "sistema"
        acao: "descriptografar_azure_key_vault_aes256gcm"
      - passo: 5
        ator: "sistema"
        acao: "exibir_valor_claro_modal_seguro"
      - passo: 6
        ator: "sistema"
        acao: "registrar_auditoria_sox_acesso_sensivel"

    fluxos_excecao:
      - id: "FE-UC09-01"
        condicao: "sem_permissao_decrypt"
        resultado: "http_403_acesso_negado"

    regras_aplicadas:
      - "RN-RF002-02"
      - "RN-RF002-09"

    resultado_final:
      estado: "valor_descriptografado_exibido_auditado"

exclusions:
  uc_items: []

historico:
  - versao: "1.0"
    data: "2025-12-29"
    autor: "Agência ALC - alc.dev.br"
    descricao: "Versão inicial - 10 UCs canônicos cobrindo 100% do RF-002 (15 regras de negócio)"
