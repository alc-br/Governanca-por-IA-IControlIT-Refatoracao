# RF-082: Gestão de Documentos de Responsabilidade Corporativa

**Versão**: 2.0
**Data**: 2025-12-30
**Autor**: Agência ALC - alc.dev.br
**EPIC**: EPIC008-SD-Service-Desk
**Fase**: Fase 5 - Service Desk (Operações, Governance e Conformidade)

---

## 1. OBJETIVO DO REQUISITO

Descrever de forma clara, objetiva e verificável o comportamento esperado do **Módulo de Gestão de Documentos de Responsabilidade Corporativa** (RF-082), servindo como **contrato oficial** entre negócio, desenvolvimento, testes e agentes de IA.

Este módulo permite que organizações gerenciem documentos normativos críticos (Códigos de Conduta, NDAs, Contratos de Responsabilidade, Termos de Confidencialidade, Acordos de Nível de Serviço Internos, Regulamentações Internas e Compliance Corporativo) com versionamento automático, workflow de aprovação configurável, aceite obrigatório rastreado, assinaturas digitais certificadas, integração com RH e dashboard de compliance em tempo real.

**Importância Estratégica**:
- **Conformidade Regulatória**: Atende LGPD (Art. 8), SOX (seções 302 e 906), ISO 27001 (A.6.1, A.7.2), ITIL v4 (Service Design)
- **Proteção Legal**: Documenta consentimento informado com prova irrefutável (timestamp, IP, assinatura digital)
- **Mitigação de Risco**: Detecta automaticamente colaboradores sem aceites críticos
- **Governança Corporativa**: Centraliza definição de normas, elimina documentos contraditórios
- **Rastreabilidade E2E**: Auditoria completa de quem leu, quando aceitou, qual versão, de qual IP
- **Integração com RH**: Sincroniza aceites com eventos de ciclo de vida (admissão, promoção, desligamento)
- **Assinatura Certificada**: Suporte a assinatura digital com validade jurídica (ICP-Brasil, eIDAS)
- **Eficiência Operacional**: Automatiza coleta de aceites, elimina processos manuais

Este documento **não define implementação**, apenas **o que o sistema deve fazer**, sob quais condições e quais garantias devem ser preservadas.

---

## 2. ESCOPO

### 2.1 O que está dentro do escopo

- [x] Criação de documentos de responsabilidade com versionamento automático
- [x] Atualização de documentos em estado "Elaboração" ou "Revisão"
- [x] Listagem de documentos com filtros (categoria, status, data de publicação)
- [x] Exclusão lógica de documentos obsoletos
- [x] Validações funcionais: campos obrigatórios, transições de estado
- [x] Workflow de aprovação multinível configurável
- [x] Aceite obrigatório bloqueante com rastreamento (IP, User-Agent, dispositivo)
- [x] Rejeição de documentos com justificativa
- [x] Revogação de aceites (desligamento, violação)
- [x] Assinatura digital integrada (DocuSign API, ICP-Brasil A1/A3)
- [x] Comprovantes digitais certificados (PDF com hash SHA-256)
- [x] Notificações automáticas multicanal (email, SMS, in-app SignalR)
- [x] Busca full-text com ElasticSearch
- [x] Dashboard de compliance corporativo em tempo real
- [x] Integração com RH (Microsoft Graph, Azure AD)
- [x] Matriz de responsabilidade (documentos x públicos-alvo)
- [x] Relatórios de auditoria com evidências
- [x] Controle de acesso e isolamento por tenant (multi-tenancy)
- [x] Auditoria de operações (retenção 5 anos)
- [x] Internacionalização (i18n) com 3 idiomas (pt-BR, en-US, es-ES)

### 2.2 Fora do escopo (não objetivos)

- Interface visual específica (responsabilidade do frontend Angular)
- Tecnologia, framework ou linguagem (definido em PADROES-CODIFICACAO-BACKEND.md)
- Layout, UX ou identidade visual (responsabilidade do Fuse Template)
- Estratégia de deploy ou infraestrutura (Azure DevOps pipelines)
- Migração de dados do sistema legado (tratado em RL-RF082.md)
- Implementação de certificado digital interno (usar serviços de terceiros: DocuSign, ICP-Brasil)

---

## 3. CONCEITOS E DEFINIÇÕES

| Termo | Definição |
|-------|-----------|
| **Documento de Responsabilidade** | Documento normalizado que define direitos, obrigações e responsabilidades (ex: "Código de Conduta", "NDA", "Termo de Confidencialidade"). Possui versões sequenciais (v1.0, v1.1, v2.0), estados (Elaboração → Revisão → Aprovada → Publicada → Obsoleta), categorias (Conduta, Confidencialidade, Responsabilidade, Legal, Compliance, RH), armazenado em Azure Blob Storage (PDF original + metadados). |
| **Aceite de Documento** | Ato de um colaborador reconhecer e concordar com documento de responsabilidade. Obrigatório para acesso a funcionalidades/áreas. Rastreado com timestamp, IP, User-Agent, dispositivo, localização. Pode incluir assinatura digital certificada. Gera evento de auditoria imutável. |
| **Workflow de Aprovação** | Sequência configurável de etapas (Elaboração → Revisão Legal → Aprovação Compliance → Publicação). Cada etapa requer aprovação de perfis/usuários específicos. Aprovadores recebem notificação automática (email, in-app SignalR). Cada aprovação registra comentários auditáveis. |
| **Matriz de Responsabilidade** | Mapeamento entre documentos (linhas) e públicos-alvo (colunas: Diretores, Gerentes, Técnicos, Operacional, Parceiros). Indica quem deve aceitar qual documento. Suporta regras complexas (ex: "Gerentes de TI devem aceitar Código de Segurança"). |
| **Comprovante de Aceite Digital** | PDF certificado que prova aceite de responsabilidade. Contém: documento original, data/hora de aceite, dados do aceitante, assinatura digital (hash SHA-256). Validade jurídica (certificado ICP-Brasil). Retenção: mínimo 5 anos (SOX, LGPD, ISO 27001). |
| **Auditoria de Aceite** | Registro imutável de todas as ações relacionadas a documentos (quando aceito/rejeitado/revogado, qual versão, IP, User-Agent, dispositivo, localização, motivo). Integrado com RF-095 (Auditoria de Acesso) e RF-096 (Auditoria de Mudanças). |
| **Revogação de Aceite** | Cancelamento de aceite anterior (casos: colaborador desligado, violação de confidencialidade). Requer aprovador específico. Gera auditoria completa. Pode bloquear acesso a áreas restritas. |
| **Tenant** | Unidade lógica de isolamento de dados. Cada cliente (empresa) possui seu próprio tenant. Documentos de responsabilidade são isolados por ClienteId (multi-tenancy). |
| **Operação** | Ação executável sobre documentos: Criar, Atualizar, Publicar, Aceitar, Rejeitar, Revogar, Gerar Comprovante, Excluir. Cada operação exige permissão explícita (RBAC). |

---

## 4. FUNCIONALIDADES COBERTAS

1. **Criar Documento de Responsabilidade** - Criar novo documento com título, descrição, conteúdo, categoria, público-alvo. Estado inicial: "Elaboração". Versão inicial: v1.0.
2. **Atualizar Documento** - Editar documentos em estado "Elaboração" ou "Revisão". Incrementa versão automaticamente (v1.0 → v1.1 → v2.0). Registra mudanças no histórico imutável.
3. **Consultar Documento por ID** - Obter documento específico com metadados completos (título, versão, status, categoria, data de publicação, workflow de aprovação, aceites).
4. **Listar Documentos** - Listar documentos com paginação, filtros (categoria, status, data de publicação), ordenação. Suporta busca full-text via ElasticSearch.
5. **Excluir Documento** - Exclusão lógica (estado "Obsoleta"). Documentos publicados com aceites não podem ser excluídos permanentemente.
6. **Publicar Documento** - Publicar documento após aprovação multinível. Notifica automaticamente usuários/departamentos que devem aceitar (email, SMS, in-app).
7. **Workflow de Aprovação Configurável** - Definir etapas (elaboração → revisão → aprovação → publicação) com papéis e aprovadores específicos. Cada etapa requer aprovação.
8. **Aceitar Documento** - Registrar aceite obrigatório com rastreamento (timestamp, IP, User-Agent, dispositivo, localização). Gera comprovante digital certificado (hash SHA-256).
9. **Rejeitar Documento** - Registrar rejeição com justificativa. Não bloqueia acesso (administrador precisa reagir).
10. **Revogar Aceite** - Cancelar aceite anterior (desligamento, violação). Requer aprovador específico. Gera auditoria completa.
11. **Assinatura Digital Integrada** - Integrar com DocuSign API para assinatura certificada (ICP-Brasil A1/A3). Gera PDF assinado com validade jurídica.
12. **Comprovante Digital Certificado** - Gerar PDF certificado com hash SHA-256, timestamp, assinatura. Armazenar em Azure Blob Storage. Retenção: 5 anos.
13. **Notificações Automáticas Multicanal** - Enviar notificações (email via SendGrid, SMS via Twilio, in-app via SignalR) quando documento é publicado, prazo próximo, aceite pendente.
14. **Busca Full-Text** - Indexar documentos no ElasticSearch. Buscar por palavra-chave, categoria, data, versão. Suporta busca facetada (filtros combinados).
15. **Dashboard de Compliance** - Dashboard interativo mostrando taxa de aceites por documento, departamento, usuário. Identifica gaps de conformidade, usuários não-conformes.
16. **Integração com RH** - Sincronizar com Microsoft Graph (Azure AD) para obrigar aceites em eventos de ciclo de vida: novo colaborador deve aceitar Código de Conduta no primeiro login; promovido deve aceitar documentos do novo cargo; desligado tem todos os aceites revogados.
17. **Matriz de Responsabilidade** - Mapeamento entre documentos e públicos-alvo com regras complexas (ex: "Fornecedores devem aceitar NDA"). Facilita identificar gaps de aceites.
18. **Relatórios de Auditoria** - Gerar relatórios de evidências (quem leu, aceitou, rejeitou, revogou cada documento). Exportável em PDF/Excel.
19. **Versionamento e Histórico** - Manter histórico completo de alterações (quando, quem, o que mudou). Suporta diff visual, rollback.
20. **Gestão de Exceções** - Autorizar usuário específico a não aceitar documento por período determinado (ex: férias, licença médica).

---

## 5. REGRAS DE NEGÓCIO

### RN-DOC-082-01 — Versionamento Automático de Documentos

**Descrição**: Cada alteração em um documento em estado "Elaboração" ou "Revisão" incrementa automaticamente o número de versão (v1.0 → v1.1 → v2.0) e cria registro histórico imutável com timestamp, usuário e campo alterado.

**Justificativa**: SOX (Seção 302), LGPD (Art. 8) e ISO 27001 (A.6.1) exigem rastreabilidade completa. Sem versionamento, é impossível provar qual versão um colaborador aceitou e em que data.

**Critério de Aceite**:
- Documento criado com v1.0 em 2025-01-01
- Alteração no conteúdo em 2025-01-05 → v1.1
- Alteração significativa em 2025-01-15 → v2.0
- Colaborador aceita v2.0 em 2025-01-16 → comprovante registra v2.0
- Histórico mostra todas as versões com data, usuário, campos alterados

---

### RN-DOC-082-02 — Aceite Obrigatório Bloqueante

**Descrição**: Usuário não pode acessar sistema completo ou funcionalidades restritas sem aceitar documentos de responsabilidade vigentes. Sistema exibe overlay bloqueante com documento integralizado em modal e opção de aceitar/rejeitar.

**Justificativa**: LGPD (Art. 8) exige consentimento livre, informado e inequívoco. Documentar que usuário foi explicitamente informado e concordou, com prova de IP, data/hora e dispositivo.

**Critério de Aceite**:
- Usuário autentica com sucesso
- Sistema verifica se há documentos pendentes para aceite
- Se há documentos pendentes: exibe modal bloqueante com documento integralizado
- Usuário deve clicar "Li e concordo" (checkbox) antes de aceitar
- Após aceite: sistema registra DataAceite, IpAddress, UserAgent, Dispositivo
- Usuário sem aceite não consegue acessar rotas protegidas (HTTP 403)
- Rotas de login, logout, aceitar documento são isentas de bloqueio

---

### RN-DOC-082-03 — Workflow de Aprovação Multinível Configurável

**Descrição**: Documento publicado deve percorrer workflow de aprovação com etapas configuráveis (elaboração → revisão → aprovação → publicação). Cada etapa requer aprovação de um ou mais usuários com perfil específico.

**Justificativa**: Governança corporativa exige revisão por múltiplas áreas (Legal, Compliance, Diretoria) antes de publicar documento que afete colaboradores.

**Critério de Aceite**:
- Documento criado em "Elaboração" (etapa 1)
- Autor envia para "Revisão Legal" (etapa 2)
- Sistema notifica aprovador com perfil "Legal Manager"
- Legal Manager aprova com comentários
- Sistema avança para "Aprovação Compliance" (etapa 3)
- Compliance Manager aprova
- Sistema publica documento (estado "Publicada", DataPublicacao = now)
- Se etapa rejeitada: documento retorna para elaboração
- Se etapa sem aprovador disponível: sistema não permite avançar

---

### RN-DOC-082-04 — Assinatura Digital com Validade Jurídica

**Descrição**: Aceite pode ser assinado digitalmente utilizando certificado ICP-Brasil (A1/A3) ou via DocuSign API, gerando PDF com hash SHA-256 que possui validade jurídica para defesa em processo.

**Justificativa**: Lei 14.063/2020 (assinatura eletrônica) e Lei 13.709/2018 (LGPD) exigem comprovação irrefutável de consentimento. Assinatura digital certificada transforma documento em prova judicial admissível.

**Critério de Aceite**:
- Usuário clica "Assinar Digitalmente"
- Sistema prepara PDF para assinatura (documento + metadados)
- Sistema envia envelope via DocuSign API
- Usuário recebe email da DocuSign com link para assinar
- Usuário assina com certificado A1/A3
- DocuSign retorna envelope assinado com certificado
- Sistema armazena DocumentoAceite.DocuSignEnvelopeId
- Sistema gera comprovante certificado com hash SHA-256
- Comprovante possui validade jurídica (certificado ICP-Brasil)

---

### RN-DOC-082-05 — Integração com RH - Ciclo de Vida de Colaboradores

**Descrição**: Sistema sincroniza automaticamente com RH (Microsoft Graph, Azure AD) para obrigar aceites em eventos de ciclo de vida: novo colaborador deve aceitar Código de Conduta no primeiro login; promovido deve aceitar documentos do novo cargo; desligado tem todos os aceites revogados.

**Justificativa**: Eficiência operacional: evita processos manuais de enviar emails para aceitar. Compliance: garante que nenhum colaborador acessa sistema sem ter aceito documentos obrigatórios.

**Critério de Aceite**:
- Novo colaborador João é criado no Azure AD
- Sistema detecta evento de criação via Microsoft Graph webhook
- Sistema cria DocumentoAceites para todos os documentos com FlNovoColaborador = true
- João faz primeiro login → sistema exibe modal bloqueante com documentos obrigatórios
- João é promovido de "Analista" para "Gerente" → sistema cria novos aceites para documentos de cargo "Gerente"
- João é desligado → sistema revoga todos os aceites ativos (DataRevogacao = now, FlRevogado = true, MotivoRevogacao = "Desligamento")

---

### RN-DOC-082-06 — Notificação Automática Multicanal

**Descrição**: Quando documento é publicado, sistema notifica automaticamente usuários/departamentos que devem aceitar via email (SendGrid), SMS (Twilio) e in-app (SignalR). Notificações incluem link direto para documento e prazo de aceite.

**Justificativa**: Eficiência: evita coordenação manual de avisos. Compliance: documenta que notificação foi enviada (evidência em auditoria). Engajamento: múltiplos canais aumentam taxa de aceite.

**Critério de Aceite**:
- Documento publicado em 2025-01-01
- Sistema identifica usuários que devem aceitar (por perfil, cargo, departamento, empresa, ou "todos")
- Para cada usuário: sistema cria DocumentoAceite (FlObrigatorio = true, DataPrazoAceite = DataPublicacao + 10 dias)
- Sistema envia email via SendGrid com link direto: `https://icontrol.com/documentos/{id}/aceitar`
- Sistema envia SMS via Twilio (se telefone disponível): "IControl: Você deve aceitar '{titulo}' v{versao}. Acesse: https://icontrol.com/doc/{id}"
- Sistema envia notificação in-app via SignalR Hub: evento "DocumentoPublicado" com metadados
- Sistema registra envio de notificações em auditoria

---

### RN-DOC-082-07 — Comprovante Digital Certificado com Retenção Obrigatória

**Descrição**: Cada aceite gera comprovante PDF certificado (hash SHA-256, timestamp, assinatura) válido judicialmente. Retenção mínima de 5 anos conforme SOX, LGPD, ISO 27001.

**Justificativa**: Defesa legal: comprovante com hash SHA-256 não pode ser falsificado. Conformidade: SOX Seção 302 exige retenção de documentação. LGPD Art. 8 exige comprovação de consentimento.

**Critério de Aceite**:
- Usuário aceita documento em 2025-01-01 10:30:00
- Sistema gera PDF com: documento original, data/hora de aceite, dados do aceitante, assinatura digital (hash SHA-256)
- Hash SHA-256 = SHA256(DocumentoId + UsuarioId + DataAceite + IpAddress)
- Sistema armazena PDF em Azure Blob Storage: `comprovantes/{documentoId}/{aceiteId}_{timestamp}.pdf`
- Sistema registra ComprovanteBlobUri, ComprovanteSha256, DataGeracaoComprovante em DocumentoAceite
- Comprovante possui validade jurídica (certificado ICP-Brasil)
- Retenção: mínimo 5 anos (política automática em Blob Storage)

---

### RN-DOC-082-08 — Busca Full-Text com ElasticSearch

**Descrição**: Documentos são indexados automaticamente no ElasticSearch para busca rápida por palavra-chave, categoria, data, versão. Suporta busca facetada (filtros combinados).

**Justificativa**: Performance: LIKE %texto% em SQL Server é lento com grandes volumes. ElasticSearch indexa full-text, oferecendo relevância e faceted search. Usabilidade: colaboradores encontram rapidamente documentos que precisam aceitar.

**Critério de Aceite**:
- Documento publicado em 2025-01-01
- Sistema indexa automaticamente no ElasticSearch (índice: `documentos-responsabilidade`)
- Usuário busca "Confidencialidade" → ElasticSearch retorna hits com relevância ordenados
- Usuário aplica facetas: Categoria="Confidencialidade", DataPublicacao="Últimos 30 dias"
- Sistema retorna resultados filtrados
- Busca suporta fuzzy matching (tolerância a erros de digitação)
- Agregações mostram contadores por categoria, status, versão

---

### RN-DOC-082-09 — Dashboard de Compliance em Tempo Real

**Descrição**: Dashboard interativo mostra taxa de aceites por documento, departamento e usuário. Identifica gaps de conformidade, usuários recorrentemente não-conformes, documentos com baixa taxa de aceite.

**Justificativa**: Governança: executivos visualizam saúde de compliance corporativo. Ação corretiva: identificar rapidamente departamentos que não estão aceitando documentos.

**Critério de Aceite**:
- Dashboard exibe KPIs em tempo real:
  - Taxa de Compliance Geral: (Total de aceites / Total de aceites esperados) * 100 > 95%
  - Compliance por Documento: Taxa de aceite por documento > 90%
  - Compliance por Departamento: Taxa de aceite por departamento > 85%
  - Usuários Não-Conformes: Usuários com > 5 documentos pendentes
- Dashboard exibe alertas:
  - "Documento 'Código de Conduta' tem apenas 45% de aceite"
  - "Departamento 'TI' tem 12 usuários não-conformes"
  - "Usuário João Silva não aceitou 5 documentos obrigatórios"
- Dashboard atualiza em tempo real via SignalR quando aceite é registrado

---

### RN-DOC-082-10 — Auditoria Completa com Retenção

**Descrição**: Todas as ações relacionadas a documentos e aceites são registradas em tabela Auditoria: criar documento, editar, publicar, aceitar, rejeitar, revogar. Cada registro inclui usuário, data/hora, IP, dispositivo, mudanças (before/after).

**Justificativa**: Conformidade regulatória (LGPD Art. 8, SOX Seção 302, ISO 27001 A.12.4.1). Investigação de incidentes: rastrear quem fez o quê quando.

**Critério de Aceite**:
- Usuário cria documento em 2025-01-01 10:00:00
- Sistema registra em Auditoria: EntityType="Documento", Acao="CREATE", UsuarioId, IpAddress, UserAgent, Dispositivo, ValoresAntigos=null, ValoresNovos={documento JSON}
- Usuário edita documento em 2025-01-01 11:00:00 (altera Titulo de "Antigo" para "Novo")
- Sistema registra em Auditoria: Acao="UPDATE", ValoresAntigos={"Titulo":"Antigo"}, ValoresNovos={"Titulo":"Novo"}
- Usuário aceita documento em 2025-01-01 12:00:00
- Sistema registra em Auditoria: EntityType="DocumentoAceite", Acao="ACEITAR", IpAddress, UserAgent, Dispositivo
- Retenção: mínimo 5 anos (constraint CK_Auditoria_Retencao: CriadoEm >= DATEADD(YEAR, -5, GETUTCDATE()))

---

## 6. ESTADOS DA ENTIDADE

### Estados de Documento de Responsabilidade

| Estado | Descrição |
|--------|-----------|
| **Elaboracao** | Documento criado, em edição. Pode ser alterado livremente. Não visível para usuários finais. |
| **Revisao** | Documento em revisão por área específica (Legal, Compliance). Pode ser alterado com aprovação. |
| **Aprovada** | Documento aprovado por todas as etapas do workflow. Pronto para publicação. |
| **Publicada** | Documento publicado e visível para usuários. Gera aceites obrigatórios. Não pode ser editado. |
| **Obsoleta** | Documento descontinuado. Não exige novos aceites. Histórico preservado. |

### Transições Permitidas

| De | Para | Condição |
|----|------|----------|
| Elaboracao | Revisao | Usuário envia para revisão |
| Revisao | Aprovada | Aprovador aprova |
| Aprovada | Publicada | Usuário publica |
| Publicada | Obsoleta | Administrador marca como obsoleto |
| Revisao | Elaboracao | Aprovador rejeita |

---

## 7. EVENTOS DE DOMÍNIO

| Evento | Quando ocorre | Dados Publicados |
|--------|---------------|------------------|
| `documento.criado` | Após criação de documento | DocumentoId, Titulo, Versao, CriadoPor, CriadoEm |
| `documento.atualizado` | Após atualização de documento | DocumentoId, Versao, CamposAlterados, AlteradoPor, AlteradoEm |
| `documento.publicado` | Após publicação de documento | DocumentoId, Titulo, Versao, DataPublicacao, PublicadoPor |
| `documento.aceito` | Após aceite de documento | DocumentoId, UsuarioId, DataAceite, IpAddress, Dispositivo |
| `documento.rejeitado` | Após rejeição de documento | DocumentoId, UsuarioId, MotivoRejeicao, DataRejeicao |
| `documento.revogado` | Após revogação de aceite | DocumentoId, UsuarioId, MotivoRevogacao, RevogadoPor, DataRevogacao |
| `comprovante.gerado` | Após geração de comprovante | DocumentoId, AceiteId, ComprovanteBlobUri, ComprovanteSha256 |
| `documento.excluido` | Após exclusão lógica de documento | DocumentoId, DeletadoPor, DataExclusao |

---

## 8. CRITÉRIOS GLOBAIS DE ACEITE

- Nenhuma operação pode violar isolamento de tenant (ClienteId)
- Nenhuma regra de negócio pode ser ignorada
- Erros devem ser previsíveis e rastreáveis (códigos HTTP + mensagens estruturadas)
- Auditoria deve registrar quem, quando e o que mudou (retenção 5 anos)
- Documentos publicados não podem ser editados (imutabilidade)
- Aceites devem ser rastreados com IP, User-Agent, dispositivo, localização
- Comprovantes devem ter hash SHA-256 para garantir integridade
- Notificações devem ser enviadas via múltiplos canais (email, SMS, in-app)
- Dashboard deve atualizar em tempo real via SignalR
- Busca deve retornar resultados em < 500ms (ElasticSearch)

---

## 9. SEGURANÇA

- **Validação de entrada obrigatória**: FluentValidation em todos os Commands/Queries
- **Proteção contra injeção**: EF Core LINQ (parametrized queries), ElasticSearch DSL
- **Controle de permissões**: RBAC com permissões explícitas (`doc:responsabilidade:create`, `doc:responsabilidade:aceitar`, etc.)
- **Isolamento multi-tenant**: Query filters EF Core (`ClienteId`), Row-Level Security (RLS)
- **HTTPS/TLS 1.3**: Todas as comunicações criptografadas
- **Autenticação OAuth 2.0 + OIDC**: Azure AD, suporte a MFA
- **Rate Limiting**: Máximo 100 requisições/min por usuário
- **XSS Protection**: Angular sanitizer, Content Security Policy headers
- **CSRF Protection**: Anti-forgery tokens em formulários POST
- **Hash SHA-256**: Comprovantes não podem ser falsificados
- **Versionamento Imutável**: Histórico não pode ser alterado (insert-only)
- **Assinatura Digital**: Certificado ICP-Brasil (A1/A3), validade jurídica
- **Audit Log**: Imutável, retenção 5 anos

---

## 10. ARTEFATOS DERIVADOS

Este RF é base para:

- **UC-RF082.md** (Casos de Uso) - 5 casos de uso obrigatórios (UC00-UC04): Listar Documentos, Criar Documento, Visualizar Documento, Editar Documento, Excluir Documento
- **MD-RF082.md** (Modelo de Dados) - DDL completo com auditoria e multi-tenancy
- **WF-RF082.md** (Wireframes e Fluxos) - Telas, estados, componentes
- **TC-RF082-BACKEND.yaml** (Casos de Teste Backend) - Testes de API REST
- **TC-RF082-FRONTEND.yaml** (Casos de Teste Frontend) - Testes de UI Angular
- **TC-RF082-SEGURANCA.yaml** (Casos de Teste Segurança) - Testes de SQL Injection, XSS, CSRF
- **TC-RF082-E2E.yaml** (Casos de Teste E2E) - Testes de fluxo completo com Playwright
- **user-stories.yaml** - User Stories implementáveis (mínimo 2 stories)

---

## 11. RASTREABILIDADE

| Artefato | Gerado | Obrigatório |
|----------|--------|-------------|
| Casos de Uso (UC-RF082.md) | Sim | ✅ |
| Modelo de Dados (MD-RF082.md) | Sim | ✅ |
| Wireframes e Fluxos (WF-RF082.md) | Sim | ✅ |
| Casos de Teste Backend (TC-RF082-BACKEND.yaml) | Sim | ✅ |
| Casos de Teste Frontend (TC-RF082-FRONTEND.yaml) | Sim | ✅ |
| Casos de Teste Segurança (TC-RF082-SEGURANCA.yaml) | Sim | ✅ |
| Casos de Teste E2E (TC-RF082-E2E.yaml) | Sim | ✅ |
| User Stories (user-stories.yaml) | Sim | ✅ |
| Referências ao Legado (RL-RF082.md) | Sim | ✅ |

---

## CHANGELOG

| Versão | Data | Descrição | Autor |
|--------|------|-----------|-------|
| 2.0 | 2025-12-30 | Versão canônica orientada a contrato. Separação completa RF/RL. Remoção de código legado. 11 seções obrigatórias. Mínimo 10 regras de negócio. | Agência ALC - alc.dev.br |
| 1.0 | 2025-12-28 | Versão inicial (continha conteúdo legado misturado - migrado para RL-RF082.md) | Claude Code |

---

**Última Atualização**: 2025-12-30
**Autor**: Agência ALC - alc.dev.br
**Revisão**: Pendente
