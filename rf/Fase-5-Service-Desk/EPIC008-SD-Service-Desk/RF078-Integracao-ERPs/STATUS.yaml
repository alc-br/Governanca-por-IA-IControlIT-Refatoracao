rf: RF078
fase: Fase-5-Service-Desk
epic: EPIC008-SD-Service-Desk
titulo: Integração com ERPs

# ============================================================
# 1. SKELETON / BASE ATUAL
# ============================================================
skeleton:
  criado: False
  data_criacao: null
  observacao: "Documentação RF/RL v2.0 criada. Backend/Frontend ainda não iniciados."

# ============================================================
# 2. DOCUMENTACAO (CONTRATOS)
# ============================================================
documentacao:
  rf: True                # RF078.md criado (contrato moderno v2.0)
  rf_yaml: True           # RF078.yaml criado (estruturado)
  rl: True                # RL-RF078.md criado (memória legado)
  rl_yaml: True           # RL-RF078.yaml criado (rastreabilidade 100%)
  uc: False               # UC-RF078.md ainda não criado
  uc_yaml: False
  md: False               # MD-RF078.md ainda não criado
  md_yaml: False
  wf: False               # WF-RF078.md ainda não criado
  tc: False               # TC ainda não criados

  arquivos_obrigatorios_presentes: True
  separacao_rf_rl_validada: True

# ==============================================================================
# VALIDAÇÃO SEPARAÇÃO RF/RL (OBRIGATÓRIA v2.0)
# ==============================================================================

separacao_rf_rl:
  rf_limpo: True                # RF não contém conteúdo legado
  rl_completo: True             # RL contém TODA memória legado
  itens_com_destino: True       # 100% itens RL têm campo destino
  validador_executado: True     # validator-rl.py passou com sucesso (exit code 0)

# ==============================================================================
# ESTATÍSTICAS DOCUMENTAÇÃO
# ==============================================================================

estatisticas:
  total_rns: 10                 # Regras de negócio extraídas
  total_endpoints_api: 13       # Endpoints REST documentados
  total_permissoes_rbac: 7      # Permissões RBAC definidas
  total_integracoes_obrigatorias: 7  # i18n, auditoria, RBAC, Multi-tenancy, SAP, TOTVS, Oracle, Azure Service Bus
  itens_legado_rastreados: 18   # Itens em RL-RF078.yaml
  bancos_legados_mapeados: 0    # Bancos SQL Server antigos (não aplicável - multi-database por cliente)
  problemas_legado_identificados: 7  # Problemas documentados

# ============================================================
# 3. DESENVOLVIMENTO
# ============================================================
desenvolvimento:
  backend:
    status: not_started   # not_started | skeleton | in_progress | done
    branch: null
  frontend:
    status: not_started
    branch: null

# ============================================================
# 4. TESTES (RESULTADO)
# ============================================================
testes:
  backend: not_run        # not_run | pass | fail
  frontend: not_run
  e2e: not_run
  seguranca: not_run

# ============================================================
# 5. DOCUMENTACAO DE TESTES
# ============================================================
documentacao_testes:
  backend: False
  frontend: False
  e2e: False
  seguranca: False

# ============================================================
# 6. TESTES TI / QA
# ============================================================
testes_ti:
  backend: not_run
  frontend: not_run
  e2e: not_run
  seguranca: not_run

testes_qa:
  executado: False
  aprovado: False

# ============================================================
# 7. SINCRONIZACAO COM AZURE DEVOPS
# ============================================================
devops:
  work_item_id: null            # Feature / Epic principal
  test_plan_id: null
  last_sync: null
  board_column: "Backlog"
  sync_policy:
    create_user_story_if_missing: True
    update_status_from_yaml: True
    update_sprint_from_yaml: True
    close_work_item_on_done: True

# ============================================================
# 8. GOVERNANCA E CONTRATOS
# ============================================================
governanca:
  contrato_ativo: "Migração v1.0 → v2.0 (separação RF/RL completa)"
  ultimo_manifesto: null
  versao_governanca: "2.0"
  data_migracao: "2025-12-30"
  regras:
    - "RF e RL devem estar separados"
    - "RF não pode conter referências ao legado"
    - "RL deve ter 100% dos itens com destino definido"
    - "Validador deve passar antes de avançar para UC"

# ============================================================
# 9. OBSERVACOES GERAIS
# ============================================================
observacoes:
  - "RF078.md v2.0: Requisito Funcional moderno (11 seções, 10 RNs)"
  - "RF078.yaml: Estrutura canônica sincronizada com RF.md"
  - "RL-RF078.md: Referência ao Legado (18 itens mapeados, 100% destinos)"
  - "RL-RF078.yaml: Rastreabilidade estruturada (4 assumidos, 13 substituídos, 1 descartado)"
  - "Próximo passo: Executar validator-rl.py e criar UC (CONTRATO-DOCUMENTACAO-ESSENCIAL)."

validacoes:
  rf_uc_cobertura_total: False
  uc_md_consistente: False
  uc_wf_consistente: False
  rf_yaml_sincronizado: True
  uc_yaml_sincronizado: False

# ==============================================================================
# DETALHAMENTO DA MIGRAÇÃO v2.0
# ==============================================================================

migracao_v2:
  data_inicio: "2025-12-30"
  data_conclusao: "2025-12-30"
  arquivos_criados:
    - "RF078.md (v2.0 - 11 seções, 10 RNs)"
    - "RF078.yaml (sincronizado 100%)"
    - "RL-RF078.md (18 itens legado rastreados)"
    - "RL-RF078.yaml (100% destinos definidos)"

  analise_legado:
    telas_aspx: 4
    webservices: 4
    tabelas: 3
    jobs_batch: 1
    regras_implicitas: 6

  destinos_legado:
    assumido: 4
    substituido: 13
    descartado: 1
    a_revisar: 0
    cobertura: "100%"

  problemas_legado:
    criticos: 2  # Senhas em texto plano, Sem retry automático
    altos: 3     # Polling 24h, Sem deduplicação, Sem validação schema
    medios: 2    # Reconciliação 100% manual, Logs não estruturados

  melhorias_modernizacao:
    - "Webhooks em tempo real (latência 24h → < 5 min)"
    - "Retry automático com backoff exponencial (5 tentativas)"
    - "Azure Key Vault para credenciais (elimina texto plano)"
    - "Deduplicação por MessageId UUID (previne duplicatas)"
    - "Validação obrigatória de schema (JSON Schema v7 / XSD)"
    - "Dashboard real-time com Angular (visibilidade operacional)"
    - "Auditoria estruturada com retenção 7 anos (conformidade LGPD)"
    - "Reconciliação automática 95% (tolerância configurável 0,5%)"
    - "Multi-tenancy com Row-Level Security (reduz custo infraestrutura)"
    - "Validação de período contábil (evita erros contábeis)"

# ==============================================================================
# PENDÊNCIAS
# ==============================================================================

pendencias:
  documentacao:
    - "Executar validator-rl.py para validar separação RF/RL"
    - "Criar UC-RF078.md (5 casos de uso: UC00-UC04)"
    - "Criar MD-RF078.md (modelo de dados)"
    - "Criar WF-RF078.md (wireframes)"
    - "Gerar user-stories.yaml"

  desenvolvimento:
    - "Implementar backend (CONTRATO-EXECUCAO-BACKEND)"
    - "Implementar frontend (CONTRATO-EXECUCAO-FRONTEND)"
    - "Configurar Azure Key Vault"
    - "Configurar Azure Service Bus (DLQ)"
    - "Implementar webhooks com HMAC-SHA256"

  testes:
    - "Criar documentação de testes (CN/TC/MT)"
    - "Executar testes backend (CONTRATO-TESTER-BACKEND)"
    - "Executar testes frontend"
    - "Executar testes E2E"
    - "Executar testes de segurança"

# ==============================================================================
# CHANGELOG STATUS.yaml
# ==============================================================================

changelog_status:
  - versao: "2.0"
    data: "2025-12-30"
    descricao: "Migração completa v1.0 → v2.0 (separação RF/RL, 18 itens rastreados, 100% destinos)"
    autor: "Agência ALC - alc.dev.br"

  - versao: "1.0"
    data: "2025-12-28"
    descricao: "Versão inicial com RF básico"
    autor: "Claude Code"
