rf_id: RF103
rf_title: "Relatórios e Volumetria"
versao_governanca: "2.0"
data_migracao: "2025-12-31"

# ==============================================================================
# ITENS LEGADO RASTREADOS
# ==============================================================================

itens_legado:
  # ------------------------------------------------------------------------------
  # TELAS ASPX
  # ------------------------------------------------------------------------------
  - id: "LEG-RF103-001"
    tipo: "tela"
    titulo: "RelatorioVolumetria.aspx"
    caminho_legado: "ic1_legado/IControlIT/Relatorios/RelatorioVolumetria.aspx"
    descricao: |
      Tela principal de consulta de volumetria com filtros de período e geração
      de relatório em Crystal Reports. Processamento síncrono bloqueava interface
      por 30-90 segundos.
    regras_implicitas:
      - "Botão 'Gerar' bloqueava interface durante processamento"
      - "Sem validação de formato de data"
      - "Sem validação se data fim > data início"
      - "Timeout HTTP após 90 segundos causava perda do relatório"
    destino: "SUBSTITUÍDO"
    justificativa: "Substituído por componente Angular com processamento assíncrono e feedback visual de progresso"
    rastreabilidade:
      rf_moderno: "RF-103 - Seção 4 (Funcionalidades)"
      uc_moderno: "UC01-RF103 (Consultar Volumetria)"
    migracao_moderna:
      componente_angular: "volumetria-relatorio.component.ts"
      rota_frontend: "/relatorios/volumetria"

  - id: "LEG-RF103-002"
    tipo: "tela"
    titulo: "ComparativoTemporal.aspx"
    caminho_legado: "ic1_legado/IControlIT/Relatorios/ComparativoTemporal.aspx"
    descricao: |
      Comparativo básico mês vs mês (funcionalidade parcial). Validava se
      períodos estavam finalizados, mas não verificava existência de dados
      do período anterior.
    regras_implicitas:
      - "Validação de períodos finalizados (regra correta)"
      - "Não verificava existência de dados do período anterior"
      - "Não calculava variação percentual (usuário calculava manualmente)"
      - "Exibia apenas valores absolutos"
    destino: "ASSUMIDO"
    justificativa: "Regra de períodos finalizados foi assumida e melhorada em RN-RF103-003 com cálculo automático de variação %"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-003"
      uc_moderno: "UC03-RF103 (Comparativo Temporal)"
    migracao_moderna:
      componente_angular: "volumetria-comparativo.component.ts"
      rota_frontend: "/relatorios/volumetria/comparativo"

  - id: "LEG-RF103-003"
    tipo: "tela"
    titulo: "Top10.aspx"
    caminho_legado: "ic1_legado/IControlIT/Relatorios/Top10.aspx"
    descricao: |
      Ranking top 10 hardcoded apenas para filiais. Não permitia customizar
      dimensão (departamento, centro custo, responsável). Ordenação descendente
      estava correta, mas não calculava percentual do total.
    regras_implicitas:
      - "Hardcoded apenas para filiais"
      - "Ordenação descendente por volume (correto)"
      - "Não calculava percentual do total"
      - "Exibia apenas volume absoluto"
    destino: "SUBSTITUÍDO"
    justificativa: "Modernizado para permitir top 10 por qualquer dimensão (filial, departamento, centro custo, responsável) com cálculo automático de percentual"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-004"
      uc_moderno: "UC04-RF103 (Top 10)"
    migracao_moderna:
      api_endpoint: "GET /api/volumetria/top10/{tipo}"
      handler: "GetTop10QueryHandler"

  - id: "LEG-RF103-004"
    tipo: "tela"
    titulo: "ExportExcel.aspx"
    caminho_legado: "ic1_legado/IControlIT/Relatorios/ExportExcel.aspx"
    descricao: |
      Export de volumetria para Excel XLS (formato antigo). Limitado a 65.536
      linhas, falhava silenciosamente se volume maior (truncava dados sem avisar).
      Gerava apenas uma aba única sem estrutura de resumo executivo.
    regras_implicitas:
      - "Formato XLS (limite 65.536 linhas)"
      - "Truncava dados silenciosamente se volume > 65k"
      - "Sem aba de resumo executivo"
      - "Gerava apenas uma aba única com todos dados misturados"
    destino: "SUBSTITUÍDO"
    justificativa: "Modernizado para XLSX ilimitado com abas de resumo executivo + detalhes por tipo"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-008"
    migracao_moderna:
      api_endpoint: "POST /api/volumetria/export/excel"
      handler: "ExportVolumetriaExcelCommandHandler"
      biblioteca: "EPPlus (não Microsoft.Office.Interop)"

  # ------------------------------------------------------------------------------
  # WEBSERVICES
  # ------------------------------------------------------------------------------
  - id: "LEG-RF103-005"
    tipo: "webservice"
    titulo: "WSVolumetria.asmx - ObterVolumetriaChamados"
    caminho_legado: "ic1_legado/IControlIT/WebService/WSVolumetria.asmx.vb"
    metodos:
      - nome: "ObterVolumetriaChamados"
        parametros: "idCliente As Integer, dataInicio As Date, dataFim As Date"
        retorno: "DataTable"
    descricao: |
      Método webservice que retornava volumetria de chamados como DataTable não
      tipado. Processamento síncrono bloqueava thread IIS. Sem validação de permissões.
    destino: "SUBSTITUÍDO"
    justificativa: "Substituído por REST API com tipagem forte, RBAC e processamento otimizado"
    rastreabilidade:
      rf_moderno: "RF-103 - Seção 10 (API Endpoints)"
      endpoint_moderno: "GET /api/volumetria/chamados"
    migracao_moderna:
      query_cqrs: "GetVolumetriaChamadosQuery"
      handler: "GetVolumetriaChamadosQueryHandler"
      response_dto: "VolumetriaChamadosDto"

  - id: "LEG-RF103-006"
    tipo: "webservice"
    titulo: "WSVolumetria.asmx - ObterTop10Filiais"
    caminho_legado: "ic1_legado/IControlIT/WebService/WSVolumetria.asmx.vb"
    metodos:
      - nome: "ObterTop10Filiais"
        parametros: "idCliente As Integer, periodo As String"
        retorno: "DataTable"
    descricao: |
      Método hardcoded para top 10 filiais. Não permitia customizar dimensão.
    destino: "SUBSTITUÍDO"
    justificativa: "Substituído por endpoint genérico GET /api/volumetria/top10/{tipo} que permite qualquer dimensão"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-004"
      endpoint_moderno: "GET /api/volumetria/top10/{tipo}"
    migracao_moderna:
      query_cqrs: "GetTop10Query"
      handler: "GetTop10QueryHandler"

  - id: "LEG-RF103-007"
    tipo: "webservice"
    titulo: "WSVolumetria.asmx - ObterComparativoMesVsMes"
    caminho_legado: "ic1_legado/IControlIT/WebService/WSVolumetria.asmx.vb"
    metodos:
      - nome: "ObterComparativoMesVsMes"
        parametros: "idCliente As Integer, mes As Integer, ano As Integer"
        retorno: "DataTable"
    descricao: |
      Método de comparativo temporal sem validação se período estava finalizado.
    destino: "ASSUMIDO"
    justificativa: "Regra de validação de período finalizado assumida e melhorada (RN-RF103-003)"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-003"
      endpoint_moderno: "GET /api/volumetria/comparativo?tipo=mes"
    migracao_moderna:
      query_cqrs: "GetComparativoTemporalQuery"
      handler: "GetComparativoTemporalQueryHandler"

  - id: "LEG-RF103-008"
    tipo: "webservice"
    titulo: "WSVolumetria.asmx - ExportarExcel"
    caminho_legado: "ic1_legado/IControlIT/WebService/WSVolumetria.asmx.vb"
    metodos:
      - nome: "ExportarExcel"
        parametros: "idCliente As Integer, dados As DataTable"
        retorno: "String (caminho arquivo)"
    descricao: |
      Método de export que salvava arquivo temporário em C:\Temp\{GUID}.xls.
      Usava Microsoft.Office.Interop.Excel (exigia Office instalado). Sem
      limpeza automática de arquivos temporários.
    destino: "SUBSTITUÍDO"
    justificativa: "Substituído por export com EPPlus (XLSX ilimitado) com stream direto ao cliente (sem arquivos temporários em disco)"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-008"
      endpoint_moderno: "POST /api/volumetria/export/excel"
    migracao_moderna:
      command_cqrs: "ExportVolumetriaExcelCommand"
      handler: "ExportVolumetriaExcelCommandHandler"
      biblioteca: "EPPlus"

  # ------------------------------------------------------------------------------
  # STORED PROCEDURES
  # ------------------------------------------------------------------------------
  - id: "LEG-RF103-009"
    tipo: "stored_procedure"
    titulo: "pa_sp_volumetria_chamados"
    caminho_legado: "ic1_legado/Database/Procedures/pa_sp_volumetria_chamados.sql"
    parametros_entrada:
      - "@id_cliente INT"
      - "@dt_inicio DATETIME"
      - "@dt_fim DATETIME"
    parametros_saida: []
    descricao: |
      Stored procedure que filtrava chamados por cliente e período, agregando
      por tipo, prioridade e status usando COUNT(*). Executava table scan completo
      (sem índices otimizados), resultando em 30+ segundos para > 1M registros.
      Não tratava timezone (assumia sempre GMT-3).
    destino: "SUBSTITUÍDO"
    justificativa: "Substituído por Query LINQ nativa com índices otimizados em (ClienteId, DataCriacao) e tratamento UTC"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-001"
    migracao_moderna:
      handler: "GetVolumetriaChamadosQueryHandler"
      validacao: null

  - id: "LEG-RF103-010"
    tipo: "stored_procedure"
    titulo: "pa_sp_top10_filiais"
    caminho_legado: "ic1_legado/Database/Procedures/pa_sp_top10_filiais.sql"
    parametros_entrada:
      - "@id_cliente INT"
      - "@periodo VARCHAR(20)"
    parametros_saida: []
    descricao: |
      Stored procedure que parseava manualmente string de período (formato "2025-12")
      e agregava chamados por filial usando GROUP BY. Hardcoded apenas para filiais.
      Ordenação descendente estava correta, mas não calculava percentual do total.
    destino: "SUBSTITUÍDO"
    justificativa: "Substituído por agregação SQL genérica com parâmetro de dimensão (filial, departamento, centro custo, responsável)"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-004"
    migracao_moderna:
      handler: "GetTop10QueryHandler"
      validacao: null

  - id: "LEG-RF103-011"
    tipo: "stored_procedure"
    titulo: "pa_sp_comparativo_temporal"
    caminho_legado: "ic1_legado/Database/Procedures/pa_sp_comparativo_temporal.sql"
    parametros_entrada:
      - "@id_cliente INT"
      - "@mes INT"
      - "@ano INT"
    parametros_saida: []
    descricao: |
      Stored procedure que calculava início/fim do mês atual e anterior, executando
      duas queries separadas (COUNT para cada mês). Não validava se mês estava
      finalizado, não verificava se mês anterior tinha dados. Frontend calculava
      variação percentual (inconsistente).
    destino: "ASSUMIDO"
    justificativa: "Validação de período finalizado assumida e melhorada. Cálculo de variação % movido para backend"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-003"
    migracao_moderna:
      handler: "GetComparativoTemporalQueryHandler"
      validacao: "Validação de período finalizado + verificação existência dados anteriores"

  - id: "LEG-RF103-012"
    tipo: "stored_procedure"
    titulo: "pa_sp_tendencia_30dias"
    caminho_legado: "ic1_legado/Database/Procedures/pa_sp_tendencia_30dias.sql"
    parametros_entrada:
      - "@id_cliente INT"
    parametros_saida: []
    descricao: |
      Stored procedure que retornava volumetria diária dos últimos 30 dias sem
      cálculo de média móvel. Frontend exibia valores brutos com muita oscilação
      (difícil identificar tendência real).
    destino: "SUBSTITUÍDO"
    justificativa: "Substituído por cálculo de média móvel 7 dias no backend para suavizar oscilações e identificar tendência real"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-005"
    migracao_moderna:
      handler: "GetTendenciaQueryHandler"
      validacao: null

  - id: "LEG-RF103-013"
    tipo: "stored_procedure"
    titulo: "pa_sp_export_volumetria_excel"
    caminho_legado: "ic1_legado/Database/Procedures/pa_sp_export_volumetria_excel.sql"
    parametros_entrada:
      - "@id_cliente INT"
    parametros_saida: []
    descricao: |
      Stored procedure que selecionava TODOS registros sem paginação. Aplicação
      VB.NET usava Microsoft.Office.Interop.Excel para gerar XLS (exigia Office
      instalado no servidor). Salvava arquivo temporário em C:\Temp\ sem limpeza
      automática (disco ficava cheio). Limite de 65.536 linhas.
    destino: "SUBSTITUÍDO"
    justificativa: "Substituído por EPPlus (XLSX ilimitado) com stream direto ao cliente (sem arquivos temporários em disco)"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-008"
    migracao_moderna:
      handler: "ExportVolumetriaExcelCommandHandler"
      biblioteca: "EPPlus"

  # ------------------------------------------------------------------------------
  # TABELAS LEGADAS
  # ------------------------------------------------------------------------------
  - id: "LEG-RF103-014"
    tipo: "tabela"
    titulo: "tb_chamados"
    schema_legado: "[dbo].[tb_chamados]"
    problemas_identificados:
      - "Sem índice em dt_criacao (volumetria filtrava por essa coluna)"
      - "Sem índice composto (id_cliente, dt_criacao) para multi-tenancy + período"
      - "Campos texto sem normalização (ds_tipo, ds_prioridade - valores duplicados)"
      - "Sem auditoria (Created, CreatedBy, Modified, ModifiedBy)"
      - "Sem Foreign Key para id_filial (integridade não garantida)"
    destino: "SUBSTITUÍDO"
    justificativa: "Redesenhada como 'Chamado' com auditoria, FKs, índices otimizados e normalização"
    rastreabilidade:
      rf_moderno: "RF-103 - Seção 12 (Modelo de Dados)"
      md_moderno: "MD-RF103 - Tabela Chamado"
    migracao_moderna:
      tabela_moderna: "Chamado"
      migration_ef_core: "Já existe (RF015)"

  - id: "LEG-RF103-015"
    tipo: "tabela"
    titulo: "tb_ativos"
    schema_legado: "[dbo].[tb_ativos]"
    problemas_identificados:
      - "Mesmos problemas de tb_chamados (índices, normalização, auditoria)"
      - "Sem FK para id_localizacao"
      - "Categoria como texto livre (valores inconsistentes)"
    destino: "SUBSTITUÍDO"
    justificativa: "Redesenhada como 'Ativo' com normalização"
    rastreabilidade:
      rf_moderno: "RF-103 - Seção 12"
      md_moderno: "MD-RF103 - Tabela Ativo"
    migracao_moderna:
      tabela_moderna: "Ativo"
      migration_ef_core: "Já existe (RF016)"

  - id: "LEG-RF103-016"
    tipo: "tabela"
    titulo: "tb_usuarios"
    schema_legado: "[dbo].[tb_usuarios]"
    problemas_identificados:
      - "Email sem UNIQUE constraint (permitia duplicados)"
      - "Status como texto livre (valores inconsistentes: 'ativo', 'Ativo', 'ATIVO')"
      - "Sem auditoria"
    destino: "SUBSTITUÍDO"
    justificativa: "Redesenhada como 'Usuario' com constraints"
    rastreabilidade:
      rf_moderno: "RF-103 - Seção 12"
      md_moderno: "MD-RF103 - Tabela Usuario"
    migracao_moderna:
      tabela_moderna: "Usuario"
      migration_ef_core: "Já existe (RF006)"

  - id: "LEG-RF103-017"
    tipo: "tabela"
    titulo: "tb_contratos"
    schema_legado: "[dbo].[tb_contratos]"
    problemas_identificados:
      - "Status como texto livre"
      - "Sem validação dt_vigencia_fim > dt_vigencia_inicio"
      - "Sem auditoria"
    destino: "SUBSTITUÍDO"
    justificativa: "Redesenhada como 'Contrato' com validações"
    rastreabilidade:
      rf_moderno: "RF-103 - Seção 12"
      md_moderno: "MD-RF103 - Tabela Contrato"
    migracao_moderna:
      tabela_moderna: "Contrato"
      migration_ef_core: "Já existe (RF050)"

  # ------------------------------------------------------------------------------
  # REGRAS IMPLÍCITAS
  # ------------------------------------------------------------------------------
  - id: "LEG-RF103-018"
    tipo: "regra_negocio"
    titulo: "Volumetria sempre calculada on-demand"
    localizacao_codigo: "ic1_legado/IControlIT/Relatorios/RelatorioVolumetria.aspx.vb - btnGerar_Click"
    descricao: |
      Todo acesso a relatório recalculava volumetria do zero, sem cache ou
      pré-processamento. Causava sobrecarga no banco de dados e lentidão em
      horário comercial.
    destino: "SUBSTITUÍDO"
    justificativa: "Substituído por consolidação diária automática via Hangfire às 4h (RN-RF103-002)"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-002"
      regra_moderna: "RN-RF103-002"
    migracao_moderna:
      job_hangfire: "ConsolidacaoVolumetriaJob"
      frequencia: "Cron.Daily(4, 0)"

  - id: "LEG-RF103-019"
    tipo: "regra_negocio"
    titulo: "Crystal Reports bloqueava interface por 30-90 segundos"
    localizacao_codigo: "ic1_legado/IControlIT/Relatorios/RelatorioVolumetria.aspx.vb - Linha 145"
    descricao: |
      Geração de relatório Crystal Reports era síncrona e travava browser do
      usuário. Causava timeouts HTTP e perda de relatórios.
    destino: "SUBSTITUÍDO"
    justificativa: "Substituído por processamento assíncrono para relatórios > 100k registros (RN-RF103-009)"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-009"
      regra_moderna: "RN-RF103-009"
    migracao_moderna:
      job_hangfire: "ProcessarExportVolumetriaJob"
      notificacao: "E-mail + notificação in-app"

  - id: "LEG-RF103-020"
    tipo: "regra_negocio"
    titulo: "Top 10 hardcoded para filiais"
    localizacao_codigo: "ic1_legado/IControlIT/Relatorios/Top10.aspx.vb - GerarTop10()"
    descricao: |
      Ranking top 10 era fixo apenas para filiais, não permitia customizar
      dimensão (departamento, centro custo, responsável).
    destino: "SUBSTITUÍDO"
    justificativa: "Substituído por top 10 genérico com parâmetro de dimensão (RN-RF103-004)"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-004"
      regra_moderna: "RN-RF103-004"
    migracao_moderna:
      handler: "GetTop10QueryHandler"
      parametro_dimensao: "tipo (filial | departamento | centro_custo | responsavel)"

  - id: "LEG-RF103-021"
    tipo: "regra_negocio"
    titulo: "Export Excel limitado a 65.536 linhas"
    localizacao_codigo: "ic1_legado/IControlIT/Relatorios/ExportExcel.aspx.vb - ExportarParaExcel()"
    descricao: |
      Excel XLS tinha limite de linhas e truncava dados silenciosamente sem avisar
      usuário. Causava perda de informações em exports grandes.
    destino: "SUBSTITUÍDO"
    justificativa: "Substituído por XLSX ilimitado com EPPlus (RN-RF103-008)"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-008"
      regra_moderna: "RN-RF103-008"
    migracao_moderna:
      handler: "ExportVolumetriaExcelCommandHandler"
      biblioteca: "EPPlus"
      formato: "XLSX ilimitado"

  - id: "LEG-RF103-022"
    tipo: "regra_negocio"
    titulo: "Multi-database (1 cliente = 1 banco)"
    localizacao_codigo: "Arquitetura geral do sistema legado"
    descricao: |
      Cada cliente tinha banco SQL Server isolado, dificultando consolidação
      global, manutenção e backups. Custos operacionais elevados.
    destino: "SUBSTITUÍDO"
    justificativa: "Substituído por multi-tenancy com Row-Level Security (ClienteId) em banco único (RN-RF103-007)"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-007"
      regra_moderna: "RN-RF103-007"
    migracao_moderna:
      estrategia: "Row-Level Security com ClienteId obrigatório em todas queries"

  - id: "LEG-RF103-023"
    tipo: "regra_negocio"
    titulo: "Sem auditoria de acesso a relatórios"
    localizacao_codigo: "Ausência de lógica de auditoria em todos arquivos ASPX"
    descricao: |
      Nenhum acesso a relatório era registrado em log de auditoria. Falha crítica
      de conformidade (LGPD, ISO 27001). Impossível rastrear quem acessou dados
      sensíveis de negócio.
    destino: "ASSUMIDO"
    justificativa: "Auditoria obrigatória implementada (RN-RF103-010) - registra TODOS acessos a relatórios"
    rastreabilidade:
      rf_moderno: "RF-103 - RN-RF103-010"
      regra_moderna: "RN-RF103-010"
    migracao_moderna:
      tabela_auditoria: "LogAuditoria"
      campos_registrados: "UsuarioId, ClienteId, TipoRelatorio, Parametros, Timestamp, Resultado"

# ==============================================================================
# METADADOS
# ==============================================================================

metadados:
  total_itens_legado: 23
  itens_assumidos: 3
  itens_substituidos: 19
  itens_descartados: 0
  itens_a_revisar: 1
  cobertura_destinos: "100%"

  detalhamento:
    telas_aspx: 4
    webservices: 4
    stored_procedures: 5
    tabelas: 4
    regras_implicitas: 6

# ==============================================================================
# PROBLEMAS LEGADO IDENTIFICADOS
# ==============================================================================

problemas_legado:
  - id: "PROB-RF103-001"
    titulo: "Performance Crítica com Crystal Reports"
    severidade: "CRÍTICA"
    descricao: |
      Crystal Reports travava com > 500k registros, gerando relatórios de 30+
      segundos. Carregava TODOS registros em memória antes de agregar.
    impacto: "Indisponibilidade funcional para clientes com grandes volumes"
    solucao_moderna: "Agregações SQL nativas + ElasticSearch para volumes > 1M + consolidação diária"

  - id: "PROB-RF103-002"
    titulo: "Multi-database Complexo"
    severidade: "ALTA"
    descricao: |
      Cada cliente tinha banco próprio, dificultando consultas agregadas,
      manutenção e backups. Custos operacionais elevados.
    impacto: "Alto custo operacional + dificuldade de escalabilidade"
    solucao_moderna: "Multi-tenancy com Row-Level Security (ClienteId) em banco único"

  - id: "PROB-RF103-003"
    titulo: "Falta de Cache"
    severidade: "ALTA"
    descricao: |
      Nenhuma estratégia de cache, recalculava volumetrias a cada acesso.
      Sobrecarregava banco em horário comercial.
    impacto: "Degradação de performance em horário de pico"
    solucao_moderna: "Redis com TTL inteligente + consolidação diária pré-calculada"

  - id: "PROB-RF103-004"
    titulo: "Processamento Síncrono"
    severidade: "ALTA"
    descricao: |
      Relatórios grandes travavam browser do usuário, causando timeouts HTTP
      e perda de trabalho.
    impacto: "Frustração do usuário + perda de relatórios"
    solucao_moderna: "Processamento assíncrono para > 100k registros + notificação por e-mail"

  - id: "PROB-RF103-005"
    titulo: "Auditoria Ausente"
    severidade: "CRÍTICA"
    descricao: |
      Impossível rastrear quem acessou relatórios de volumetria. Falha de
      conformidade (LGPD, ISO 27001).
    impacto: "Não conformidade regulatória + risco de vazamento de dados sem rastreabilidade"
    solucao_moderna: "Auditoria completa em LogAuditoria com usuário, timestamp, parâmetros, resultado"

  - id: "PROB-RF103-006"
    titulo: "Export Limitado"
    severidade: "MÉDIA"
    descricao: |
      Excel XLS com limite de 65.536 linhas. Truncava dados silenciosamente
      sem avisar usuário.
    impacto: "Perda de informações em exports grandes"
    solucao_moderna: "XLSX ilimitado com EPPlus + processamento assíncrono se necessário"
