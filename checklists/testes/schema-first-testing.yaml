nome: Schema-First Testing Validation
descricao: Validar schema.sql e sincronizacao com Azure SQL
categorias:
  - testes
  - infraestrutura
  - database

validacoes_bloqueantes:
  - schema_sql_existe:
      descricao: "Arquivo schema.sql existe em tests/"
      caminho: "D:\\IC2\\backend\\IControlIT.API\\tests\\schema.sql"
      criterio: "Arquivo existe e tamanho > 10KB"

  - schema_sql_atualizado:
      descricao: "schema.sql esta sincronizado com Azure SQL DEV"
      criterio: "Ultima modificacao < 7 dias OU usuario confirma atualizacao recente"

  - testcontainers_configurado:
      descricao: "SqlTestcontainersTestDatabase.cs executa schema.sql"
      arquivo: "tests/Application.FunctionalTests/SqlTestcontainersTestDatabase.cs"
      criterio: "Linha 47 executa script SQL em vez de EnsureCreatedAsync()"

validacoes_qualidade:
  - schema_idempotente:
      descricao: "Schema.sql e idempotente (pode ser executado multiplas vezes)"
      criterio: "Contem IF NOT EXISTS ou DROP/CREATE"

  - schema_completo:
      descricao: "Schema.sql contem todas as tabelas necessarias"
      criterio: "Contem CREATE TABLE para entidades do RF"

  - schema_sem_dados:
      descricao: "Schema.sql NAO contem INSERT (apenas DDL)"
      criterio: "Arquivo nao contem comandos INSERT INTO"

criterio_aprovacao:
  bloqueantes: "100% (todas validacoes bloqueantes passam)"
  qualidade: ">= 66% (2 de 3 validacoes de qualidade passam)"
