contract: DOCUMENTACAO-GOVERNADA-TESTES

output_files:
  - TC-RFXXX-BACKEND.md
  - TC-RFXXX-FRONTEND.md
  - TC-RFXXX-SEGURANCA.md
  - TC-RFXXX-E2E.md

prerequisites:
  - id: doc_rf_exists
    description: RF.md existe e esta completo
    check: documentacao.rf == True
    blocking: true

  - id: doc_uc_exists
    description: UC-RFXXX.md existe e esta completo
    check: documentacao.uc == True
    blocking: true

  - id: doc_md_exists
    description: MD-RFXXX.md existe e esta completo
    check: documentacao.md == True
    blocking: true

  - id: doc_wf_exists
    description: WF-RFXXX.md existe e esta completo
    check: documentacao.wf == True
    blocking: true

todo_list:
  - id: todo_created
    description: Todo list criada antes de qualquer acao
    blocking: true

  - id: todo_updated
    description: Status atualizado em tempo real
    blocking: false

workflow:
  - id: branch_from_dev
    description: Branch criado a partir de dev atualizado
    command: git checkout -b docs/RFXXX-test-cases

  - id: uc_read_complete
    description: UC-RFXXX.md lido completamente

  - id: paths_extracted
    description: Todos os caminhos do UC extraidos (FP, FA, FE, RN)

  - id: tc_backend_created
    description: TC-RFXXX-BACKEND.md criado
    file_pattern: docs/rf/**/TC-RFXXX-BACKEND.md

  - id: tc_frontend_created
    description: TC-RFXXX-FRONTEND.md criado
    file_pattern: docs/rf/**/TC-RFXXX-FRONTEND.md

  - id: tc_seguranca_created
    description: TC-RFXXX-SEGURANCA.md criado
    file_pattern: docs/rf/**/TC-RFXXX-SEGURANCA.md

  - id: tc_e2e_created
    description: TC-RFXXX-E2E.md criado
    file_pattern: docs/rf/**/TC-RFXXX-E2E.md

coverage:
  - id: main_flow_covered
    description: Fluxo principal do UC mapeado para TC-API, TC-FE e TC-E2E
    blocking: true

  - id: all_fa_covered
    description: Todos FA-XX tem TC correspondente em BACKEND e FRONTEND
    blocking: true

  - id: all_fe_covered
    description: Todos FE-XX tem TC correspondente em BACKEND e FRONTEND
    blocking: true

  - id: all_rn_referenced
    description: Todas RN-UC-XXX referenciadas em criterios de aprovacao
    blocking: true

  - id: security_tenant
    description: TC-SEC para isolamento de tenant
    blocking: true

  - id: security_sql_injection
    description: TC-SEC para SQL injection
    blocking: true

  - id: traceability_matrix
    description: Matriz de rastreabilidade em cada arquivo
    blocking: true

status_yaml:
  - id: doc_testes_backend
    description: documentacao_testes.backend = True (TC-RFXXX-BACKEND.md)
    field: documentacao_testes.backend

  - id: doc_testes_frontend
    description: documentacao_testes.frontend = True (TC-RFXXX-FRONTEND.md)
    field: documentacao_testes.frontend

  - id: doc_testes_e2e
    description: documentacao_testes.e2e = True (TC-RFXXX-E2E.md)
    field: documentacao_testes.e2e

  - id: doc_testes_seguranca
    description: documentacao_testes.seguranca = True (TC-RFXXX-SEGURANCA.md)
    field: documentacao_testes.seguranca

completion:
  - id: committed_to_branch
    description: Commit realizado na branch docs/
    command: git commit -m "docs(RFXXX): casos de teste (4 arquivos)"

  - id: merged_to_dev
    description: Merge para dev executado
    command: git merge docs/RFXXX-test-cases

  - id: pushed_to_origin
    description: Push para origin dev
    command: git push origin dev

  - id: branch_deleted
    description: Branch local removida
    command: git branch -d docs/RFXXX-test-cases

  - id: synced_to_devops
    description: sync-rf.py executado com sucesso
    command: python tools/devops-sync/sync-rf.py RFXXX

  - id: board_updated
    description: RF moveu para coluna "Testes TI"
    expected_column: Testes TI

zones:
  allowed_read:
    - docs/rf/**/RF*.md
    - docs/rf/**/UC-RF*.md
    - docs/rf/**/MD-RF*.md
    - docs/rf/**/WF-RF*.md
    - docs/rf/**/STATUS.yaml
    - docs/templates/TEMPLATE-TC.md

  allowed_write:
    - docs/rf/**/TC-RFXXX-BACKEND.md
    - docs/rf/**/TC-RFXXX-FRONTEND.md
    - docs/rf/**/TC-RFXXX-SEGURANCA.md
    - docs/rf/**/TC-RFXXX-E2E.md
    - docs/rf/**/STATUS.yaml

  forbidden:
    - backend/**
    - frontend/**
    - "*.spec.ts"
    - "*.test.ts"
    - "*Tests.cs"
    - azure-pipelines.yml
    - docs/rf/**/RF*.md
    - docs/rf/**/UC-*.md
    - docs/rf/**/MD-*.md
    - docs/rf/**/WF-*.md

batch_mode:
  enabled: true
  branch_pattern: docs/batch-test-cases-YYYYMMDD
  on_rf_failure: ask_user
  commit_strategy: single_commit

executor_mapping:
  TC-RFXXX-BACKEND.md: Desenvolvimento (TI)
  TC-RFXXX-FRONTEND.md: Desenvolvimento (TI)
  TC-RFXXX-SEGURANCA.md: Desenvolvimento (TI)
  TC-RFXXX-E2E.md: QA / Usuario Final

next_contract: CONTRATO-EXECUCAO-TESTES
