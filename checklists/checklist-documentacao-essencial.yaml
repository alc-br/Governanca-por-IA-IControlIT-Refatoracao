contract: DOCUMENTACAO-ESSENCIAL

output_files:
  - RFXXX.md
  - UC-RFXXX.md
  - MD-RFXXX.md
  - WF-RFXXX.md
  - user-stories.yaml

prerequisites:
  - id: rf_folder_exists
    description: Pasta do RF existe em docs/rf/[Fase]/[EPIC]/
    blocking: true

  - id: legacy_accessible
    description: Codigo legado acessivel em D:/IC2/ic1_legado/
    blocking: true

  - id: physical_model_accessible
    description: Modelo fisico acessivel em D:\DocumentosIC2\modelo-fisico-bd.sql
    blocking: true

  - id: templates_accessible
    description: Templates disponiveis em docs/templates/TEMPLATE-*.md
    blocking: true

todo_list:
  - id: todo_created
    description: Todo list criada antes de qualquer acao
    blocking: true

  - id: todo_updated
    description: Status atualizado em tempo real
    blocking: false

workflow:
  - id: branch_from_dev
    description: Branch criado a partir de dev atualizado
    command: git checkout -b docs/RFXXX-essential-docs

legacy_analysis:
  - id: webservices_identified
    description: Webservices identificados em ic1_legado
    location: D:/IC2/ic1_legado/IControlIT/[modulo]/WebService/

  - id: aspx_analyzed
    description: Telas ASPX analisadas
    location: D:/IC2/ic1_legado/IControlIT/[modulo]/

  - id: tables_mapped
    description: Tabelas mapeadas no modelo fisico
    location: D:\DocumentosIC2\modelo-fisico-bd.sql

  - id: procedures_listed
    description: Stored Procedures listadas
    location: D:/IC2/ic1_legado/Database/Procedures/

rules_extraction:
  - id: vbnet_code_read
    description: Codigo VB.NET dos webservices lido

  - id: sql_validations_identified
    description: Validacoes SQL identificadas

  - id: rules_documented
    description: 10-15 regras documentadas em linguagem natural
    min_rules: 10
    max_rules: 15

  - id: no_code_copied
    description: Nenhum codigo VB.NET ou SQL copiado
    blocking: true

document_generation:
  - id: rf_created
    description: RFXXX.md criado
    template: docs/templates/TEMPLATE-RF.md
    order: 1

  - id: uc_created
    description: UC-RFXXX.md criado
    template: docs/templates/TEMPLATE-UC.md
    order: 2

  - id: md_created
    description: MD-RFXXX.md criado
    template: docs/templates/TEMPLATE-MD.md
    order: 3

  - id: wf_created
    description: WF-RFXXX.md criado
    template: docs/templates/TEMPLATE-WF.md
    order: 4

  - id: user_stories_created
    description: user-stories.yaml criado
    template: docs/templates/TEMPLATE-USER-STORIES.yaml
    order: 5

quality_rf:
  - id: rf_section_1
    description: Secao 1 - Visao Geral (max 300 palavras)

  - id: rf_section_2
    description: Secao 2 - Funcionalidades (min 10 regras)

  - id: rf_section_3
    description: Secao 3 - Referencias ao Legado

  - id: rf_section_4
    description: Secao 4 - Impacto e Dependencias

  - id: rf_section_5
    description: Secao 5 - Integracao com Central

quality_uc:
  - id: uc00_listar
    description: UC00 - Listar

  - id: uc01_criar
    description: UC01 - Criar

  - id: uc02_visualizar
    description: UC02 - Visualizar

  - id: uc03_editar
    description: UC03 - Editar

  - id: uc04_excluir
    description: UC04 - Excluir

  - id: uc_has_fa
    description: Todos UCs tem Fluxos Alternativos (FA-XX)

  - id: uc_has_fe
    description: Todos UCs tem Fluxos de Excecao (FE-XX)

  - id: uc_has_rn
    description: Todos UCs tem Regras de Negocio (RN-UC-XXX)

quality_md:
  - id: md_er_diagram
    description: Diagrama ER (Mermaid)

  - id: md_ddl_complete
    description: DDL completo (CREATE TABLE)

  - id: md_audit_fields
    description: Campos de auditoria (Created, CreatedBy, LastModified, LastModifiedBy)

  - id: md_multitenancy
    description: Multi-tenancy (ClienteId, EmpresaId ou FornecedorId)

  - id: md_constraints
    description: Constraints (PK, FK, UNIQUE, CHECK)

  - id: md_indexes
    description: Indices sugeridos

  - id: md_seed
    description: Dados iniciais (Seed)

quality_wf:
  - id: wf_list_screen
    description: Tela de Listagem (Desktop + Mobile)

  - id: wf_create_edit_screen
    description: Tela de Criar/Editar

  - id: wf_view_screen
    description: Tela de Visualizar

  - id: wf_modals
    description: Modais (Confirmacao, Sucesso, Erro)

  - id: wf_states
    description: Estados (Loading, Vazio, Erro)

  - id: wf_components
    description: Componentes Fuse/Material

quality_user_stories:
  - id: us_min_stories
    description: Minimo 2 User Stories por RF

  - id: us_unique_codes
    description: Cada story tem codigo unico (US-RFXXX-NNN)

  - id: us_description
    description: Todas stories tem description (Como... Quero... Para...)

  - id: us_acceptance_criteria
    description: Todas stories tem acceptance criteria (minimo 5)

  - id: us_technical_notes
    description: Todas stories tem technical notes (backend, frontend)

  - id: us_story_points
    description: Todas stories tem story points (Fibonacci)

  - id: us_dependencies
    description: Dependencies mapeadas

  - id: us_summary
    description: Summary calculado (total stories, points)

  - id: us_validation
    description: Validation flags preenchidos

status_yaml:
  - id: doc_rf
    description: documentacao.rf = True
    field: documentacao.rf

  - id: doc_uc
    description: documentacao.uc = True
    field: documentacao.uc

  - id: doc_md
    description: documentacao.md = True
    field: documentacao.md

  - id: doc_wf
    description: documentacao.wf = True
    field: documentacao.wf

  - id: doc_user_stories
    description: documentacao.user_stories = True
    field: documentacao.user_stories

completion:
  - id: committed_to_branch
    description: Commit realizado na branch docs/
    command: git commit -m "docs(RFXXX): documentacao essencial (5 arquivos)"

  - id: merged_to_dev
    description: Merge para dev executado
    command: git merge docs/RFXXX-essential-docs

  - id: pushed_to_origin
    description: Push para origin dev
    command: git push origin dev

  - id: branch_deleted
    description: Branch local removida
    command: git branch -d docs/RFXXX-essential-docs

  - id: synced_to_devops
    description: sync-rf.py executado com sucesso
    command: python tools/devops-sync/sync-rf.py RFXXX

  - id: board_updated
    description: RF moveu para coluna "Documentacao Testes"
    expected_column: Documentacao Testes

zones:
  allowed_read:
    - D:/IC2/ic1_legado/**
    - D:\DocumentosIC2\modelo-fisico-bd.sql
    - D:\DocumentosIC2\inteligencia-artificial\prompts\arquitetura.md
    - docs/templates/TEMPLATE-RF.md
    - docs/templates/TEMPLATE-UC.md
    - docs/templates/TEMPLATE-MD.md
    - docs/templates/TEMPLATE-WF.md
    - docs/rf/**/STATUS.yaml

  allowed_write:
    - docs/rf/**/RFXXX.md
    - docs/rf/**/UC-RFXXX.md
    - docs/rf/**/MD-RFXXX.md
    - docs/rf/**/WF-RFXXX.md
    - docs/rf/**/user-stories.yaml
    - docs/rf/**/STATUS.yaml

  forbidden:
    - backend/**
    - frontend/**
    - "*.spec.ts"
    - "*.test.ts"
    - "*Tests.cs"
    - azure-pipelines.yml
    - docs/rf/**/TC-*.md

next_contract: CONTRATO-DOCUMENTACAO-GOVERNADA-TESTES
